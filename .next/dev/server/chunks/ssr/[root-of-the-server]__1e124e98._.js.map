{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error(\"Missing Supabase environment variables\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN,wCAAsC;IACpC,MAAM,IAAI,MAAM;AAClB;AAEO,MAAM,WAAW,IAAA,oNAAY,EAAC,aAAa"}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/SearchBox.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { usePrivy } from '@privy-io/react-auth';\nimport { supabase } from '@/lib/supabase';\n\ninterface SearchBoxProps {\n  onPickupChange?: (location: string, coords?: { lat: number; lng: number }) => void;\n  onDropoffChange?: (location: string, coords?: { lat: number; lng: number }) => void;\n  className?: string;\n  externalPickupCoords?: { lat: number; lng: number };\n  externalDropoffCoords?: { lat: number; lng: number };\n}\n\nexport default function SearchBox({ \n  onPickupChange, \n  onDropoffChange, \n  className = \"\",\n  externalPickupCoords,\n  externalDropoffCoords\n}: SearchBoxProps) {\n  const { user, authenticated, login } = usePrivy();\n  const [pickup, setPickup] = useState('');\n  const [dropoff, setDropoff] = useState('');\n  const [pickupCoords, setPickupCoords] = useState<{ lat: number; lng: number } | null>(null);\n  const [dropoffCoords, setDropoffCoords] = useState<{ lat: number; lng: number } | null>(null);\n  \n  // ... (previous states)\n\n  // Sync with External Coordinates (e.g. Map Drag)\n  useEffect(() => {\n    if (externalPickupCoords && \n       (!pickupCoords || externalPickupCoords.lat !== pickupCoords.lat || externalPickupCoords.lng !== pickupCoords.lng)) {\n        \n        // Update local coords immediately\n        setPickupCoords(externalPickupCoords);\n        \n        // Reverse Geocode to get address text\n        if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            geocoder.geocode({ location: externalPickupCoords }).then((response) => {\n                if (response.results[0]) {\n                    setPickup(response.results[0].formatted_address);\n                }\n            }).catch((e) => console.error(\"Reverse geocode failed\", e));\n        }\n    }\n  }, [externalPickupCoords]);\n\n  useEffect(() => {\n    if (externalDropoffCoords && \n       (!dropoffCoords || externalDropoffCoords.lat !== dropoffCoords.lat || externalDropoffCoords.lng !== dropoffCoords.lng)) {\n        \n        setDropoffCoords(externalDropoffCoords);\n        \n        if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            geocoder.geocode({ location: externalDropoffCoords }).then((response) => {\n                if (response.results[0]) {\n                    setDropoff(response.results[0].formatted_address);\n                }\n            }).catch((e) => console.error(\"Reverse geocode failed\", e));\n        }\n    }\n  }, [externalDropoffCoords]);\n\n  // Rest of the existing Effects...\n  const [wechatId, setWechatId] = useState('');\n  const [departureTime, setDepartureTime] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [locating, setLocating] = useState(false);\n  const [showDetails, setShowDetails] = useState(false);\n  const [placesApiReady, setPlacesApiReady] = useState(false);\n\n  const pickupInputRef = useRef<HTMLInputElement>(null);\n  const dropoffInputRef = useRef<HTMLInputElement>(null);\n  const pickupAutocompleteRef = useRef<google.maps.places.Autocomplete | null>(null);\n  const dropoffAutocompleteRef = useRef<google.maps.places.Autocomplete | null>(null);\n\n  // Check if Places API is available\n  useEffect(() => {\n    const checkPlacesAPI = () => {\n      if (window.google && window.google.maps && window.google.maps.places) {\n        setPlacesApiReady(true);\n        return true;\n      }\n      return false;\n    };\n\n    if (checkPlacesAPI()) {\n      return;\n    }\n\n    const interval = setInterval(() => {\n      if (checkPlacesAPI()) {\n        clearInterval(interval);\n      }\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  // Initialize Google Places Autocomplete\n  useEffect(() => {\n    if (!placesApiReady || !window.google || !window.google.maps || !window.google.maps.places) {\n      return;\n    }\n\n    // Setup pickup autocomplete\n    if (pickupInputRef.current && !pickupAutocompleteRef.current) {\n      pickupAutocompleteRef.current = new google.maps.places.Autocomplete(\n        pickupInputRef.current,\n        {\n          componentRestrictions: { country: 'us' },\n          fields: ['formatted_address', 'geometry', 'name'],\n          types: ['establishment', 'geocode'],\n        }\n      );\n\n      pickupAutocompleteRef.current.addListener('place_changed', () => {\n        const place = pickupAutocompleteRef.current?.getPlace();\n        if (place && place.geometry && place.geometry.location) {\n          const address = place.formatted_address || place.name || '';\n          const coords = {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          };\n          setPickup(address);\n          setPickupCoords(coords);\n          if (onPickupChange) {\n            onPickupChange(address, coords);\n          }\n        }\n      });\n    }\n\n    // Setup dropoff autocomplete\n    if (dropoffInputRef.current && !dropoffAutocompleteRef.current) {\n      dropoffAutocompleteRef.current = new google.maps.places.Autocomplete(\n        dropoffInputRef.current,\n        {\n          componentRestrictions: { country: 'us' },\n          fields: ['formatted_address', 'geometry', 'name'],\n          types: ['establishment', 'geocode'],\n        }\n      );\n\n      dropoffAutocompleteRef.current.addListener('place_changed', () => {\n        const place = dropoffAutocompleteRef.current?.getPlace();\n        if (place && place.geometry && place.geometry.location) {\n          const address = place.formatted_address || place.name || '';\n          const coords = {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          };\n          setDropoff(address);\n          setDropoffCoords(coords);\n          if (onDropoffChange) {\n            onDropoffChange(address, coords);\n          }\n          // Auto show details when both locations are selected\n          if (pickup) {\n            setShowDetails(true);\n          }\n        }\n      });\n    }\n  }, [placesApiReady, onPickupChange, onDropoffChange, pickup]);\n\n  // Geolocation\n  const handleGetCurrentLocation = async () => {\n    if (!navigator.geolocation) {\n      alert('Âú∞ÁêÜÂÆö‰Ωç‰∏çÊîØÊåÅ / Geolocation not supported');\n      return;\n    }\n\n    if (!window.google || !window.google.maps) {\n      alert('Âú∞ÂúñÂä†Ëºâ‰∏≠ÔºåË´ãÁ®çÂæåÂÜçË©¶ / Map is loading, please try again');\n      return;\n    }\n\n    setLocating(true);\n    navigator.geolocation.getCurrentPosition(\n      async (position) => {\n        const { latitude, longitude } = position.coords;\n\n        try {\n          if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            const result = await geocoder.geocode({\n              location: { lat: latitude, lng: longitude },\n            });\n\n            if (result.results && result.results.length > 0) {\n              const address = result.results[0].formatted_address;\n              const coords = { lat: latitude, lng: longitude };\n              setPickup(address);\n              setPickupCoords(coords);\n              if (onPickupChange) {\n                onPickupChange(address, coords);\n              }\n            }\n          }\n        } catch (error) {\n          console.error('Geocoding error:', error);\n        } finally {\n          setLocating(false);\n        }\n      },\n      (error) => {\n        console.error('Geolocation error:', error);\n        alert('Êó†Ê≥ïËé∑Âèñ‰ΩçÁΩÆ / Unable to get location');\n        setLocating(false);\n      }\n    );\n  };\n\n  const handleSubmit = async () => {\n    if (!authenticated) {\n      login();\n      return;\n    }\n\n    if (!pickup || !dropoff || !wechatId) {\n      alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ / Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const { error } = await supabase\n        .from('rides')\n        .insert([\n          {\n            user_address: user?.wallet?.address || user?.email?.address || 'unknown',\n            pickup_location: pickup,\n            dropoff_location: dropoff,\n            departure_time: departureTime || new Date().toISOString(),\n            wechat_id: wechatId,\n            status: 'active',\n            pickup_lat: pickupCoords?.lat,\n            pickup_lng: pickupCoords?.lng,\n            dropoff_lat: dropoffCoords?.lat,\n            dropoff_lng: dropoffCoords?.lng,\n          },\n        ])\n        .select()\n        .single();\n\n      if (error) {\n        console.error('Supabase error:', error);\n        alert(`Failed to create ride: ${error.message}`);\n        throw error;\n      }\n\n      alert('Ë°åÁ®ãÂ∑≤ÂèëÂ∏ÉÔºÅAI Ê≠£Âú®ÂØªÊâæÊãºÂèã... / Ride published!');\n\n      // Reset\n      setPickup('');\n      setDropoff('');\n      setPickupCoords(null);\n      setDropoffCoords(null);\n      setWechatId('');\n      setDepartureTime('');\n      setShowDetails(false);\n    } catch (error: any) {\n      console.error('Error creating ride:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Manual geocode when Enter is pressed\n  const handleManualGeocode = async (address: string, isPickup: boolean) => {\n    if (!address || !window.google || !window.google.maps) return;\n\n    try {\n      const geocoder = new google.maps.Geocoder();\n      const result = await geocoder.geocode({ address });\n\n      if (result.results && result.results.length > 0) {\n        const location = result.results[0].geometry.location;\n        const formattedAddress = result.results[0].formatted_address;\n        const coords = { lat: location.lat(), lng: location.lng() };\n\n        if (isPickup) {\n          setPickup(formattedAddress);\n          setPickupCoords(coords);\n          if (onPickupChange) {\n            onPickupChange(formattedAddress, coords);\n          }\n        } else {\n          setDropoff(formattedAddress);\n          setDropoffCoords(coords);\n          if (onDropoffChange) {\n            onDropoffChange(formattedAddress, coords);\n          }\n          if (pickup) {\n            setShowDetails(true);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n    }\n  };\n\n  const handleSwap = () => {\n    const tempPickup = pickup;\n    const tempPickupCoords = pickupCoords;\n\n    setPickup(dropoff);\n    setPickupCoords(dropoffCoords);\n    if (onPickupChange) onPickupChange(dropoff, dropoffCoords || undefined);\n\n    setDropoff(tempPickup);\n    setDropoffCoords(tempPickupCoords);\n    if (onDropoffChange) onDropoffChange(tempPickup, tempPickupCoords || undefined);\n  };\n\n  return (\n    <>\n      {/* Google Maps Style Search Box */}\n      <div className={`absolute top-4 left-16 z-50 w-[92%] max-w-[400px] transition-transform duration-300 ease-in-out ${className}`}>\n        {/* Places API Status Warning */}\n        {!placesApiReady && (\n          <div className=\"mb-3 bg-yellow-50 border border-yellow-200 rounded-lg p-3 shadow-sm\">\n            <div className=\"flex items-center gap-2\">\n              <svg className=\"w-5 h-5 text-yellow-600 shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n              <p className=\"text-sm text-yellow-800\">\n                <strong>Ëá™ÂãïË£úÂÖ®Â∞öÊú™Â∞±Á∑í„ÄÇ</strong> Ë´ãËº∏ÂÖ•ÂÆåÊï¥Âú∞ÂùÄÂæåÊåâ EnterÔºåÊàñ‰ΩøÁî®ÂÆö‰ΩçÊåâÈàï üìç\n              </p>\n            </div>\n          </div>\n        )}\n\n        <div className=\"bg-white rounded-2xl shadow-[0_6px_16px_rgba(0,0,0,0.12)] overflow-hidden\">\n          {/* Location Inputs Area */}\n          <div className=\"relative p-0\">\n            {/* Connector Visualization */}\n            <div className=\"absolute left-[26px] top-[26px] bottom-[26px] flex flex-col items-center pointer-events-none z-10 w-4\">\n              {/* Pickup Dot */}\n              <div className=\"w-3 h-3 rounded-full border-[3px] border-black bg-white box-border shrink-0\" />\n              {/* Vertical Line */}\n              <div className=\"flex-1 w-[2px] bg-linear-to-b from-gray-300 to-gray-400 my-1 rounded-full opacity-50\" />\n              {/* Dropoff Square */}\n              <div className=\"w-3 h-3 bg-black rounded-[1px] shrink-0\" />\n            </div>\n\n            {/* Inputs Container */}\n            <div className=\"flex flex-col\">\n              {/* Pickup Input */}\n              <div className=\"relative flex items-center pr-12\">\n                 <input\n                  ref={pickupInputRef}\n                  className=\"w-full pl-14 pr-4 py-4 text-[15px] font-medium text-[#202124] placeholder-gray-500 bg-transparent focus:outline-none focus:bg-gray-50/50 transition-colors\"\n                  placeholder={placesApiReady ? \"Ëµ∑Èªû\" : \"Ëº∏ÂÖ•Ëµ∑Èªû\"}\n                  value={pickup}\n                  onChange={(e) => {\n                    const val = e.target.value;\n                    setPickup(val);\n                    if (val === '' && onPickupChange) {\n                        setPickupCoords(null);\n                        onPickupChange('', undefined);\n                    }\n                  }}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' && !placesApiReady) {\n                      handleManualGeocode(pickup, true);\n                    }\n                  }}\n                />\n                <button\n                    onClick={handleGetCurrentLocation}\n                    disabled={locating}\n                    className=\"absolute right-3 p-2 text-gray-400 hover:text-black hover:bg-gray-100 rounded-full transition-all\"\n                    title=\"ÂÆö‰Ωç\"\n                  >\n                  {locating ? (\n                    <svg className=\"animate-spin h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\">\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                    </svg>\n                  ) : (\n                    <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <title>‰ΩøÁî®ÁèæÂú®‰ΩçÁΩÆ</title>\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\n                    </svg>\n                  )}\n                </button>\n              </div>\n\n              {/* Divider */}\n              <div className=\"ml-14 border-t border-gray-100\" />\n\n              {/* Dropoff Input */}\n              <div className=\"relative flex items-center pr-12\">\n                 <input\n                  ref={dropoffInputRef}\n                  className=\"w-full pl-14 pr-4 py-4 text-[15px] font-medium text-[#202124] placeholder-gray-500 bg-transparent focus:outline-none focus:bg-gray-50/50 transition-colors\"\n                  placeholder={placesApiReady ? \"ÁõÆÁöÑÂú∞\" : \"Ëº∏ÂÖ•ÁõÆÁöÑÂú∞\"}\n                  value={dropoff}\n                  onChange={(e) => {\n                    const val = e.target.value;\n                    setDropoff(val);\n                    if (val === '' && onDropoffChange) {\n                        setDropoffCoords(null);\n                        onDropoffChange('', undefined);\n                    }\n                  }}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' && !placesApiReady) {\n                      handleManualGeocode(dropoff, false);\n                    }\n                  }}\n                />\n                 {/* Swap Button (Floating right overlap) - Removed circle bg */}\n                  <div className=\"absolute right-3 -top-[23px] z-20\">\n                    <button\n                      onClick={handleSwap}\n                      className=\"p-1.5 text-gray-400 hover:text-black transition-colors\"\n                      title=\"ÂàáÊèõËµ∑ÁµÇÈªû\"\n                    >\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4\" />\n                      </svg>\n                    </button>\n                  </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Details Section (collapsed by default) */}\n          {showDetails && (\n            <div className=\"border-t border-gray-100 p-4 bg-white animate-in slide-in-from-top-2 duration-200\">\n              <div className=\"space-y-4\">\n                {/* Departure Time */}\n                <div>\n                  <label className=\"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1.5 ml-1\">\n                    Âá∫ÁôºÊôÇÈñì\n                  </label>\n                  <input\n                    type=\"datetime-local\"\n                    className=\"w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 font-medium focus:ring-2 focus:ring-blue-500/20 focus:bg-white transition-all\"\n                    value={departureTime}\n                    onChange={(e) => setDepartureTime(e.target.value)}\n                  />\n                </div>\n\n                {/* WeChat ID */}\n                <div>\n                   <label className=\"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-1.5 ml-1\">\n                    ÂæÆ‰ø°Ëôü <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    className=\"w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 font-medium focus:ring-2 focus:ring-blue-500/20 focus:bg-white transition-all placeholder:font-normal\"\n                    placeholder=\"Ëº∏ÂÖ•‰Ω†ÁöÑÂæÆ‰ø°Ëôü\"\n                    value={wechatId}\n                    onChange={(e) => setWechatId(e.target.value)}\n                  />\n                </div>\n\n                {/* Submit Button */}\n                <button\n                  onClick={handleSubmit}\n                  disabled={loading || !wechatId}\n                  className=\"w-full py-3.5 bg-black text-white rounded-xl font-bold text-[15px] hover:bg-gray-800 disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed transition-all shadow-lg shadow-gray-200/50\"\n                >\n                  {loading ? (\n                    <span className=\"flex items-center justify-center gap-2\">\n                       <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                      </svg>\n                      ÁôºÂ∏É‰∏≠...\n                    </span>\n                  ) : authenticated ? 'Á¢∫Ë™çÁôºÂ∏ÉË°åÁ®ã' : 'ÁôªÂÖ•‰∏¶ÁôºÂ∏É'}\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Toggle Details Button */}\n          {!showDetails && pickup && dropoff && (\n            <div className=\"border-t border-gray-100\">\n              <button\n                onClick={() => setShowDetails(true)}\n                className=\"w-full py-3 text-[#1a73e8] font-bold text-sm hover:bg-blue-50/50 transition-colors flex items-center justify-center gap-1\"\n              >\n                ‰∏ã‰∏ÄÊ≠•\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M19 9l-7 7-7-7\" />\n                 </svg>\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 809, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/lib/agent.ts"],"sourcesContent":["export interface Coordinates {\n  lat: number;\n  lng: number;\n}\n\n// Haversine formula to calculate distance in miles\nfunction calculateDistance(coord1: Coordinates, coord2: Coordinates): number {\n  const R = 3958.8; // Radius of Earth in miles\n  const dLat = (coord2.lat - coord1.lat) * (Math.PI / 180);\n  const dLon = (coord2.lng - coord1.lng) * (Math.PI / 180);\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(coord1.lat * (Math.PI / 180)) *\n    Math.cos(coord2.lat * (Math.PI / 180)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\nexport function calculateMatchScore(\n  userPickup: Coordinates | undefined,\n  userDropoff: Coordinates | undefined,\n  ridePickup: Coordinates,\n  rideDropoff: Coordinates\n): { score: number; distance: number } {\n  if (!userPickup) return { score: 0, distance: 0 };\n\n  // 1. Calculate Distances\n  const pickupDist = calculateDistance(userPickup, ridePickup);\n  // If user hasn't entered dropoff, we only score based on pickup\n  const dropoffDist = userDropoff ? calculateDistance(userDropoff, rideDropoff) : 0;\n\n  // 2. Scoring Logic\n  // Perfect score = 100\n  // Penalty: -10 points per mile for pickup\n  // Penalty: -5 points per mile for dropoff\n  // Penalty: -3 points per mile for pickup\n  // Penalty: -1 point per mile for dropoff (Ultra relaxed for demo)\n  let score = 100 - (pickupDist * 3); \n  \n  if (userDropoff) {\n    score -= (dropoffDist * 1); \n  }\n\n  // Cap score between 0 and 99 (nobody is perfect 100 unless exact calc)\n  score = Math.max(10, Math.min(99, Math.round(score)));\n\n  return {\n    score,\n    distance: parseFloat(pickupDist.toFixed(1))\n  };\n}\n"],"names":[],"mappings":";;;;AAKA,mDAAmD;AACnD,SAAS,kBAAkB,MAAmB,EAAE,MAAmB;IACjE,MAAM,IAAI,QAAQ,2BAA2B;IAC7C,MAAM,OAAO,CAAC,OAAO,GAAG,GAAG,OAAO,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,GAAG;IACvD,MAAM,OAAO,CAAC,OAAO,GAAG,GAAG,OAAO,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,GAAG;IACvD,MAAM,IACJ,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO,KACrC,KAAK,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,KAAK,EAAE,GAAG,GAAG,KACpC,KAAK,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,KAAK,EAAE,GAAG,GAAG,KACpC,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO;IACvC,MAAM,IAAI,IAAI,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;IACrD,OAAO,IAAI;AACb;AAEO,SAAS,oBACd,UAAmC,EACnC,WAAoC,EACpC,UAAuB,EACvB,WAAwB;IAExB,IAAI,CAAC,YAAY,OAAO;QAAE,OAAO;QAAG,UAAU;IAAE;IAEhD,yBAAyB;IACzB,MAAM,aAAa,kBAAkB,YAAY;IACjD,gEAAgE;IAChE,MAAM,cAAc,cAAc,kBAAkB,aAAa,eAAe;IAEhF,mBAAmB;IACnB,sBAAsB;IACtB,0CAA0C;IAC1C,0CAA0C;IAC1C,yCAAyC;IACzC,kEAAkE;IAClE,IAAI,QAAQ,MAAO,aAAa;IAEhC,IAAI,aAAa;QACf,SAAU,cAAc;IAC1B;IAEA,uEAAuE;IACvE,QAAQ,KAAK,GAAG,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC;IAE7C,OAAO;QACL;QACA,UAAU,WAAW,WAAW,OAAO,CAAC;IAC1C;AACF"}},
    {"offset": {"line": 852, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/RideChat.tsx"],"sourcesContent":["import { useEffect, useState, useRef } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { usePrivy } from '@privy-io/react-auth';\n\ninterface Message {\n  id: string;\n  ride_id: number;\n  sender_address: string;\n  content: string;\n  created_at: string;\n}\n\ninterface RideChatProps {\n    rideId: number;\n}\n\nexport default function RideChat({ rideId }: RideChatProps) {\n    const { user } = usePrivy();\n    const [messages, setMessages] = useState<Message[]>([]);\n    const [newMessage, setNewMessage] = useState('');\n    const [loading, setLoading] = useState(true);\n    const bottomRef = useRef<HTMLDivElement>(null);\n\n    const userAddress = user?.wallet?.address?.toLowerCase() || 'anon';\n\n    useEffect(() => {\n        fetchMessages();\n        const channel = supabase\n            .channel(`ride_chat:${rideId}`)\n            .on('postgres_changes', { \n                event: 'INSERT', \n                schema: 'public', \n                table: 'messages', \n                filter: `ride_id=eq.${rideId}` \n            }, (payload) => {\n                const newMsg = payload.new as Message;\n                setMessages(prev => [...prev, newMsg]);\n                scrollToBottom();\n            })\n            .subscribe();\n\n        return () => {\n            supabase.removeChannel(channel);\n        };\n    }, [rideId]);\n\n    const fetchMessages = async () => {\n        const { data } = await supabase\n            .from('messages')\n            .select('*')\n            .eq('ride_id', rideId)\n            .order('created_at', { ascending: true });\n        \n        if (data) setMessages(data);\n        setLoading(false);\n        scrollToBottom();\n    };\n\n    const sendMessage = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!newMessage.trim()) return;\n\n        const content = newMessage.trim();\n        setNewMessage(''); // Optimistic clear\n\n        const { error } = await supabase\n            .from('messages')\n            .insert({\n                ride_id: rideId,\n                sender_address: userAddress,\n                content: content\n            });\n\n        if (error) {\n            console.error(\"Failed to send:\", error);\n            alert(\"Failed to send message\");\n        }\n    };\n\n    const scrollToBottom = () => {\n        setTimeout(() => bottomRef.current?.scrollIntoView({ behavior: 'smooth' }), 100);\n    };\n\n    if (loading) return <div className=\"text-xs text-gray-400 text-center py-2\">Loading chat...</div>;\n\n    return (\n        <div className=\"bg-gray-50 rounded-lg border border-gray-200 mt-3 overflow-hidden flex flex-col h-64\">\n             {/* Header */}\n            <div className=\"bg-gray-100 px-3 py-2 border-b border-gray-200 flex justify-between items-center\">\n                <span className=\"text-xs font-bold text-gray-700\">Squad Chat üí¨</span>\n                <span className=\"text-[10px] text-gray-400\">End-to-End Encrypted (Mock)</span>\n            </div>\n\n            {/* Messages Area */}\n            <div className=\"flex-1 overflow-y-auto p-3 space-y-2\">\n                {messages.length === 0 && (\n                    <div className=\"text-center text-gray-400 text-xs mt-10\">\n                        No messages yet. Say hi! üëã\n                    </div>\n                )}\n                {messages.map((msg) => {\n                    const isMe = msg.sender_address === userAddress;\n                    return (\n                        <div key={msg.id} className={`flex ${isMe ? 'justify-end' : 'justify-start'}`}>\n                            <div className={`max-w-[80%] rounded-lg px-3 py-1.5 text-xs ${\n                                isMe ? 'bg-blue-600 text-white' : 'bg-white border border-gray-200 text-gray-800'\n                            }`}>\n                                <p>{msg.content}</p>\n                            </div>\n                        </div>\n                    );\n                })}\n                <div ref={bottomRef} />\n            </div>\n\n            {/* Input Area */}\n            <form onSubmit={sendMessage} className=\"p-2 bg-white border-t border-gray-200 flex gap-2\">\n                <input\n                    type=\"text\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    placeholder=\"Type a message...\"\n                    className=\"flex-1 text-xs border border-gray-300 rounded-md px-2 py-1.5 focus:outline-none focus:border-blue-500\"\n                />\n                <button \n                    type=\"submit\"\n                    disabled={!newMessage.trim()}\n                    className=\"bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-md hover:bg-blue-700 disabled:opacity-50\"\n                >\n                    Send\n                </button>\n            </form>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAce,SAAS,SAAS,EAAE,MAAM,EAAiB;IACtD,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,0PAAQ;IACzB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,uOAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,uOAAQ,EAAC;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,uOAAQ,EAAC;IACvC,MAAM,YAAY,IAAA,qOAAM,EAAiB;IAEzC,MAAM,cAAc,MAAM,QAAQ,SAAS,iBAAiB;IAE5D,IAAA,wOAAS,EAAC;QACN;QACA,MAAM,UAAU,iJAAQ,CACnB,OAAO,CAAC,CAAC,UAAU,EAAE,QAAQ,EAC7B,EAAE,CAAC,oBAAoB;YACpB,OAAO;YACP,QAAQ;YACR,OAAO;YACP,QAAQ,CAAC,WAAW,EAAE,QAAQ;QAClC,GAAG,CAAC;YACA,MAAM,SAAS,QAAQ,GAAG;YAC1B,YAAY,CAAA,OAAQ;uBAAI;oBAAM;iBAAO;YACrC;QACJ,GACC,SAAS;QAEd,OAAO;YACH,iJAAQ,CAAC,aAAa,CAAC;QAC3B;IACJ,GAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB;QAClB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,iJAAQ,CAC1B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;YAAE,WAAW;QAAK;QAE3C,IAAI,MAAM,YAAY;QACtB,WAAW;QACX;IACJ;IAEA,MAAM,cAAc,OAAO;QACvB,EAAE,cAAc;QAChB,IAAI,CAAC,WAAW,IAAI,IAAI;QAExB,MAAM,UAAU,WAAW,IAAI;QAC/B,cAAc,KAAK,mBAAmB;QAEtC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iJAAQ,CAC3B,IAAI,CAAC,YACL,MAAM,CAAC;YACJ,SAAS;YACT,gBAAgB;YAChB,SAAS;QACb;QAEJ,IAAI,OAAO;YACP,QAAQ,KAAK,CAAC,mBAAmB;YACjC,MAAM;QACV;IACJ;IAEA,MAAM,iBAAiB;QACnB,WAAW,IAAM,UAAU,OAAO,EAAE,eAAe;gBAAE,UAAU;YAAS,IAAI;IAChF;IAEA,IAAI,SAAS,qBAAO,oQAAC;QAAI,WAAU;kBAAyC;;;;;;IAE5E,qBACI,oQAAC;QAAI,WAAU;;0BAEX,oQAAC;gBAAI,WAAU;;kCACX,oQAAC;wBAAK,WAAU;kCAAkC;;;;;;kCAClD,oQAAC;wBAAK,WAAU;kCAA4B;;;;;;;;;;;;0BAIhD,oQAAC;gBAAI,WAAU;;oBACV,SAAS,MAAM,KAAK,mBACjB,oQAAC;wBAAI,WAAU;kCAA0C;;;;;;oBAI5D,SAAS,GAAG,CAAC,CAAC;wBACX,MAAM,OAAO,IAAI,cAAc,KAAK;wBACpC,qBACI,oQAAC;4BAAiB,WAAW,CAAC,KAAK,EAAE,OAAO,gBAAgB,iBAAiB;sCACzE,cAAA,oQAAC;gCAAI,WAAW,CAAC,2CAA2C,EACxD,OAAO,2BAA2B,iDACpC;0CACE,cAAA,oQAAC;8CAAG,IAAI,OAAO;;;;;;;;;;;2BAJb,IAAI,EAAE;;;;;oBAQxB;kCACA,oQAAC;wBAAI,KAAK;;;;;;;;;;;;0BAId,oQAAC;gBAAK,UAAU;gBAAa,WAAU;;kCACnC,oQAAC;wBACG,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;wBAC7C,aAAY;wBACZ,WAAU;;;;;;kCAEd,oQAAC;wBACG,MAAK;wBACL,UAAU,CAAC,WAAW,IAAI;wBAC1B,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAMjB"}},
    {"offset": {"line": 1046, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/RideList.tsx"],"sourcesContent":["import { useEffect, useState, useMemo } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { calculateMatchScore, Coordinates } from '@/lib/agent';\nimport { useWallets, usePrivy } from '@privy-io/react-auth';\nimport { createWalletClient, custom, parseUnits, encodeFunctionData } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\nconst BOOKING_PRICE_USDC = 0.01;\nconst BOOKING_PRICE_UNITS = parseUnits(BOOKING_PRICE_USDC.toString(), 6);\n\nconst ERC20_ABI = [\n  {\n    inputs: [\n      { name: 'to', type: 'address' },\n      { name: 'amount', type: 'uint256' },\n    ],\n    name: 'transfer',\n    outputs: [{ name: '', type: 'bool' }],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n] as const;\n\ninterface Ride {\n  id: number;\n  created_at: string;\n  user_address: string;\n  pickup_location: string;\n  dropoff_location: string;\n  departure_time: string;\n  wechat_id: string;\n  status: string;\n  // Real coordinates from DB\n  pickup_lat?: number;\n  pickup_lng?: number;\n  dropoff_lat?: number;\n  dropoff_lng?: number;\n  // Mock fields for UI demo\n  price?: number;\n  seats?: number;\n  match_score?: number;\n  ride_pickup_coords?: Coordinates;\n  ride_dropoff_coords?: Coordinates;\n  distance_from_user?: number;\n  isUnlocked?: boolean;\n}\n\ninterface RideListProps {\n  pickupCoords?: Coordinates;\n  dropoffCoords?: Coordinates;\n  onTopMatchUpdate?: (topMatch: Ride) => void;\n}\n\nimport Link from 'next/link';\nimport RideChat from './RideChat';\n\n// ... (existing code)\n\nconst SHORT_USDC_ADDRESS = `${USDC_ADDRESS.slice(0, 6)}...${USDC_ADDRESS.slice(-4)}`;\nconst V2_CONTRACT_ADDRESS = \"0x98c023cAC9084B75142ffFc50c4CE2ed022492AE\"; // Deployed on Base Sepolia\n\nexport default function RideList({ pickupCoords, dropoffCoords, onTopMatchUpdate }: RideListProps) {\n  const [rides, setRides] = useState<Ride[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState<number | null>(null); // rideId\n  const [activeChatId, setActiveChatId] = useState<number | null>(null); // For chat toggle\n  \n  const { wallets } = useWallets();\n  const { user } = usePrivy();\n\n  const onToggleChat = (rideId: number) => {\n      setActiveChatId(prev => prev === rideId ? null : rideId);\n  };\n\n  useEffect(() => {\n    fetchRides();\n  }, []);\n\n  async function fetchRides() {\n    try {\n      // 1. Fetch Public Data (Supabase)\n      const { data, error } = await supabase\n        .from('rides')\n        .select('*')\n        .order('departure_time', { ascending: true });\n\n      if (error) {\n        throw error;\n      }\n      \n      // Enrich with mock data for AI Agent\n      const enrichedRides = (data || []).map((ride: any, index: number) => {\n        // Use Real DB Coords if available, otherwise Mock (for old data)\n        const hasRealCoords = ride.pickup_lat && ride.pickup_lng && ride.dropoff_lat && ride.dropoff_lng;\n        \n        let pLat, pLng, dLat, dLng;\n\n        if (hasRealCoords) {\n             pLat = ride.pickup_lat;\n             pLng = ride.pickup_lng;\n             dLat = ride.dropoff_lat;\n             dLng = ride.dropoff_lng;\n        } else {\n            // Fallback Mock for legacy data\n            const latOffset = (index % 5 - 2) * 0.005; \n            const lngOffset = (index % 3 - 1) * 0.005;\n            pLat = 33.6846 + latOffset;\n            pLng = -117.8265 + lngOffset;\n            dLat = 33.7 + latOffset;\n            dLng = -117.8 + lngOffset;\n        }\n\n        return {\n          ...ride,\n          price: 10 + (ride.id % 25), \n          seats: 1 + (ride.id % 3),\n          // Coords used for Agent Logic\n          ride_pickup_coords: { lat: pLat, lng: pLng },\n          ride_dropoff_coords: { lat: dLat, lng: dLng },\n          // Default placeholders\n          match_score: 0,\n          isUnlocked: ride.status === 'completed' || ride.status === 'escrow_holding'\n        }\n      });\n      \n      setRides(enrichedRides);\n    } catch (error: any) {\n      console.error('Error fetching rides:', error?.message || error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // AI Agent Logic: Real-time Re-ranking\n  const sortedRides = useMemo(() => {\n    if (!rides.length) return [];\n\n    if (!pickupCoords) return rides;\n\n    const scored = rides.map(ride => {\n        if (!ride.ride_pickup_coords || !ride.ride_dropoff_coords) return ride;\n\n        const { score, distance } = calculateMatchScore(\n            pickupCoords,\n            dropoffCoords,\n            ride.ride_pickup_coords,\n            ride.ride_dropoff_coords\n        );\n\n        return {\n            ...ride,\n            match_score: score,\n            distance_from_user: distance\n        };\n    });\n\n    return scored.sort((a, b) => (b.match_score || 0) - (a.match_score || 0));\n\n  }, [rides, pickupCoords, dropoffCoords]);\n\n  // Notify parent of top match\n  useEffect(() => {\n    if (onTopMatchUpdate && sortedRides.length > 0) {\n        onTopMatchUpdate(sortedRides[0]);\n    }\n  }, [sortedRides, onTopMatchUpdate]);\n\n  // -- Escrow / Agent Actions --\n\n  const handleBook = async (ride: Ride) => {\n    try {\n        setActionLoading(ride.id);\n\n        const wallet = wallets[0];\n        if (!wallet) {\n            alert(\"Connect wallet first!\");\n            return;\n        }\n\n        // 1. Get Agent Address\n        const configRes = await fetch('/api/escrow/config');\n        const { address: agentAddress } = await configRes.json();\n        if (!agentAddress) throw new Error(\"Agent address missing\");\n\n        // 2. Send USDC to Agent\n        console.log(`Sending ${BOOKING_PRICE_USDC} USDC to Agent ${agentAddress}...`);\n        await wallet.switchChain(baseSepolia.id);\n        const provider = await wallet.getEthereumProvider();\n        const client = createWalletClient({\n            account: wallet.address as `0x${string}`,\n            chain: baseSepolia,\n            transport: custom(provider),\n        });\n\n        const data = encodeFunctionData({\n            abi: ERC20_ABI,\n            functionName: 'transfer',\n            args: [agentAddress as `0x${string}`, BOOKING_PRICE_UNITS],\n        });\n\n        // @ts-expect-error - KZG needed for blob txs but this is simple transfer\n        const hash = await client.sendTransaction({\n            to: USDC_ADDRESS,\n            data,\n        });\n        console.log(\"Tx Sent:\", hash);\n\n        // 3. Notify Agent (Deposit)\n        const depositRes = await fetch('/api/escrow/deposit', {\n            method: 'POST',\n            body: JSON.stringify({ rideId: ride.id, txHash: hash })\n        });\n        const depositData = await depositRes.json();\n        \n        if (!depositRes.ok) throw new Error(depositData.error);\n\n        // 4. Update UI\n        setRides(prev => prev.map(r => r.id === ride.id ? { ...r, status: 'escrow_holding', isUnlocked: true } : r));\n        alert(\"Ride Booked! Funds held by Agent.\");\n\n    } catch (e: any) {\n        console.error(\"Booking failed:\", e);\n        alert(`Booking Failed: ${e.message}`);\n    } finally {\n        setActionLoading(null);\n    }\n  };\n\n  // -- GPS Verification Helper --\n  function getDistanceFromLatLonInKm(lat1: number, lon1: number, lat2: number, lon2: number) {\n    const R = 6371; // Radius of the earth in km\n    const dLat = deg2rad(lat2 - lat1);\n    const dLon = deg2rad(lon2 - lon1);\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n      Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  }\n\n  function deg2rad(deg: number) {\n    return deg * (Math.PI / 180);\n  }\n\n  const handleRelease = async (ride: Ride) => {\n      // 1. GPS Check\n      if (!navigator.geolocation) {\n          alert(\"Geolocation is not supported by your browser\");\n          return;\n      }\n\n      setActionLoading(ride.id);\n\n      navigator.geolocation.getCurrentPosition(async (position) => {\n          const userLat = position.coords.latitude;\n          const userLng = position.coords.longitude;\n          \n          // Target: Ride Dropoff\n          // Check if ride has real coords, else fallback or skip check for demo\n          if (ride.dropoff_lat && ride.dropoff_lng) {\n              const distKm = getDistanceFromLatLonInKm(userLat, userLng, ride.dropoff_lat, ride.dropoff_lng);\n              const distMiles = distKm * 0.621371;\n              \n              console.log(`Debug: Distance to dropoff is ${distMiles.toFixed(2)} miles`);\n\n              // Threshold: 0.5 miles (lenient for demo, typically 0.1)\n              if (distMiles > 0.5) {\n                  alert(`Too far from destination! You are ${distMiles.toFixed(2)} miles away. Please arrive first.`);\n                  setActionLoading(null);\n                  return;\n              }\n          } else {\n              console.warn(\"Skipping GPS check: No real dropoff coords on ride.\");\n          }\n\n          // 2. Proceed with Release\n          try {\n            const res = await fetch('/api/escrow/release', {\n                method: 'POST',\n                body: JSON.stringify({ rideId: ride.id })\n            });\n            const data = await res.json();\n            if (!res.ok) throw new Error(data.error);\n\n            setRides(prev => prev.map(r => r.id === ride.id ? { ...r, status: 'completed' } : r));\n            alert(`Funds Released! Organizer received ${data.driverAmount}`);\n\n          } catch (e: any) {\n             console.error(\"Release failed:\", e);\n             alert(`Release Failed: ${e.message}`);\n          } finally {\n            setActionLoading(null);\n          }\n      }, (err) => {\n          console.error(\"GPS Error\", err);\n          alert(\"Could not get your location. verification failed.\");\n          setActionLoading(null);\n      });\n  };\n\n  const openInUber = (ride: Ride) => {\n      // Use Enriched Coordinates (handles both Real DB and Mock Fallback)\n      const pLat = ride.ride_pickup_coords?.lat;\n      const pLng = ride.ride_pickup_coords?.lng;\n      const dLat = ride.ride_dropoff_coords?.lat;\n      const dLng = ride.ride_dropoff_coords?.lng;\n\n      if (!pLat || !pLng || !dLat || !dLng) {\n          alert(\"Missing coordinates for this ride.\");\n          return;\n      }\n\n      // Construct Universal Link with Explicit Pickup & Dropoff\n      // Use encodedURIComponent for everything just in case\n      // Format: https://m.uber.com/ul/?action=setPickup&client_id=...&pickup[latitude]=...\n      \n      const baseUrl = \"https://m.uber.com/ul/\";\n      const params = new URLSearchParams({\n        action: 'setPickup',\n        client_id: 'pincher_demo',\n        'pickup[latitude]': pLat.toString(),\n        'pickup[longitude]': pLng.toString(),\n        'pickup[nickname]': ride.pickup_location,\n        'dropoff[latitude]': dLat.toString(),\n        'dropoff[longitude]': dLng.toString(),\n        'dropoff[nickname]': ride.dropoff_location,\n      });\n      \n      const url = `${baseUrl}?${params.toString()}`;\n      \n      console.log(\"Uber Deep Link:\", url);\n      window.open(url, '_blank');\n  };\n\n  const handleCopyWeChat = (text: string) => {\n      navigator.clipboard.writeText(text);\n      alert(\"WeChat ID Copied!\");\n  };\n\n\n  if (loading) return (\n      <div className=\"flex justify-center p-8\">\n          <div className=\"w-6 h-6 border-2 border-gray-200 border-t-black rounded-full animate-spin\"></div>\n      </div>\n  );\n\n  const displayedRides = sortedRides.filter(r => r.status !== 'completed' && r.status !== 'cancelled');\n\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col px-1\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-bold text-gray-900\">Available Rides</h2>\n            <span className=\"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded-full\">{displayedRides.length}</span>\n          </div>\n          <p className=\"text-[10px] text-gray-400 font-mono mt-1\">\n            V2 Contract: <a href={`https://sepolia.basescan.org/address/${V2_CONTRACT_ADDRESS}`} target=\"_blank\" className=\"underline hover:text-blue-600\">{V2_CONTRACT_ADDRESS.slice(0,6)}...{V2_CONTRACT_ADDRESS.slice(-4)}</a>\n          </p>\n      </div>\n      \n      {displayedRides.length === 0 ? (\n        <div className=\"text-center py-10 bg-gray-50 rounded-xl border border-dashed border-gray-200\">\n            <p className=\"text-sm text-gray-500\">No rides available.</p>\n            <p className=\"text-xs text-gray-400 mt-1\">Be the first to create one!</p>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {displayedRides.map((ride) => {\n            const date = new Date(ride.departure_time);\n            const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n            const isBooking = actionLoading === ride.id;\n            \n            return (\n                <div\n                key={ride.id}\n                className={`group p-4 bg-white border rounded-xl shadow-sm transition-all relative overflow-hidden ${\n                    ride.status === 'escrow_holding' ? 'border-yellow-200 bg-yellow-50/10' : \n                    ride.status === 'completed' ? 'border-green-200 bg-green-50/10' : 'border-gray-100 hover:shadow-md'\n                }`}\n                >\n                <div className={`absolute left-0 top-0 bottom-0 w-1 transition-colors ${\n                    ride.status === 'escrow_holding' ? 'bg-yellow-400' : \n                    ride.status === 'completed' ? 'bg-green-500' : 'bg-black group-hover:bg-blue-600'\n                }`}></div>\n                \n                <div className=\"flex flex-col gap-3 pl-2\">\n                    {/* Header: Match Score & Status */}\n                    <div className=\"flex justify-between items-start\">\n                        <div className=\"flex items-center gap-2\">\n                             <div className={`px-2 py-1 rounded-md text-[10px] font-bold flex items-center gap-1 ${\n                                 (ride.match_score || 0) > 85 ? 'bg-green-100 text-green-700' :\n                                 (ride.match_score || 0) > 60 ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-600'\n                             }`}>\n                                <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" /></svg>\n                                {ride.match_score}% Match\n                            </div>\n                        </div>\n                        <span className={`px-2 py-1 rounded-full font-medium capitalize text-[10px] border ${\n                            ride.status === 'escrow_holding' ? 'bg-yellow-100 text-yellow-800 border-yellow-200' :\n                            ride.status === 'completed' ? 'bg-green-100 text-green-800 border-green-200' : \n                            'bg-blue-50 text-blue-700 border-blue-100'\n                        }`}>\n                            {ride.status === 'escrow_holding' ? 'Agent Holding Funds' : ride.status}\n                        </span>\n                    </div>\n\n                    {/* Route */}\n                    <div className=\"flex flex-col gap-2 relative py-1\">\n                        <div className=\"absolute left-[5px] top-[10px] bottom-[10px] w-px bg-gray-200\"></div>\n                        <div className=\"flex items-start gap-3\">\n                            <div className=\"w-2.5 h-2.5 rounded-full border-2 border-gray-900 bg-white shrink-0 z-10 mt-1\"></div>\n                            <p className=\"text-sm font-semibold text-gray-900 leading-tight\">\n                                {ride.pickup_location.split(',')[0]}\n                            </p>\n                        </div>\n                        <div className=\"flex items-start gap-3\">\n                            <div className=\"w-2.5 h-2.5 rounded-sm bg-gray-900 shrink-0 z-10 mt-1\"></div>\n                            <p className=\"text-sm font-semibold text-gray-900 leading-tight\">\n                                {ride.dropoff_location.split(',')[0]}\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Info Row */}\n                    <div className=\"grid grid-cols-3 gap-2 mt-2 pt-3 border-t border-gray-50\">\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-wider\">Depart</span>\n                            <span className=\"text-xs font-semibold text-gray-900\">{timeStr}</span>\n                        </div>\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-wider\">Price</span>\n                            <span className=\"text-xs font-semibold text-blue-600 font-mono\">0.01 USDC</span>\n                        </div>\n                         <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-wider\">Status</span>\n                            <span className=\"text-xs font-semibold text-gray-900\">{ride.status === 'active' ? 'Open' : 'Booked'}</span>\n                        </div>\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"mt-3 pt-2 border-t border-dashed border-gray-100\">\n                        {ride.status === 'active' && (\n                            <button\n                                onClick={() => handleBook(ride)}\n                                disabled={isBooking}\n                                className=\"w-full py-2 bg-black text-white rounded-lg text-xs font-bold hover:bg-gray-800 disabled:bg-gray-400 transition-colors flex items-center justify-center gap-2\"\n                            >\n                                {isBooking ? 'Minting Seat Token...' : 'Join Carpool (0.01 USDC)'}\n                            </button>\n                        )}\n                        \n                        {ride.status === 'escrow_holding' && (\n                            <div className=\"flex flex-col gap-2\">\n                                <p className=\"text-[10px] text-center text-gray-500 bg-gray-50 p-1.5 rounded\">\n                                    Agent is holding funds. Ride in progress.\n                                </p>\n                                <div className=\"flex gap-2\">\n                                    {/* Check if current user is the organizer */}\n                                    {user?.wallet?.address && ride.user_address && \n                                     user.wallet.address.toLowerCase() === ride.user_address.toLowerCase() ? (\n                                        <button\n                                            onClick={() => openInUber(ride)}\n                                            className=\"flex-1 py-2 bg-black text-white rounded-lg text-xs font-bold hover:bg-gray-800 transition-colors flex items-center justify-center gap-1\"\n                                        >\n                                            üöó Open Uber (Organizer)\n                                        </button>\n                                    ) : (\n                                        <button\n                                            disabled\n                                            className=\"flex-1 py-2 bg-gray-100 text-gray-400 rounded-lg text-[10px] font-bold cursor-not-allowed flex items-center justify-center gap-1\"\n                                        >\n                                            ‚úã Waiting for Organizer\n                                        </button>\n                                    )}\n\n                                    <button\n                                        onClick={() => handleRelease(ride)}\n                                        disabled={isBooking}\n                                        className=\"flex-1 py-2 bg-green-600 text-white rounded-lg text-xs font-bold hover:bg-green-700 disabled:bg-green-400 transition-colors\"\n                                    >\n                                        {isBooking ? 'Verifying...' : '‚úÖ I Arrived'}\n                                    </button>\n                                </div>\n                                <div className=\"text-center text-[10px] text-gray-400\">\n                                    GPS Check: Must be within 0.5 miles\n                                </div>\n                            </div>\n                        )}\n                        \n                         {ride.status === 'completed' && (\n                            <div className=\"text-center text-xs font-medium text-green-600 bg-green-50 py-2 rounded-lg\">\n                                Ride Completed & Paid\n                            </div>\n                        )}\n                    </div>\n\n                     {/* Footer: WeChat & Chat Toggle */}\n                    {(ride.status === 'escrow_holding' || ride.status === 'completed') && (\n                        <div className=\"flex items-center justify-between mt-2 pt-2 border-t border-gray-50\">\n                             {/* WeChat ID */}\n                             <div className=\"flex items-center gap-2\">\n                                <div className=\"w-4 h-4 rounded-full bg-green-100 flex items-center justify-center\">\n                                     <svg className=\"w-2.5 h-2.5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 8h8v2H8V8zm0 4h8v2H8v-2z\" /></svg>\n                                </div>\n                                 <p className=\"text-[11px] text-gray-600 truncate flex items-center gap-2\">\n                                    Organizer: <span className=\"font-bold select-all\">{ride.wechat_id}</span>\n                                    <button \n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            handleCopyWeChat(ride.wechat_id);\n                                        }}\n                                        className=\"text-gray-400 hover:text-blue-600 transition-colors\"\n                                        title=\"Copy ID\"\n                                    >\n                                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 012 2v-8a2 2 0 01-2-2h-8a2 2 0 01-2 2v8a2 2 0 012 2z\" /></svg>\n                                    </button>\n                                </p>\n                            </div>\n\n                            {/* Chat Toggle Button */}\n                            <button\n                                onClick={(e) => {\n                                    e.stopPropagation();\n                                    // Toggle logic handled by local state or parent? \n                                    // For simplicity, let's just create a quick local expand state in the map? \n                                    // Better: The map block is complex. Let's make RideItem a subcomponent?\n                                    // Too much refactor. Let's just use a details element or hack a toggle?\n                                    // Actually, let's just always show the chat button, and if clicked, we toggle a visible state.\n                                    // We'll need a state tracking \"chatOpenId\".\n                                    onToggleChat(ride.id);\n                                }}\n                                className=\"text-xs font-bold text-blue-600 bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100 transition-colors flex items-center gap-1\"\n                            >\n                                üí¨ Chat\n                            </button>\n                        </div>\n                    )}\n                    \n                    {/* Render Chat if Open */}\n                    {activeChatId === ride.id && (\n                        <RideChat rideId={ride.id} />\n                    )}\n                </div>\n                </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1907, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/MapSidebar.tsx"],"sourcesContent":["'use client';\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport RideList from './RideList';\n\ninterface MapSidebarProps {\n  isOpen: boolean;\n  onToggle: () => void;\n  pickupCoords?: { lat: number; lng: number };\n  dropoffCoords?: { lat: number; lng: number };\n  onTopMatchUpdate?: (topMatch: any) => void;\n}\n\nexport default function MapSidebar({ isOpen, onToggle, pickupCoords, dropoffCoords, onTopMatchUpdate }: MapSidebarProps) {\n  const { authenticated } = usePrivy();\n\n  if (!authenticated) return null;\n\n  return (\n    <>\n      {/* Hamburger Toggle Button - Now controlled by parent or rendered here but triggering prop */}\n      <button\n        onClick={onToggle}\n        className={`absolute top-4 left-4 z-60 p-2.5 bg-white rounded-full shadow-md text-gray-700 hover:bg-gray-50 transition-all duration-300 pointer-events-auto ${isOpen ? 'translate-x-[320px]' : 'translate-x-0'}`}\n        aria-label=\"Toggle Sidebar\"\n      >\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          {isOpen ? (\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          ) : (\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\n          )}\n        </svg>\n      </button>\n\n      {/* Sidebar Overlay (closes when clicking background) */}\n      {isOpen && (\n        <div \n          className=\"fixed inset-0 bg-black/20 z-55 backdrop-blur-[1px] transition-opacity\"\n          onClick={onToggle}\n        />\n      )}\n\n      {/* Sidebar Panel */}\n      <div \n        className={`fixed top-0 left-0 bottom-0 w-[320px] bg-white shadow-2xl z-58 flex flex-col transition-transform duration-300 ease-in-out ${\n          isOpen ? 'translate-x-0' : '-translate-x-full'\n        }`}\n      >\n        {/* Header Branding */}\n        <div className=\"p-5 border-b border-gray-100 bg-white shrink-0 pt-8\">\n            <h2 className=\"text-2xl font-extrabold text-gray-900 tracking-tight\">Pincher</h2>\n            <p className=\"text-xs text-gray-500 font-medium\">Smart Ride Sharing</p>\n        </div>\n\n        {/* Ride List Content */}\n        <div className=\"flex-1 overflow-y-auto bg-gray-50/50\">\n          <div className=\"p-4\">\n            <RideList pickupCoords={pickupCoords} dropoffCoords={dropoffCoords} onTopMatchUpdate={onTopMatchUpdate} />\n          </div>\n        </div>\n        \n        {/* Footer */}\n        <div className=\"p-3 border-t border-gray-100 text-center text-xs text-gray-400 bg-white\">\n          Pincher ¬© 2025\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAae,SAAS,WAAW,EAAE,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,aAAa,EAAE,gBAAgB,EAAmB;IACrH,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,0PAAQ;IAElC,IAAI,CAAC,eAAe,OAAO;IAE3B,qBACE;;0BAEE,oQAAC;gBACC,SAAS;gBACT,WAAW,CAAC,gJAAgJ,EAAE,SAAS,wBAAwB,iBAAiB;gBAChN,cAAW;0BAEX,cAAA,oQAAC;oBAAI,WAAU;oBAAU,MAAK;oBAAO,QAAO;oBAAe,SAAQ;8BAChE,uBACC,oQAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,aAAa;wBAAG,GAAE;;;;;6CAErE,oQAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,aAAa;wBAAG,GAAE;;;;;;;;;;;;;;;;YAM1E,wBACC,oQAAC;gBACC,WAAU;gBACV,SAAS;;;;;;0BAKb,oQAAC;gBACC,WAAW,CAAC,2HAA2H,EACrI,SAAS,kBAAkB,qBAC3B;;kCAGF,oQAAC;wBAAI,WAAU;;0CACX,oQAAC;gCAAG,WAAU;0CAAuD;;;;;;0CACrE,oQAAC;gCAAE,WAAU;0CAAoC;;;;;;;;;;;;kCAIrD,oQAAC;wBAAI,WAAU;kCACb,cAAA,oQAAC;4BAAI,WAAU;sCACb,cAAA,oQAAC,wJAAQ;gCAAC,cAAc;gCAAc,eAAe;gCAAe,kBAAkB;;;;;;;;;;;;;;;;kCAK1F,oQAAC;wBAAI,WAAU;kCAA0E;;;;;;;;;;;;;;AAMjG"}},
    {"offset": {"line": 2041, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/UserProfile.tsx"],"sourcesContent":["'use client';\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport { useState, useEffect } from 'react';\nimport { createPublicClient, http, formatUnits, erc20Abi } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\n\nexport default function UserProfile() {\n  const { user, logout, authenticated } = usePrivy();\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [funding, setFunding] = useState(false);\n  const [balance, setBalance] = useState<string>('0.00');\n  const [ethBalance, setEthBalance] = useState<string>('0.00');\n\n  useEffect(() => {\n    if (authenticated && user?.wallet?.address) {\n        fetchBalance();\n    }\n  }, [authenticated, user?.wallet?.address, showDropdown]);\n\n  const fetchBalance = async () => {\n    try {\n        const client = createPublicClient({\n            chain: baseSepolia,\n            transport: http(),\n        });\n\n        // Fetch USDC Balance\n        console.log(\"Fetching balance for:\", user!.wallet!.address);\n        \n        // @ts-expect-error - viem type inference issue\n        const usdcData = await client.readContract({\n            address: USDC_ADDRESS,\n            abi: erc20Abi,\n            functionName: 'balanceOf',\n            args: [user!.wallet!.address as `0x${string}`],\n        });\n        console.log(\"Raw USDC Data:\", usdcData);\n        \n        const usdcFormatted = formatUnits(usdcData as bigint, 6);\n        console.log(\"Formatted USDC:\", usdcFormatted);\n        \n        setBalance(parseFloat(usdcFormatted).toFixed(2));\n\n        // Fetch ETH Balance\n        const ethData = await client.getBalance({ \n            address: user!.wallet!.address as `0x${string}` \n        });\n        const ethFormatted = formatUnits(ethData, 18);\n        setEthBalance(parseFloat(ethFormatted).toFixed(4));\n\n    } catch (e) {\n        console.error(\"Balance fetch error\", e);\n    }\n  };\n\n  if (!authenticated) return null;\n\n  const displayName = user?.email?.address || \n    (user?.wallet?.address ? `${user.wallet.address.slice(0, 6)}...${user.wallet.address.slice(-4)}` : 'User');\n\n  const handleFundWallet = async () => {\n    if (!user?.wallet?.address) return;\n    setFunding(true);\n    try {\n      const res = await fetch('/api/faucet', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ address: user.wallet.address }),\n      });\n      const data = await res.json();\n      if (data.success) {\n        alert('Funding successful! Check your wallet on Base Sepolia.');\n        fetchBalance(); // Refresh\n      } else {\n        alert('Funding failed: ' + (data.error || 'Unknown error'));\n      }\n    } catch (e) {\n      alert('Funding error');\n    } finally {\n      setFunding(false);\n    }\n  };\n\n  return (\n    <div className=\"absolute top-4 right-4 z-50 font-sans\">\n      <div className=\"relative\">\n        <button\n          onClick={() => setShowDropdown(!showDropdown)}\n          className=\"flex items-center gap-3 bg-white px-4 py-2.5 rounded-full shadow-md hover:shadow-lg transition-shadow border border-gray-100\"\n        >\n          <div className=\"w-8 h-8 rounded-full bg-linear-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xs\">\n            {displayName[0].toUpperCase()}\n          </div>\n          <span className=\"text-sm font-medium text-gray-700 hidden sm:block\">\n            {displayName}\n          </span>\n          <svg className={`w-4 h-4 text-gray-400 transition-transform ${showDropdown ? 'rotate-180' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n\n        {showDropdown && (\n          <div className=\"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden py-1 animate-in fade-in slide-in-from-top-2 duration-200\">\n            <div className=\"px-4 py-3 border-b border-gray-50 bg-gray-50/50\">\n              <p className=\"text-xs text-gray-500 uppercase tracking-wider font-semibold\">Signed in as</p>\n              <div className=\"flex flex-col gap-1\">\n                <div className=\"flex items-center gap-2 bg-gray-50 p-2 rounded border border-gray-100\">\n                    <p className=\"text-[10px] font-mono text-gray-500 break-all leading-tight select-all\">\n                        {user?.wallet?.address}\n                    </p>\n                    <button \n                        onClick={() => {\n                            if (user?.wallet?.address) {\n                                navigator.clipboard.writeText(user.wallet.address);\n                                alert('Address copied!');\n                            }\n                        }}\n                        className=\"text-gray-400 hover:text-blue-600 shrink-0\"\n                        title=\"Copy Address\"\n                    >\n                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" /></svg>\n                    </button>\n                    {user?.wallet?.address && (\n                        <a \n                            href={`https://sepolia.basescan.org/address/${user.wallet.address}`}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"text-blue-500 hover:text-blue-700 shrink-0\"\n                            title=\"View on Explorer\"\n                        >\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" /></svg>\n                        </a>\n                    )}\n                </div>\n              </div>\n              \n              <div className=\"mt-3 flex flex-col gap-2\">\n                  <div className=\"flex items-center justify-between bg-white border border-gray-200 rounded-md px-2 py-1.5\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm\">üí∞</span>\n                        <span className=\"text-xs font-bold text-gray-800\">{balance} USDC</span>\n                      </div>\n                  </div>\n                  <div className=\"flex items-center justify-between bg-white border border-gray-200 rounded-md px-2 py-1.5\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm\">‚õΩÔ∏è</span>\n                        <span className=\"text-xs font-bold text-gray-800\">{ethBalance} ETH</span>\n                      </div>\n                       <button onClick={fetchBalance} className=\"text-gray-400 hover:text-blue-600\" title=\"Refresh\">\n                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" /></svg>\n                      </button>\n                  </div>\n              </div>\n            </div>\n            \n            {/* Faucet Links */}\n            <div className=\"p-2 border-b border-gray-50 bg-blue-50/30\">\n                <p className=\"text-[10px] font-bold text-blue-600 px-2 uppercase tracking-wider mb-1\">Get Testnet Funds</p>\n                <a\n                    href=\"https://portal.cdp.coinbase.com/products/faucet\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"px-2 py-1.5 text-xs text-gray-700 hover:bg-blue-100 rounded transition-colors flex items-center justify-between\"\n                >\n                    <span>Base ETH ‚õΩÔ∏è</span>\n                    <span className=\"text-gray-400\">‚Üó</span>\n                </a>\n                 <a\n                    href=\"https://faucet.circle.com/\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"px-2 py-1.5 text-xs text-gray-700 hover:bg-blue-100 rounded transition-colors flex items-center justify-between\"\n                >\n                    <span>USDC Token üí∞</span>\n                    <span className=\"text-gray-400\">‚Üó</span>\n                </a>\n            </div>\n\n            <button\n              onClick={logout}\n              className=\"w-full text-left px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center gap-2\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                 <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n              </svg>\n              Sign Out\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2528, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/Directions.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useMap, useMapsLibrary } from '@vis.gl/react-google-maps';\n\ninterface DirectionsProps {\n  pickup?: { lat: number; lng: number };\n  dropoff?: { lat: number; lng: number };\n}\n\nexport default function Directions({ pickup, dropoff }: DirectionsProps) {\n  const map = useMap();\n  const routesLibrary = useMapsLibrary('routes');\n  const [directionsService, setDirectionsService] = useState<google.maps.DirectionsService>();\n  const [directionsRenderer, setDirectionsRenderer] = useState<google.maps.DirectionsRenderer>();\n\n  // 1. Initialize Services\n  useEffect(() => {\n    if (!routesLibrary || !map) return;\n\n    const ds = new routesLibrary.DirectionsService();\n    // Suppress default markers so we can use our custom sexy markers\n    const dr = new routesLibrary.DirectionsRenderer({\n        map,\n        suppressMarkers: true, \n        polylineOptions: {\n            strokeColor: '#2563EB', // Tech Blue (matches app theme)\n            strokeWeight: 6,\n            strokeOpacity: 1.0,\n        }\n    });\n\n    setDirectionsService(ds);\n    setDirectionsRenderer(dr);\n\n    return () => {\n        dr.setMap(null); // Cleanup\n    };\n  }, [routesLibrary, map]);\n\n  // 2. Fetch Route\n  useEffect(() => {\n    if (!directionsService || !directionsRenderer) return;\n\n    // Check inputs\n    if (!pickup || !dropoff) {\n        // Clear route if points removed\n        directionsRenderer.setDirections({ routes: [] } as any); \n        return;\n    }\n\n    console.log(\"üìç Directions: Fetching route...\", { pickup, dropoff });\n\n    directionsService.route({\n        origin: pickup,\n        destination: dropoff,\n        travelMode: google.maps.TravelMode.DRIVING,\n    }).then(response => {\n        console.log(\"‚úÖ Directions: Found route!\", response);\n        directionsRenderer.setDirections(response);\n    }).catch(e => {\n        console.error(\"‚ùå Directions request failed\", e);\n    });\n\n  }, [directionsService, directionsRenderer, pickup, dropoff]);\n\n  return null; // Logic only, renders directly on map instance\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAOe,SAAS,WAAW,EAAE,MAAM,EAAE,OAAO,EAAmB;IACrE,MAAM,MAAM,IAAA,kNAAM;IAClB,MAAM,gBAAgB,IAAA,0NAAc,EAAC;IACrC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,uOAAQ;IAC1D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,uOAAQ;IAE5D,yBAAyB;IACzB,IAAA,wOAAS,EAAC;QACR,IAAI,CAAC,iBAAiB,CAAC,KAAK;QAE5B,MAAM,KAAK,IAAI,cAAc,iBAAiB;QAC9C,iEAAiE;QACjE,MAAM,KAAK,IAAI,cAAc,kBAAkB,CAAC;YAC5C;YACA,iBAAiB;YACjB,iBAAiB;gBACb,aAAa;gBACb,cAAc;gBACd,eAAe;YACnB;QACJ;QAEA,qBAAqB;QACrB,sBAAsB;QAEtB,OAAO;YACH,GAAG,MAAM,CAAC,OAAO,UAAU;QAC/B;IACF,GAAG;QAAC;QAAe;KAAI;IAEvB,iBAAiB;IACjB,IAAA,wOAAS,EAAC;QACR,IAAI,CAAC,qBAAqB,CAAC,oBAAoB;QAE/C,eAAe;QACf,IAAI,CAAC,UAAU,CAAC,SAAS;YACrB,gCAAgC;YAChC,mBAAmB,aAAa,CAAC;gBAAE,QAAQ,EAAE;YAAC;YAC9C;QACJ;QAEA,QAAQ,GAAG,CAAC,oCAAoC;YAAE;YAAQ;QAAQ;QAElE,kBAAkB,KAAK,CAAC;YACpB,QAAQ;YACR,aAAa;YACb,YAAY,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO;QAC9C,GAAG,IAAI,CAAC,CAAA;YACJ,QAAQ,GAAG,CAAC,8BAA8B;YAC1C,mBAAmB,aAAa,CAAC;QACrC,GAAG,KAAK,CAAC,CAAA;YACL,QAAQ,KAAK,CAAC,+BAA+B;QACjD;IAEF,GAAG;QAAC;QAAmB;QAAoB;QAAQ;KAAQ;IAE3D,OAAO,MAAM,+CAA+C;AAC9D"}},
    {"offset": {"line": 2601, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/app/uber/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { APIProvider, Map, ControlPosition, AdvancedMarker, Pin } from \"@vis.gl/react-google-maps\";\nimport SearchBox from \"@/components/SearchBox\";\nimport MapSidebar from \"@/components/MapSidebar\";\nimport UserProfile from \"@/components/UserProfile\";\nimport Directions from \"@/components/Directions\";\n\nexport default function UberPage() {\n  const apiKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || \"\";\n  const [pickupCoords, setPickupCoords] = useState<{ lat: number; lng: number } | undefined>();\n  const [dropoffCoords, setDropoffCoords] = useState<{ lat: number; lng: number } | undefined>();\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false);\n  const [topMatch, setTopMatch] = useState<any>(null); // State for Notification\n  \n  // Auto-open sidebar if high match found? Or just show notification.\n  // We'll show notification.\n\n  // Default center: Orange County\n  const center = pickupCoords || dropoffCoords || { lat: 33.6846, lng: -117.8265 };\n\n  const handlePickupChange = (_location: string, coords?: { lat: number; lng: number }) => {\n    if (coords) {\n      setPickupCoords(coords);\n    }\n  };\n\n  const handleDropoffChange = (_location: string, coords?: { lat: number; lng: number }) => {\n    if (coords) {\n      setDropoffCoords(coords);\n    }\n  };\n\n  return (\n    <>\n      {/* Global Style for Google Places Autocomplete */}\n      <style jsx global>{`\n        .pac-container {\n          z-index: 9999 !important;\n          border-radius: 8px;\n          box-shadow:\n            0 4px 6px -1px rgb(0 0 0 / 0.1),\n            0 2px 4px -2px rgb(0 0 0 / 0.1);\n          border: none;\n          margin-top: 4px;\n        }\n        .pac-item {\n          padding: 12px 16px;\n          cursor: pointer;\n          border: none;\n          font-size: 14px;\n        }\n        .pac-item:hover {\n          background-color: #f3f4f6;\n        }\n        .pac-icon {\n          display: none;\n        }\n        .pac-item-query {\n          font-size: 14px;\n          font-weight: 500;\n          color: #111827;\n        }\n      `}</style>\n\n      <div className=\"h-screen w-screen flex relative overflow-hidden\">\n        {/* Sidebar */}\n        {/* Sidebar */}\n        <MapSidebar \n          isOpen={isSidebarOpen} \n          onToggle={() => setIsSidebarOpen(!isSidebarOpen)} \n          pickupCoords={pickupCoords}\n          dropoffCoords={dropoffCoords}\n          onTopMatchUpdate={setTopMatch}\n        />\n        \n        {/* Top Right User Profile */}\n        <UserProfile />\n\n        {/* Map Container */}\n        <div className=\"flex-1 relative h-full\">\n          {apiKey ? (\n            <APIProvider apiKey={apiKey} libraries={[\"places\", \"marker\"]}>\n              <Map\n                key={`${center.lat}-${center.lng}`}\n                defaultCenter={center}\n                defaultZoom={pickupCoords || dropoffCoords ? 13 : 11}\n                gestureHandling=\"greedy\"\n                disableDefaultUI={true}\n                mapId=\"DEMO_MAP_ID\"\n                mapTypeControlOptions={{ position: ControlPosition.BOTTOM_LEFT }}\n                className=\"w-full h-full\"\n              >\n                {pickupCoords && (\n                  <AdvancedMarker \n                    position={pickupCoords}\n                    draggable={true}\n                    onDragEnd={(e: any) => {\n                        if (e.latLng) {\n                            const newLat = e.latLng.lat();\n                            const newLng = e.latLng.lng();\n                            setPickupCoords({ lat: newLat, lng: newLng });\n                        }\n                    }}\n                  >\n                    <Pin background={'#000000'} glyphColor={'#ffffff'} borderColor={'#000000'} />\n                  </AdvancedMarker>\n                )}\n                {dropoffCoords && (\n                   <AdvancedMarker \n                    position={dropoffCoords}\n                    draggable={true}\n                    onDragEnd={(e: any) => {\n                        if (e.latLng) {\n                            const newLat = e.latLng.lat();\n                            const newLng = e.latLng.lng();\n                            setDropoffCoords({ lat: newLat, lng: newLng });\n                        }\n                    }}\n                   >\n                    <Pin background={'#ffffff'} glyphColor={'#000000'} borderColor={'#000000'} />\n                  </AdvancedMarker>\n                )}\n                \n                {/* Route Line */}\n                <Directions pickup={pickupCoords} dropoff={dropoffCoords} />\n              </Map>\n              {/* Search Box with sliding effect */}\n              <SearchBox \n                onPickupChange={handlePickupChange} \n                onDropoffChange={handleDropoffChange} \n                className={isSidebarOpen ? 'translate-x-[320px]' : ''}\n                externalPickupCoords={pickupCoords}\n                externalDropoffCoords={dropoffCoords}\n              />\n              \n              {/* Match Notification Pill */}\n              {topMatch && topMatch.match_score > 60 && !isSidebarOpen && (\n                  <div \n                    className=\"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-xl p-2 pr-4 flex items-center gap-3 cursor-pointer hover:scale-105 transition-transform animate-in slide-in-from-bottom-4 duration-500 z-50 border border-gray-100\"\n                    onClick={() => setIsSidebarOpen(true)}\n                  >\n                      <div className=\"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center shrink-0\">\n                          <span className=\"text-sm font-bold text-green-700\">{topMatch.match_score}%</span>\n                      </div>\n                      <div className=\"flex flex-col\">\n                          <span className=\"text-xs font-bold text-gray-900 border-b border-gray-100 pb-0.5\">High Match Found!</span>\n                          <span className=\"text-[10px] text-gray-500\">{topMatch.seats} seats ‚Ä¢ ${topMatch.price}</span>\n                      </div>\n                      <div className=\"w-8 h-8 rounded-full bg-black flex items-center justify-center text-white\">\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" /></svg>\n                      </div>\n                  </div>\n              )}\n            </APIProvider>\n          ) : (\n            <div className=\"flex items-center justify-center h-full bg-gray-200\">\n              <div className=\"text-center p-8 bg-white rounded-lg shadow-lg\">\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                  ÈúÄË¶Å Google Maps API Key\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Ë´ãÂú® .env Êñá‰ª∂‰∏≠Ê∑ªÂä†ÔºöNEXT_PUBLIC_GOOGLE_MAPS_API_KEY\n                </p>\n              </div>\n              {/* Fallback SearchBox display if no API Key (functionality will be limited) */}\n               <SearchBox \n                 onPickupChange={handlePickupChange} \n                 onDropoffChange={handleDropoffChange}\n                 className={isSidebarOpen ? 'translate-x-[320px]' : ''}\n                 externalPickupCoords={pickupCoords}\n                 externalDropoffCoords={dropoffCoords}\n               />\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}