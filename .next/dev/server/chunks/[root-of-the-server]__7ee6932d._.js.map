{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/app/api/rides/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { createClient } from '@supabase/supabase-js';\n\n// Constants for the payment\n// 0.01 USDC (USDC has 6 decimals, so 10000 = 0.01)\nconst PRICE_AMOUNT = \"10000\"; \n// Base Sepolia USDC Address\nconst TOKEN_ADDRESS = \"0x036CbD53842c5426634e7929541eC2318f3dCF7e\"; \n// Your Wallet Address (The Facilitator/Receiver) - Replace with your own for testing!\nconst RECIPIENT_ADDRESS = \"0x872989F7fCd4048acA370161989d3904E37A3cB3\"; \n\nexport async function GET(req: Request) {\n  // 1. Get the Authorization Header\n  const authHeader = req.headers.get('authorization');\n\n  // 2. Check if the user has paid\n  const isPaid = authHeader && authHeader.startsWith(\"402 \");\n\n  if (!isPaid) {\n    // 3. Return 402 Payment Required\n    return NextResponse.json(\n      { error: \"Payment Required\" }, \n      { \n        status: 402,\n        headers: {\n          'x-402-price': PRICE_AMOUNT,\n          'x-402-token': TOKEN_ADDRESS,\n          'x-402-recipient': RECIPIENT_ADDRESS,\n          'Access-Control-Expose-Headers': 'x-402-price, x-402-token, x-402-recipient' \n        }\n      }\n    );\n  }\n\n  // 4. Return the Protected Data (if paid)\n  // Fetch real data from Supabase\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || !supabaseKey) {\n     return NextResponse.json({ error: \"Supabase configuration missing\" }, { status: 500 });\n  }\n\n  const supabase = createClient(supabaseUrl, supabaseKey);\n\n  const { data: protectedRides, error } = await supabase\n    .from('rides')\n    .select('id, wechat_id');\n\n  if (error) {\n    console.error(\"Supabase Error:\", error);\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n\n  return NextResponse.json({ success: true, data: protectedRides });\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,4BAA4B;AAC5B,mDAAmD;AACnD,MAAM,eAAe;AACrB,4BAA4B;AAC5B,MAAM,gBAAgB;AACtB,sFAAsF;AACtF,MAAM,oBAAoB;AAEnB,eAAe,IAAI,GAAY;IACpC,kCAAkC;IAClC,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC;IAEnC,gCAAgC;IAChC,MAAM,SAAS,cAAc,WAAW,UAAU,CAAC;IAEnD,IAAI,CAAC,QAAQ;QACX,iCAAiC;QACjC,OAAO,sKAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAmB,GAC5B;YACE,QAAQ;YACR,SAAS;gBACP,eAAe;gBACf,eAAe;gBACf,mBAAmB;gBACnB,iCAAiC;YACnC;QACF;IAEJ;IAEA,yCAAyC;IACzC,gCAAgC;IAChC,MAAM;IACN,MAAM;IAEN;;IAIA,MAAM,WAAW,IAAA,sNAAY,EAAC,aAAa;IAE3C,MAAM,EAAE,MAAM,cAAc,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3C,IAAI,CAAC,SACL,MAAM,CAAC;IAEV,IAAI,OAAO;QACT,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,sKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;IAEA,OAAO,sKAAY,CAAC,IAAI,CAAC;QAAE,SAAS;QAAM,MAAM;IAAe;AACjE"}}]
}