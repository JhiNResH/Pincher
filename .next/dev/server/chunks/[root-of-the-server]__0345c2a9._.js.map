{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/lib/server-wallet.ts"],"sourcesContent":["import { createWalletClient, createPublicClient, http } from \"viem\";\nimport { privateKeyToAccount } from \"viem/accounts\";\nimport { baseSepolia } from \"viem/chains\";\n\n// Reuse the Faucet Key for the Agent (or a dedicated AGENT_PRIVATE_KEY)\nconst PRIVATE_KEY = process.env.FAUCET_PRIVATE_KEY as `0x${string}`;\n\nif (!PRIVATE_KEY) {\n  console.warn(\"âš ï¸ AGENT WARNING: FAUCET_PRIVATE_KEY is missing. Agent wallet will fail.\");\n}\n\n// 1. Account Setup\nlet account = null;\ntry {\n  let key = process.env.FAUCET_PRIVATE_KEY;\n  console.log(\"Debug: FAUCET_PRIVATE_KEY length:\", key ? key.length : \"undefined\");\n\n  // Auto-fix: Prepend 0x if missing\n  if (key && !key.startsWith(\"0x\")) {\n    console.log(\"âš ï¸ Auto-fixing key: Prepending '0x'\");\n    key = `0x${key}`;\n  }\n\n  if (key && key.startsWith(\"0x\")) {\n    account = privateKeyToAccount(key as `0x${string}`);\n  } else {\n    console.warn(\"âŒ Key missing or invalid format (must start with 0x)\");\n  }\n} catch (e) {\n  console.error(\"âŒ Agent Wallet Error: Invalid Private Key format. Check .env.local\");\n}\nexport const agentAccount = account;\n\n// 2. Public Client (Read Blockchain)\nexport const publicClient = createPublicClient({\n  chain: baseSepolia,\n  transport: http(),\n});\n\n// 3. Wallet Client (Write/Sign Transactions)\nexport const agentWallet = agentAccount\n  ? createWalletClient({\n      account: agentAccount!,\n      chain: baseSepolia,\n      transport: http(),\n    })\n  : (null as any);\n\n// Helper: Check Agent Balance\n/**\n *\n */\nexport async function getAgentBalance() {\n  if (!agentAccount) return \"0\";\n  const balance = await publicClient.getBalance({ address: agentAccount.address });\n  // Return formatted string if needed, or keeping explicit bigint elsewhere\n  return balance;\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AACA;AACA;;;;AAEA,wEAAwE;AACxE,MAAM,cAAc,QAAQ,GAAG,CAAC,kBAAkB;AAElD,IAAI,CAAC,aAAa;IAChB,QAAQ,IAAI,CAAC;AACf;AAEA,mBAAmB;AACnB,IAAI,UAAU;AACd,IAAI;IACF,IAAI,MAAM,QAAQ,GAAG,CAAC,kBAAkB;IACxC,QAAQ,GAAG,CAAC,qCAAqC,MAAM,IAAI,MAAM,GAAG;IAEpE,kCAAkC;IAClC,IAAI,OAAO,CAAC,IAAI,UAAU,CAAC,OAAO;QAChC,QAAQ,GAAG,CAAC;QACZ,MAAM,CAAC,EAAE,EAAE,KAAK;IAClB;IAEA,IAAI,OAAO,IAAI,UAAU,CAAC,OAAO;QAC/B,UAAU,IAAA,8MAAmB,EAAC;IAChC,OAAO;QACL,QAAQ,IAAI,CAAC;IACf;AACF,EAAE,OAAO,GAAG;IACV,QAAQ,KAAK,CAAC;AAChB;AACO,MAAM,eAAe;AAGrB,MAAM,eAAe,IAAA,2MAAkB,EAAC;IAC7C,OAAO,2MAAW;IAClB,WAAW,IAAA,6LAAI;AACjB;AAGO,MAAM,cAAc,eACvB,IAAA,2MAAkB,EAAC;IACjB,SAAS;IACT,OAAO,2MAAW;IAClB,WAAW,IAAA,6LAAI;AACjB,KACC;AAME,eAAe;IACpB,IAAI,CAAC,cAAc,OAAO;IAC1B,MAAM,UAAU,MAAM,aAAa,UAAU,CAAC;QAAE,SAAS,aAAa,OAAO;IAAC;IAC9E,0EAA0E;IAC1E,OAAO;AACT"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/app/api/agent-pay/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { agentAccount, agentWallet } from \"@/lib/server-wallet\";\nimport { parseEther } from \"viem\";\n\nexport async function POST(req: Request) {\n  try {\n    const { userAddress } = await req.json();\n\n    if (!userAddress) {\n      return NextResponse.json({ error: \"Missing userAddress\" }, { status: 400 });\n    }\n\n    if (!agentWallet || !agentAccount) {\n        return NextResponse.json({ error: \"Server Wallet Not Configured\" }, { status: 500 });\n    }\n\n    // 1. Send 0.0001 ETH from Agent Wallet to User\n    // Simulates the \"Split Payment\" from the 3 other agents\n    console.log(`\\n==========================================`);\n    console.log(`ðŸ’° [AgentPay] INITIATING PAYMENT`);\n    console.log(`   -> To User: ${userAddress}`);\n    console.log(`   -> Amount: 0.0001 ETH (Split Share)`);\n    console.log(`==========================================\\n`);\n    \n    const hash = await agentWallet.sendTransaction({\n        to: userAddress,\n        value: parseEther(\"0.0001\"), \n    });\n\n    console.log(`\\nâœ… [AgentPay] SUCCESS!`);\n    console.log(`   -> Tx Hash: https://sepolia.basescan.org/tx/${hash}\\n`);\n\n    return NextResponse.json({ success: true, txHash: hash });\n\n  } catch (error: any) {\n    console.error(\"[AgentPay] Error:\", error);\n    return NextResponse.json({ error: error.message || \"Payment Failed\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,WAAW,EAAE,GAAG,MAAM,IAAI,IAAI;QAEtC,IAAI,CAAC,aAAa;YAChB,OAAO,sKAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,IAAI,CAAC,8JAAW,IAAI,CAAC,+JAAY,EAAE;YAC/B,OAAO,sKAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA+B,GAAG;gBAAE,QAAQ;YAAI;QACtF;QAEA,+CAA+C;QAC/C,wDAAwD;QACxD,QAAQ,GAAG,CAAC,CAAC,4CAA4C,CAAC;QAC1D,QAAQ,GAAG,CAAC,CAAC,gCAAgC,CAAC;QAC9C,QAAQ,GAAG,CAAC,CAAC,eAAe,EAAE,aAAa;QAC3C,QAAQ,GAAG,CAAC,CAAC,sCAAsC,CAAC;QACpD,QAAQ,GAAG,CAAC,CAAC,4CAA4C,CAAC;QAE1D,MAAM,OAAO,MAAM,8JAAW,CAAC,eAAe,CAAC;YAC3C,IAAI;YACJ,OAAO,IAAA,iMAAU,EAAC;QACtB;QAEA,QAAQ,GAAG,CAAC,CAAC,uBAAuB,CAAC;QACrC,QAAQ,GAAG,CAAC,CAAC,+CAA+C,EAAE,KAAK,EAAE,CAAC;QAEtE,OAAO,sKAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,QAAQ;QAAK;IAEzD,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,sKAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO,IAAI;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF"}}]
}