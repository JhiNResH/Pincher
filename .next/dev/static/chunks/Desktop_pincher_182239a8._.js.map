{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error(\"Missing Supabase environment variables\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n"],"names":[],"mappings":";;;;AAEoB;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,uNAAY,EAAC,aAAa"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/SearchBox.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { usePrivy } from '@privy-io/react-auth';\nimport { supabase } from '@/lib/supabase';\n\ninterface SearchBoxProps {\n  onPickupChange?: (location: string, coords?: { lat: number; lng: number }) => void;\n  onDropoffChange?: (location: string, coords?: { lat: number; lng: number }) => void;\n  className?: string;\n  externalPickupCoords?: { lat: number; lng: number };\n  externalDropoffCoords?: { lat: number; lng: number };\n}\n\nexport default function SearchBox({ \n  onPickupChange, \n  onDropoffChange, \n  className = \"\",\n  externalPickupCoords,\n  externalDropoffCoords\n}: SearchBoxProps) {\n  const { user, authenticated, login } = usePrivy();\n  const [pickup, setPickup] = useState('');\n  const [dropoff, setDropoff] = useState('');\n  const [pickupCoords, setPickupCoords] = useState<{ lat: number; lng: number } | null>(null);\n  const [dropoffCoords, setDropoffCoords] = useState<{ lat: number; lng: number } | null>(null);\n  \n  // ... (previous states)\n\n  // Sync with External Coordinates (e.g. Map Drag)\n  useEffect(() => {\n    if (externalPickupCoords && \n       (!pickupCoords || externalPickupCoords.lat !== pickupCoords.lat || externalPickupCoords.lng !== pickupCoords.lng)) {\n        \n        // Update local coords immediately\n        setPickupCoords(externalPickupCoords);\n        \n        // Reverse Geocode to get address text\n        if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            geocoder.geocode({ location: externalPickupCoords }).then((response) => {\n                if (response.results[0]) {\n                    setPickup(response.results[0].formatted_address);\n                }\n            }).catch((e) => console.error(\"Reverse geocode failed\", e));\n        }\n    }\n  }, [externalPickupCoords]);\n\n  useEffect(() => {\n    if (externalDropoffCoords && \n       (!dropoffCoords || externalDropoffCoords.lat !== dropoffCoords.lat || externalDropoffCoords.lng !== dropoffCoords.lng)) {\n        \n        setDropoffCoords(externalDropoffCoords);\n        \n        if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            geocoder.geocode({ location: externalDropoffCoords }).then((response) => {\n                if (response.results[0]) {\n                    setDropoff(response.results[0].formatted_address);\n                }\n            }).catch((e) => console.error(\"Reverse geocode failed\", e));\n        }\n    }\n  }, [externalDropoffCoords]);\n\n  // Rest of the existing Effects...\n  const [wechatId, setWechatId] = useState('');\n  const [departureTime, setDepartureTime] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [locating, setLocating] = useState(false);\n  const [showDetails, setShowDetails] = useState(false);\n  const [placesApiReady, setPlacesApiReady] = useState(false);\n\n  const pickupInputRef = useRef<HTMLInputElement>(null);\n  const dropoffInputRef = useRef<HTMLInputElement>(null);\n  const pickupAutocompleteRef = useRef<google.maps.places.Autocomplete | null>(null);\n  const dropoffAutocompleteRef = useRef<google.maps.places.Autocomplete | null>(null);\n\n  // Check if Places API is available\n  useEffect(() => {\n    const checkPlacesAPI = () => {\n      if (window.google && window.google.maps && window.google.maps.places) {\n        setPlacesApiReady(true);\n        return true;\n      }\n      return false;\n    };\n\n    if (checkPlacesAPI()) {\n      return;\n    }\n\n    const interval = setInterval(() => {\n      if (checkPlacesAPI()) {\n        clearInterval(interval);\n      }\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  // Initialize Google Places Autocomplete\n  useEffect(() => {\n    if (!placesApiReady || !window.google || !window.google.maps || !window.google.maps.places) {\n      return;\n    }\n\n    // Setup pickup autocomplete\n    if (pickupInputRef.current && !pickupAutocompleteRef.current) {\n      pickupAutocompleteRef.current = new google.maps.places.Autocomplete(\n        pickupInputRef.current,\n        {\n          componentRestrictions: { country: 'us' },\n          fields: ['formatted_address', 'geometry', 'name'],\n          types: ['establishment', 'geocode'],\n        }\n      );\n\n      pickupAutocompleteRef.current.addListener('place_changed', () => {\n        const place = pickupAutocompleteRef.current?.getPlace();\n        if (place && place.geometry && place.geometry.location) {\n          const address = place.formatted_address || place.name || '';\n          const coords = {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          };\n          setPickup(address);\n          setPickupCoords(coords);\n          if (onPickupChange) {\n            onPickupChange(address, coords);\n          }\n        }\n      });\n    }\n\n    // Setup dropoff autocomplete\n    if (dropoffInputRef.current && !dropoffAutocompleteRef.current) {\n      dropoffAutocompleteRef.current = new google.maps.places.Autocomplete(\n        dropoffInputRef.current,\n        {\n          componentRestrictions: { country: 'us' },\n          fields: ['formatted_address', 'geometry', 'name'],\n          types: ['establishment', 'geocode'],\n        }\n      );\n\n      dropoffAutocompleteRef.current.addListener('place_changed', () => {\n        const place = dropoffAutocompleteRef.current?.getPlace();\n        if (place && place.geometry && place.geometry.location) {\n          const address = place.formatted_address || place.name || '';\n          const coords = {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          };\n          setDropoff(address);\n          setDropoffCoords(coords);\n          if (onDropoffChange) {\n            onDropoffChange(address, coords);\n          }\n          // Auto show details when both locations are selected\n          if (pickup) {\n            setShowDetails(true);\n          }\n        }\n      });\n    }\n  }, [placesApiReady, onPickupChange, onDropoffChange, pickup]);\n\n  // Geolocation\n  const handleGetCurrentLocation = async () => {\n    if (!navigator.geolocation) {\n      alert('Âú∞ÁêÜÂÆö‰Ωç‰∏çÊîØÊåÅ / Geolocation not supported');\n      return;\n    }\n\n    if (!window.google || !window.google.maps) {\n      alert('Âú∞ÂúñÂä†Ëºâ‰∏≠ÔºåË´ãÁ®çÂæåÂÜçË©¶ / Map is loading, please try again');\n      return;\n    }\n\n    setLocating(true);\n    navigator.geolocation.getCurrentPosition(\n      async (position) => {\n        const { latitude, longitude } = position.coords;\n\n        try {\n          if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            const result = await geocoder.geocode({\n              location: { lat: latitude, lng: longitude },\n            });\n\n            if (result.results && result.results.length > 0) {\n              const address = result.results[0].formatted_address;\n              const coords = { lat: latitude, lng: longitude };\n              setPickup(address);\n              setPickupCoords(coords);\n              if (onPickupChange) {\n                onPickupChange(address, coords);\n              }\n            }\n          }\n        } catch (error) {\n          console.error('Geocoding error:', error);\n        } finally {\n          setLocating(false);\n        }\n      },\n      (error) => {\n        console.error('Geolocation error:', error);\n        alert('Êó†Ê≥ïËé∑Âèñ‰ΩçÁΩÆ / Unable to get location');\n        setLocating(false);\n      }\n    );\n  };\n\n  const handleSubmit = async () => {\n    if (!authenticated) {\n      login();\n      return;\n    }\n\n    if (!pickup || !dropoff || !wechatId) {\n      alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ / Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const { error } = await supabase\n        .from('rides')\n        .insert([\n          {\n            user_address: user?.wallet?.address || user?.email?.address || 'unknown',\n            pickup_location: pickup,\n            dropoff_location: dropoff,\n            departure_time: departureTime || new Date().toISOString(),\n            wechat_id: wechatId,\n            status: 'active',\n            pickup_lat: pickupCoords?.lat,\n            pickup_lng: pickupCoords?.lng,\n            dropoff_lat: dropoffCoords?.lat,\n            dropoff_lng: dropoffCoords?.lng,\n          },\n        ])\n        .select()\n        .single();\n\n      if (error) {\n        console.error('Supabase error:', error);\n        alert(`Failed to create ride: ${error.message}`);\n        throw error;\n      }\n\n      alert('Ë°åÁ®ãÂ∑≤ÂèëÂ∏ÉÔºÅAI Ê≠£Âú®ÂØªÊâæÊãºÂèã... / Ride published!');\n\n      // Reset\n      setPickup('');\n      setDropoff('');\n      setPickupCoords(null);\n      setDropoffCoords(null);\n      setWechatId('');\n      setDepartureTime('');\n      setShowDetails(false);\n    } catch (error: any) {\n      console.error('Error creating ride:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Manual geocode when Enter is pressed\n  const handleManualGeocode = async (address: string, isPickup: boolean) => {\n    if (!address || !window.google || !window.google.maps) return;\n\n    try {\n      const geocoder = new google.maps.Geocoder();\n      const result = await geocoder.geocode({ address });\n\n      if (result.results && result.results.length > 0) {\n        const location = result.results[0].geometry.location;\n        const formattedAddress = result.results[0].formatted_address;\n        const coords = { lat: location.lat(), lng: location.lng() };\n\n        if (isPickup) {\n          setPickup(formattedAddress);\n          setPickupCoords(coords);\n          if (onPickupChange) {\n            onPickupChange(formattedAddress, coords);\n          }\n        } else {\n          setDropoff(formattedAddress);\n          setDropoffCoords(coords);\n          if (onDropoffChange) {\n            onDropoffChange(formattedAddress, coords);\n          }\n          if (pickup) {\n            setShowDetails(true);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n    }\n  };\n\n  const handleSwap = () => {\n    const tempPickup = pickup;\n    const tempPickupCoords = pickupCoords;\n\n    setPickup(dropoff);\n    setPickupCoords(dropoffCoords);\n    if (onPickupChange) onPickupChange(dropoff, dropoffCoords || undefined);\n\n    setDropoff(tempPickup);\n    setDropoffCoords(tempPickupCoords);\n    if (onDropoffChange) onDropoffChange(tempPickup, tempPickupCoords || undefined);\n  };\n\n  return (\n    <>\n      {/* Google Maps Style Search Box */}\n      <div className={`absolute top-4 left-16 z-50 w-[92%] max-w-[400px] transition-transform duration-300 ease-in-out ${className}`}>\n        {/* Places API Status Warning */}\n        {!placesApiReady && (\n          <div className=\"mb-3 bg-yellow-50 border border-yellow-200 rounded-lg p-3 shadow-sm\">\n            <div className=\"flex items-center gap-2\">\n              <svg className=\"w-5 h-5 text-yellow-600 shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n              <p className=\"text-sm text-yellow-800\">\n                <strong>Ëá™ÂãïË£úÂÖ®Â∞öÊú™Â∞±Á∑í„ÄÇ</strong> Ë´ãËº∏ÂÖ•ÂÆåÊï¥Âú∞ÂùÄÂæåÊåâ EnterÔºåÊàñ‰ΩøÁî®ÂÆö‰ΩçÊåâÈàï üìç\n              </p>\n            </div>\n          </div>\n        )}\n\n        <div className=\"bg-black/60 backdrop-blur-xl rounded-2xl shadow-[0_0_20px_rgba(0,0,0,0.5)] border border-white/10 overflow-hidden\">\n          {/* Location Inputs Area */}\n          <div className=\"relative p-0\">\n            {/* Connector Visualization */}\n            <div className=\"absolute left-[26px] top-[26px] bottom-[26px] flex flex-col items-center pointer-events-none z-10 w-4\">\n              {/* Pickup Dot */}\n              <div className=\"w-3 h-3 rounded-full border-[2px] border-cyan-400 bg-black box-border shrink-0 shadow-[0_0_8px_cyan]\" />\n              {/* Vertical Line */}\n              <div className=\"flex-1 w-[2px] bg-gradient-to-b from-cyan-500/50 to-purple-500/50 my-1 rounded-full\" />\n              {/* Dropoff Square */}\n              <div className=\"w-3 h-3 bg-purple-500 rounded-[1px] shrink-0 shadow-[0_0_8px_purple]\" />\n            </div>\n\n            {/* Inputs Container */}\n            <div className=\"flex flex-col\">\n              {/* Pickup Input */}\n              <div className=\"relative flex items-center pr-12\">\n                 <input\n                  ref={pickupInputRef}\n                  className=\"w-full pl-14 pr-4 py-4 text-[15px] font-medium text-slate-100 placeholder-slate-500 bg-transparent focus:outline-none focus:bg-white/5 transition-colors\"\n                  placeholder={placesApiReady ? \"Ëµ∑Èªû\" : \"Ëº∏ÂÖ•Ëµ∑Èªû\"}\n                  value={pickup}\n                  onChange={(e) => {\n                    const val = e.target.value;\n                    setPickup(val);\n                    if (val === '' && onPickupChange) {\n                        setPickupCoords(null);\n                        onPickupChange('', undefined);\n                    }\n                  }}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' && !placesApiReady) {\n                      handleManualGeocode(pickup, true);\n                    }\n                  }}\n                />\n                <button\n                    onClick={handleGetCurrentLocation}\n                    disabled={locating}\n                    className=\"absolute right-3 p-2 text-slate-400 hover:text-cyan-400 hover:bg-white/5 rounded-full transition-all\"\n                    title=\"ÂÆö‰Ωç\"\n                  >\n                  {locating ? (\n                    <svg className=\"animate-spin h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\">\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                    </svg>\n                  ) : (\n                    <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <title>‰ΩøÁî®ÁèæÂú®‰ΩçÁΩÆ</title>\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\n                    </svg>\n                  )}\n                </button>\n              </div>\n\n              {/* Divider */}\n              <div className=\"ml-14 border-t border-white/10\" />\n\n              {/* Dropoff Input */}\n              <div className=\"relative flex items-center pr-12\">\n                 <input\n                  ref={dropoffInputRef}\n                  className=\"w-full pl-14 pr-4 py-4 text-[15px] font-medium text-slate-100 placeholder-slate-500 bg-transparent focus:outline-none focus:bg-white/5 transition-colors\"\n                  placeholder={placesApiReady ? \"ÁõÆÁöÑÂú∞\" : \"Ëº∏ÂÖ•ÁõÆÁöÑÂú∞\"}\n                  value={dropoff}\n                  onChange={(e) => {\n                    const val = e.target.value;\n                    setDropoff(val);\n                    if (val === '' && onDropoffChange) {\n                        setDropoffCoords(null);\n                        onDropoffChange('', undefined);\n                    }\n                  }}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' && !placesApiReady) {\n                      handleManualGeocode(dropoff, false);\n                    }\n                  }}\n                />\n                  {/* Swap Button (Floating right overlap) */}\n                  <div className=\"absolute right-3 -top-[23px] z-20\">\n                    <button\n                      onClick={handleSwap}\n                      className=\"p-1.5 text-slate-400 hover:text-cyan-400 transition-colors\"\n                      title=\"ÂàáÊèõËµ∑ÁµÇÈªû\"\n                    >\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4\" />\n                      </svg>\n                    </button>\n                  </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Details Section (collapsed by default) */}\n          {showDetails && (\n            <div className=\"border-t border-white/10 p-4 bg-black/40 backdrop-blur-xl animate-in slide-in-from-top-2 duration-200\">\n              <div className=\"space-y-4\">\n                {/* Departure Time */}\n                <div>\n                  <label className=\"block text-xs font-bold text-slate-400 uppercase tracking-wider mb-1.5 ml-1\">\n                    Âá∫ÁôºÊôÇÈñì\n                  </label>\n                  <input\n                    type=\"datetime-local\"\n                    className=\"w-full px-4 py-3 bg-white/5 border-0 rounded-xl text-slate-200 font-medium focus:ring-1 focus:ring-cyan-500/50 focus:bg-white/10 transition-all [color-scheme:dark]\"\n                    value={departureTime}\n                    onChange={(e) => setDepartureTime(e.target.value)}\n                  />\n                </div>\n\n                {/* WeChat ID */}\n                <div>\n                   <label className=\"block text-xs font-bold text-slate-400 uppercase tracking-wider mb-1.5 ml-1\">\n                    ÂæÆ‰ø°Ëôü <span className=\"text-red-400\">*</span>\n                  </label>\n                  <input\n                    className=\"w-full px-4 py-3 bg-white/5 border-0 rounded-xl text-slate-200 font-medium focus:ring-1 focus:ring-cyan-500/50 focus:bg-white/10 transition-all placeholder:text-slate-600\"\n                    placeholder=\"Ëº∏ÂÖ•‰Ω†ÁöÑÂæÆ‰ø°Ëôü\"\n                    value={wechatId}\n                    onChange={(e) => setWechatId(e.target.value)}\n                  />\n                </div>\n\n                {/* Submit Button */}\n                <button\n                  onClick={handleSubmit}\n                  disabled={loading || !wechatId}\n                  className=\"w-full py-3.5 bg-gradient-to-r from-cyan-600 to-blue-600 text-white rounded-xl font-bold text-[15px] hover:shadow-[0_0_20px_rgba(8,145,178,0.4)] disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                >\n                  {loading ? (\n                    <span className=\"flex items-center justify-center gap-2\">\n                       <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                      </svg>\n                      ÁôºÂ∏É‰∏≠...\n                    </span>\n                  ) : authenticated ? 'Á¢∫Ë™çÁôºÂ∏ÉË°åÁ®ã' : 'ÁôªÂÖ•‰∏¶ÁôºÂ∏É'}\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Toggle Details Button */}\n          {!showDetails && pickup && dropoff && (\n            <div className=\"border-t border-white/10 bg-black/40\">\n              <button\n                onClick={() => setShowDetails(true)}\n                className=\"w-full py-3 text-cyan-400 font-bold text-sm hover:bg-white/5 transition-colors flex items-center justify-center gap-1\"\n              >\n                ‰∏ã‰∏ÄÊ≠•\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M19 9l-7 7-7-7\" />\n                 </svg>\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 845, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/RideChat.tsx"],"sourcesContent":["import { useEffect, useState, useRef } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { usePrivy } from '@privy-io/react-auth';\n\ninterface Message {\n  id: string;\n  ride_id: number;\n  sender_address: string;\n  content: string;\n  created_at: string;\n}\n\ninterface RideChatProps {\n    rideId: number;\n    injectedMessages?: Message[];\n}\n\nexport default function RideChat({ rideId, injectedMessages = [] }: RideChatProps) {\n    const { user } = usePrivy();\n    const [messages, setMessages] = useState<Message[]>([]);\n    const [newMessage, setNewMessage] = useState('');\n    const [loading, setLoading] = useState(true);\n    const bottomRef = useRef<HTMLDivElement>(null);\n\n    const userAddress = user?.wallet?.address?.toLowerCase() || 'anon';\n\n    // Handle Injected Demo Messages\n    useEffect(() => {\n        if (injectedMessages && injectedMessages.length > 0) {\n            setMessages(prev => {\n                // Merge and dedupe\n                const existingIds = new Set(prev.map(m => m.id));\n                const newToAppend = injectedMessages.filter(m => !existingIds.has(m.id));\n                if (newToAppend.length === 0) return prev;\n                \n                const combined = [...prev, ...newToAppend].sort((a, b) => \n                    new Date(a.created_at).getTime() - new Date(b.created_at).getTime()\n                );\n                return combined;\n            });\n            scrollToBottom();\n        }\n    }, [injectedMessages]);\n\n    useEffect(() => {\n        fetchMessages();\n        const channel = supabase\n            .channel(`ride_chat:${rideId}`)\n            .on('postgres_changes', { \n                event: 'INSERT', \n                schema: 'public', \n                table: 'messages', \n                filter: `ride_id=eq.${rideId}` \n            }, (payload) => {\n                const newMsg = payload.new as Message; // Re-adding the dedupe logic that was also there\n                setMessages(prev => {\n                    if (prev.some(m => m.id === newMsg.id)) return prev;\n                    return [...prev, newMsg];\n                });\n                scrollToBottom();\n            })\n            .subscribe();\n\n        return () => {\n            supabase.removeChannel(channel);\n        };\n    }, [rideId]);\n\n    const fetchMessages = async () => {\n        const { data } = await supabase\n            .from('messages')\n            .select('*')\n            .eq('ride_id', rideId)\n            .order('created_at', { ascending: true });\n        \n        if (data) setMessages(data);\n        setLoading(false);\n        scrollToBottom();\n    };\n\n    const sendMessage = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!newMessage.trim()) return;\n\n        const content = newMessage.trim();\n        setNewMessage(''); // Optimistic clear\n\n        const { data, error } = await supabase\n            .from('messages')\n            .insert({\n                ride_id: rideId,\n                sender_address: userAddress,\n                content: content\n            })\n            .select() // Fetch the inserted row\n            .single();\n\n        if (error) {\n            console.error(\"Failed to send:\", error);\n            alert(\"Failed to send message\");\n        } else if (data) {\n            // Immediate local update\n            setMessages(prev => [...prev, data]);\n            scrollToBottom();\n        }\n    };\n\n    const scrollToBottom = () => {\n        setTimeout(() => bottomRef.current?.scrollIntoView({ behavior: 'smooth' }), 100);\n    };\n\n    if (loading) return <div className=\"text-xs text-gray-400 text-center py-2\">Loading chat...</div>;\n\n    return (\n        <div className=\"bg-gray-50 rounded-lg border border-gray-200 mt-3 overflow-hidden flex flex-col h-64\">\n             {/* Header */}\n            <div className=\"bg-gray-100 px-3 py-2 border-b border-gray-200 flex justify-between items-center\">\n                <span className=\"text-xs font-bold text-gray-700\">Squad Chat üí¨</span>\n                <span className=\"text-[10px] text-gray-400\">End-to-End Encrypted (Mock)</span>\n            </div>\n\n            {/* Messages Area */}\n            <div className=\"flex-1 overflow-y-auto p-3 space-y-2\">\n                {messages.length === 0 && (\n                    <div className=\"text-center text-gray-400 text-xs mt-10\">\n                        No messages yet. Say hi! üëã\n                    </div>\n                )}\n                {messages.map((msg) => {\n                    const isMe = msg.sender_address === userAddress;\n                    return (\n                        <div key={msg.id} className={`flex ${isMe ? 'justify-end' : 'justify-start'}`}>\n                            <div className={`max-w-[80%] rounded-lg px-3 py-1.5 text-xs ${\n                                isMe ? 'bg-blue-600 text-white' : 'bg-white border border-gray-200 text-gray-800'\n                            }`}>\n                                <p>{msg.content}</p>\n                            </div>\n                        </div>\n                    );\n                })}\n                <div ref={bottomRef} />\n            </div>\n\n            {/* Input Area */}\n            <form onSubmit={sendMessage} className=\"p-2 bg-white border-t border-gray-200 flex gap-2\">\n                <input\n                    type=\"text\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    placeholder=\"Type a message...\"\n                    className=\"flex-1 text-xs text-gray-900 bg-white placeholder-gray-500 border border-gray-300 rounded-md px-2 py-1.5 focus:outline-none focus:border-blue-500\"\n                />\n                <button \n                    type=\"submit\"\n                    disabled={!newMessage.trim()}\n                    className=\"bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-md hover:bg-blue-700 disabled:opacity-50\"\n                >\n                    Send\n                </button>\n            </form>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1102, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/RideList.tsx"],"sourcesContent":["import { useEffect, useState, useMemo } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { calculateMatchScore, Coordinates } from '@/lib/agent';\nimport { useWallets, usePrivy } from '@privy-io/react-auth';\nimport { createWalletClient, custom, parseUnits, encodeFunctionData } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\nconst BOOKING_PRICE_USDC = 0.01;\nconst BOOKING_PRICE_UNITS = parseUnits(BOOKING_PRICE_USDC.toString(), 6);\n\nconst ERC20_ABI = [\n  {\n    inputs: [\n      { name: 'to', type: 'address' },\n      { name: 'amount', type: 'uint256' },\n    ],\n    name: 'transfer',\n    outputs: [{ name: '', type: 'bool' }],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n] as const;\n\ninterface Ride {\n  id: number;\n  created_at: string;\n  user_address: string;\n  pickup_location: string;\n  dropoff_location: string;\n  departure_time: string;\n  wechat_id: string;\n  status: string;\n  // Real coordinates from DB\n  pickup_lat?: number;\n  pickup_lng?: number;\n  dropoff_lat?: number;\n  dropoff_lng?: number;\n  // Mock fields for UI demo\n  price?: number;\n  seats?: number;\n  match_score?: number;\n  ride_pickup_coords?: Coordinates;\n  ride_dropoff_coords?: Coordinates;\n  distance_from_user?: number;\n  isUnlocked?: boolean;\n}\n\ninterface RideListProps {\n  pickupCoords?: Coordinates;\n  dropoffCoords?: Coordinates;\n  onTopMatchUpdate?: (topMatch: Ride) => void;\n}\n\nimport Link from 'next/link';\nimport RideChat from './RideChat';\n\n// ... (existing code)\n\nconst SHORT_USDC_ADDRESS = `${USDC_ADDRESS.slice(0, 6)}...${USDC_ADDRESS.slice(-4)}`;\nconst V2_CONTRACT_ADDRESS = \"0x1225A84FC29FcdA297736ffe22977f8C594C21bc\"; // Deployed on Base Sepolia\n\nexport default function RideList({ pickupCoords, dropoffCoords, onTopMatchUpdate }: RideListProps) {\n  const [rides, setRides] = useState<Ride[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState<number | null>(null); // rideId\n  const [activeChatId, setActiveChatId] = useState<number | null>(null); // For chat toggle\n  const [successTicket, setSuccessTicket] = useState<{ id: number; tx: string } | null>(null);\n\n  const { wallets } = useWallets();\n  const { user } = usePrivy();\n\n  const onToggleChat = (rideId: number) => {\n      setActiveChatId(prev => prev === rideId ? null : rideId);\n  };\n\n  const [bookedRideIds, setBookedRideIds] = useState<number[]>([]);\n\n  useEffect(() => {\n      const stored = localStorage.getItem('pincher_booked_rides');\n      if (stored) {\n          try {\n              setBookedRideIds(JSON.parse(stored));\n          } catch (e) { console.error(\"Failed to parse booked rides\", e); }\n      }\n  }, []);\n\n  const addToBooked = (id: number) => {\n      const updated = [...bookedRideIds, id];\n      setBookedRideIds(updated);\n      localStorage.setItem('pincher_booked_rides', JSON.stringify(updated));\n  }\n\n  // AI Simulation Script (Removed legacy/undefined code)\n\n  useEffect(() => {\n    fetchRides();\n  }, []);\n\n  // ... (Fetch logic remains)\n  async function fetchRides() {\n    try {\n      // 1. Fetch Public Data (Supabase)\n      const { data, error } = await supabase\n        .from('rides')\n        .select('*')\n        .order('departure_time', { ascending: true });\n\n      if (error) {\n        throw error;\n      }\n      \n      // Enrich with mock data for AI Agent\n      const enrichedRides = (data || []).map((ride: any, index: number) => {\n        // Use Real DB Coords if available, otherwise Mock (for old data)\n        const hasRealCoords = ride.pickup_lat && ride.pickup_lng && ride.dropoff_lat && ride.dropoff_lng;\n        \n        let pLat, pLng, dLat, dLng;\n\n        if (hasRealCoords) {\n             pLat = ride.pickup_lat;\n             pLng = ride.pickup_lng;\n             dLat = ride.dropoff_lat;\n             dLng = ride.dropoff_lng;\n        } else {\n            // Fallback Mock for legacy data\n            const latOffset = (index % 5 - 2) * 0.005; \n            const lngOffset = (index % 3 - 1) * 0.005;\n            pLat = 33.6846 + latOffset;\n            pLng = -117.8265 + lngOffset;\n            dLat = 33.7 + latOffset;\n            dLng = -117.8 + lngOffset;\n        }\n\n        return {\n          ...ride,\n          price: 10 + (ride.id % 25), \n          seats: 1 + (ride.id % 3),\n          // Coords used for Agent Logic\n          ride_pickup_coords: { lat: pLat, lng: pLng },\n          ride_dropoff_coords: { lat: dLat, lng: dLng },\n          // Default placeholders\n          match_score: 0,\n          isUnlocked: ride.status === 'completed' || ride.status === 'escrow_holding'\n        }\n      });\n      \n      setRides(enrichedRides);\n    } catch (error: any) {\n      console.error('Error fetching rides:', error?.message || error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // -- Escrow / Agent Actions --\n\n  const handleBook = async (ride: Ride) => {\n    try {\n        setActionLoading(ride.id);\n\n        const wallet = wallets[0];\n        if (!wallet) {\n            alert(\"Connect wallet first!\");\n            return;\n        }\n\n        // 1. Get Agent Address\n        const configRes = await fetch('/api/escrow/config');\n        const { address: agentAddress } = await configRes.json();\n        if (!agentAddress) throw new Error(\"Agent address missing\");\n\n        // 2. Send USDC to Agent\n        console.log(`Sending ${BOOKING_PRICE_USDC} USDC to Agent ${agentAddress}...`);\n        await wallet.switchChain(baseSepolia.id);\n        const provider = await wallet.getEthereumProvider();\n        const client = createWalletClient({\n            account: wallet.address as `0x${string}`,\n            chain: baseSepolia,\n            transport: custom(provider),\n        });\n\n        const data = encodeFunctionData({\n            abi: ERC20_ABI,\n            functionName: 'transfer',\n            args: [agentAddress as `0x${string}`, BOOKING_PRICE_UNITS],\n        });\n\n        const hash = await client.sendTransaction({\n            to: USDC_ADDRESS,\n            data,\n        });\n        console.log(\"Tx Sent:\", hash);\n\n        // 3. Notify Agent (Deposit)\n        const depositRes = await fetch('/api/escrow/deposit', {\n            method: 'POST',\n            body: JSON.stringify({ \n                rideId: ride.id, \n                txHash: hash,\n                userAddress: wallet.address \n            })\n        });\n        const depositData = await depositRes.json();\n        \n        if (!depositRes.ok) throw new Error(depositData.error);\n\n        // 4. Update UI & Local Storage\n        setRides(prev => prev.map(r => r.id === ride.id ? { ...r, status: 'escrow_holding', isUnlocked: true } : r));\n        addToBooked(ride.id);\n        \n        // Show Success Modal\n        setSuccessTicket({ id: ride.id, tx: hash });\n\n    } catch (e: any) {\n        console.error(\"Booking failed:\", e);\n        alert(`Booking Failed: ${e.message}`);\n    } finally {\n        setActionLoading(null);\n    }\n  };\n\n  // ... (GPS Helper remains)\n  \n  // ... (handleRelease remains)\n\n  // ... (openInUber remains)\n\n  // ... (handleCopyWeChat remains)\n\n\n  if (loading) return (\n      <div className=\"flex justify-center p-8\">\n          <div className=\"w-6 h-6 border-2 border-slate-200 border-t-black rounded-full animate-spin\"></div>\n      </div>\n  );\n\n  const displayedRides = sortedRides.filter(r => {\n      const isExpired = new Date(r.departure_time).getTime() < Date.now();\n      \n      // 1. Hide Completed/Cancelled\n      if (r.status === 'completed' || r.status === 'cancelled') return false;\n\n      // 2. Handle 'escrow_holding' (In Progress)\n      // Only show to Organizer OR Passenger (Booker)\n      if (r.status === 'escrow_holding') {\n          const isOrganizer = user?.wallet?.address && r.user_address && \n                              user.wallet.address.toLowerCase() === r.user_address.toLowerCase();\n          const isPassenger = bookedRideIds.includes(r.id);\n          \n          return isOrganizer || isPassenger;\n      }\n\n      // 3. Handle 'active' (Open)\n      // Show if valid time\n      if (r.status === 'active') {\n          return !isExpired;\n      }\n\n      return true;\n  });\n\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col px-1\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-bold text-gray-900\">Available Rides</h2>\n            <span className=\"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded-full\">{displayedRides.length}</span>\n          </div>\n          <p className=\"text-[10px] text-gray-400 font-mono mt-1\">\n            V2 Contract: <a href={`https://sepolia.basescan.org/address/${V2_CONTRACT_ADDRESS}`} target=\"_blank\" className=\"underline hover:text-blue-600\">{V2_CONTRACT_ADDRESS.slice(0,6)}...{V2_CONTRACT_ADDRESS.slice(-4)}</a>\n          </p>\n      </div>\n      \n      {displayedRides.length === 0 ? (\n        <div className=\"text-center py-10 bg-gray-50 rounded-xl border border-dashed border-gray-200\">\n            <p className=\"text-sm text-gray-500\">No rides available.</p>\n            <p className=\"text-xs text-gray-400 mt-1\">Be the first to create one!</p>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {displayedRides.map((ride) => {\n            const date = new Date(ride.departure_time);\n            const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n            const isBooking = actionLoading === ride.id;\n            \n            return (\n                <div\n                key={ride.id}\n                className={`group p-4 bg-white border rounded-xl shadow-sm transition-all relative overflow-hidden ${\n                    ride.status === 'escrow_holding' ? 'border-yellow-200 bg-yellow-50/10' : \n                    ride.status === 'completed' ? 'border-green-200 bg-green-50/10' : 'border-gray-100 hover:shadow-md'\n                }`}\n                >\n                <div className={`absolute left-0 top-0 bottom-0 w-1 transition-colors ${\n                    ride.status === 'escrow_holding' ? 'bg-yellow-400' : \n                    ride.status === 'completed' ? 'bg-green-500' : 'bg-black group-hover:bg-blue-600'\n                }`}></div>\n                \n                <div className=\"flex flex-col gap-3 pl-2\">\n                    {/* Header: Match Score & Status */}\n                    <div className=\"flex justify-between items-start\">\n                        <div className=\"flex items-center gap-2\">\n                             <div className={`px-2 py-1 rounded-md text-[10px] font-bold flex items-center gap-1 ${\n                                 (ride.match_score || 0) > 85 ? 'bg-green-100 text-green-700' :\n                                 (ride.match_score || 0) > 60 ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-600'\n                             }`}>\n                                <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" /></svg>\n                                {ride.match_score}% Match\n                            </div>\n                        </div>\n                        <span className={`px-2 py-1 rounded-full font-medium capitalize text-[10px] border ${\n                            ride.status === 'escrow_holding' ? 'bg-yellow-100 text-yellow-800 border-yellow-200' :\n                            ride.status === 'completed' ? 'bg-green-100 text-green-800 border-green-200' : \n                            'bg-blue-50 text-blue-700 border-blue-100'\n                        }`}>\n                            {ride.status === 'escrow_holding' ? 'Agent Holding Funds' : ride.status}\n                        </span>\n                    </div>\n\n                    {/* Route */}\n                    <div className=\"flex flex-col gap-2 relative py-1\">\n                        <div className=\"absolute left-[5px] top-[10px] bottom-[10px] w-px bg-gray-200\"></div>\n                        <div className=\"flex items-start gap-3\">\n                            <div className=\"w-2.5 h-2.5 rounded-full border-2 border-gray-900 bg-white shrink-0 z-10 mt-1\"></div>\n                            <p className=\"text-sm font-semibold text-gray-900 leading-tight\">\n                                {ride.pickup_location.split(',')[0]}\n                            </p>\n                        </div>\n                        <div className=\"flex items-start gap-3\">\n                            <div className=\"w-2.5 h-2.5 rounded-sm bg-gray-900 shrink-0 z-10 mt-1\"></div>\n                            <p className=\"text-sm font-semibold text-gray-900 leading-tight\">\n                                {ride.dropoff_location.split(',')[0]}\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Info Row */}\n                    <div className=\"grid grid-cols-3 gap-2 mt-2 pt-3 border-t border-gray-50\">\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-wider\">Depart</span>\n                            <span className=\"text-xs font-semibold text-gray-900\">{timeStr}</span>\n                        </div>\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-wider\">Price</span>\n                            <span className=\"text-xs font-semibold text-blue-600 font-mono\">0.01 USDC</span>\n                        </div>\n                         <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] text-gray-400 uppercase font-bold tracking-wider\">Status</span>\n                            <span className=\"text-xs font-semibold text-gray-900\">{ride.status === 'active' ? 'Open' : 'Booked'}</span>\n                        </div>\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"mt-3 pt-2 border-t border-dashed border-gray-100\">\n                        {ride.status === 'active' && (\n                            <button\n                                onClick={() => handleBook(ride)}\n                                disabled={isBooking}\n                                className=\"w-full py-2 bg-black text-white rounded-lg text-xs font-bold hover:bg-gray-800 disabled:bg-gray-400 transition-colors flex items-center justify-center gap-2\"\n                            >\n                                {isBooking ? 'Minting Seat Token...' : 'Join Carpool (0.01 USDC)'}\n                            </button>\n                        )}\n                        \n                        {ride.status === 'escrow_holding' && (\n                            <div className=\"flex flex-col gap-2\">\n                                <p className=\"text-[10px] text-center text-gray-500 bg-gray-50 p-1.5 rounded\">\n                                    Agent is holding funds. Ride in progress.\n                                </p>\n                                <div className=\"flex gap-2\">\n                                    {/* Check if current user is the organizer */}\n                                    {user?.wallet?.address && ride.user_address && \n                                     user.wallet.address.toLowerCase() === ride.user_address.toLowerCase() ? (\n                                        <button\n                                            onClick={() => openInUber(ride)}\n                                            className=\"flex-1 py-2 bg-black text-white rounded-lg text-xs font-bold hover:bg-gray-800 transition-colors flex items-center justify-center gap-1\"\n                                        >\n                                            üöó Open Uber (Organizer)\n                                        </button>\n                                    ) : (\n                                        <button\n                                            disabled\n                                            className=\"flex-1 py-2 bg-gray-100 text-gray-400 rounded-lg text-[10px] font-bold cursor-not-allowed flex items-center justify-center gap-1\"\n                                        >\n                                            ‚úã Waiting for Organizer\n                                        </button>\n                                    )}\n\n                                    <button\n                                        onClick={() => handleRelease(ride)}\n                                        disabled={isBooking}\n                                        className=\"flex-1 py-2 bg-green-600 text-white rounded-lg text-xs font-bold hover:bg-green-700 disabled:bg-green-400 transition-colors\"\n                                    >\n                                        {isBooking ? 'Verifying...' : '‚úÖ I Arrived'}\n                                    </button>\n                                </div>\n                                <div className=\"text-center text-[10px] text-gray-400\">\n                                    GPS Check: Must be within 0.5 miles\n                                </div>\n                            </div>\n                        )}\n                        \n                         {ride.status === 'completed' && (\n                            <div className=\"text-center text-xs font-medium text-green-600 bg-green-50 py-2 rounded-lg\">\n                                Ride Completed & Paid\n                            </div>\n                        )}\n                    </div>\n\n                     {/* Footer: WeChat & Chat Toggle */}\n                    {(ride.status === 'escrow_holding' || ride.status === 'completed') && (\n                        <div className=\"flex items-center justify-between mt-2 pt-2 border-t border-gray-50\">\n                             {/* WeChat ID */}\n                             <div className=\"flex items-center gap-2\">\n                                <div className=\"w-4 h-4 rounded-full bg-green-100 flex items-center justify-center\">\n                                     <svg className=\"w-2.5 h-2.5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 8h8v2H8V8zm0 4h8v2H8v-2z\" /></svg>\n                                </div>\n                                 <p className=\"text-[11px] text-gray-600 truncate flex items-center gap-2\">\n                                    Organizer: <span className=\"font-bold select-all\">{ride.wechat_id}</span>\n                                    <button \n                                        onClick={(e) => {\n                                            e.stopPropagation();\n                                            handleCopyWeChat(ride.wechat_id);\n                                        }}\n                                        className=\"text-gray-400 hover:text-blue-600 transition-colors\"\n                                        title=\"Copy ID\"\n                                    >\n                                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 012 2v-8a2 2 0 01-2-2h-8a2 2 0 01-2 2v8a2 2 0 012 2z\" /></svg>\n                                    </button>\n                                </p>\n                            </div>\n\n                            {/* Chat Toggle Button */}\n                            <div className=\"flex justify-end w-full\">\n                                <button\n                                    onClick={(e) => {\n                                        e.stopPropagation();\n                                        onToggleChat(ride.id);\n                                    }}\n                                    className=\"text-xs font-bold text-blue-600 bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100 transition-colors flex items-center gap-1\"\n                                >\n                                    üí¨ Chat\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                    \n                    {/* Render Chat if Open */}\n                    {activeChatId === ride.id && (\n                        <RideChat \n                            rideId={ride.id} \n                        />\n                    )}\n                </div>\n                </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Success Modal */}\n      {successTicket && (\n        <div className=\"fixed inset-0 z-100 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200\">\n            <div className=\"bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 text-center border-b-4 border-blue-500 relative overflow-hidden\">\n                <div className=\"absolute top-0 left-0 w-full h-1 bg-linear-to-r from-blue-400 to-purple-500\"></div>\n                \n                <div className=\"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce\">\n                    <span className=\"text-3xl\">üéüÔ∏è</span>\n                </div>\n                \n                <h3 className=\"text-xl font-bold text-gray-900 mb-1\">Ride Booked!</h3>\n                <p className=\"text-xs text-blue-600 font-bold uppercase tracking-wider mb-4\">NFT Ticket Minted</p>\n                \n                <div className=\"bg-gray-50 rounded-lg p-3 mb-6 border border-gray-100 text-left\">\n                    <p className=\"text-xs text-gray-500 mb-1\">Your Token ID</p>\n                    <p className=\"text-lg font-mono font-bold text-gray-800\">#{successTicket.id}</p>\n                    <div className=\"w-full h-px bg-gray-200 my-2\"></div>\n                    <p className=\"text-[10px] text-gray-400 break-all\">\n                        Tx: {successTicket.tx}\n                    </p>\n                </div>\n                \n                <div className=\"flex flex-col gap-2\">\n                    <a \n                        href={`https://sepolia.basescan.org/tx/${successTicket.tx}`}\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                        className=\"w-full py-2.5 bg-gray-900 text-white rounded-lg text-sm font-bold hover:bg-gray-800 transition-colors flex items-center justify-center gap-2\"\n                    >\n                        <span>üîç</span> View on Blockchain\n                    </a>\n                    <button \n                        onClick={() => setSuccessTicket(null)}\n                        className=\"w-full py-2.5 text-gray-500 font-medium text-sm hover:text-gray-800 transition-colors\"\n                    >\n                        Close\n                    </button>\n                </div>\n            </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2042, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/MapSidebar.tsx"],"sourcesContent":["'use client';\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport RideList from './RideList';\n\ninterface MapSidebarProps {\n  isOpen: boolean;\n  onToggle: () => void;\n  pickupCoords?: { lat: number; lng: number };\n  dropoffCoords?: { lat: number; lng: number };\n  onTopMatchUpdate?: (topMatch: any) => void;\n}\n\nexport default function MapSidebar({ isOpen, onToggle, pickupCoords, dropoffCoords, onTopMatchUpdate }: MapSidebarProps) {\n  const { authenticated } = usePrivy();\n\n  if (!authenticated) return null;\n\n  return (\n    <>\n      {/* Hamburger Toggle Button - Now controlled by parent or rendered here but triggering prop */}\n      <button\n        onClick={onToggle}\n        className={`absolute top-4 left-4 z-60 p-2.5 bg-white rounded-full shadow-md text-gray-700 hover:bg-gray-50 transition-all duration-300 pointer-events-auto ${isOpen ? 'translate-x-[320px]' : 'translate-x-0'}`}\n        aria-label=\"Toggle Sidebar\"\n      >\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          {isOpen ? (\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          ) : (\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\n          )}\n        </svg>\n      </button>\n\n      {/* Sidebar Overlay (closes when clicking background) */}\n      {isOpen && (\n        <div \n          className=\"fixed inset-0 bg-black/20 z-55 backdrop-blur-[1px] transition-opacity\"\n          onClick={onToggle}\n        />\n      )}\n\n      {/* Sidebar Panel */}\n      <div \n        className={`fixed top-0 left-0 bottom-0 w-[320px] bg-white shadow-2xl z-58 flex flex-col transition-transform duration-300 ease-in-out ${\n          isOpen ? 'translate-x-0' : '-translate-x-full'\n        }`}\n      >\n        {/* Header Branding */}\n        <div className=\"p-5 border-b border-gray-100 bg-white shrink-0 pt-8\">\n            <h2 className=\"text-2xl font-extrabold text-gray-900 tracking-tight\">Pincher</h2>\n            <p className=\"text-xs text-gray-500 font-medium\">Smart Ride Sharing</p>\n        </div>\n\n        {/* Ride List Content */}\n        <div className=\"flex-1 overflow-y-auto bg-gray-50/50\">\n          <div className=\"p-4\">\n            <RideList pickupCoords={pickupCoords} dropoffCoords={dropoffCoords} onTopMatchUpdate={onTopMatchUpdate} />\n          </div>\n        </div>\n        \n        {/* Footer */}\n        <div className=\"p-3 border-t border-gray-100 text-center text-xs text-gray-400 bg-white\">\n          Pincher ¬© 2025\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAae,SAAS,WAAW,EAAE,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,aAAa,EAAE,gBAAgB,EAAmB;;IACrH,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,6PAAQ;IAElC,IAAI,CAAC,eAAe,OAAO;IAE3B,qBACE;;0BAEE,mNAAC;gBACC,SAAS;gBACT,WAAW,CAAC,gJAAgJ,EAAE,SAAS,wBAAwB,iBAAiB;gBAChN,cAAW;0BAEX,cAAA,mNAAC;oBAAI,WAAU;oBAAU,MAAK;oBAAO,QAAO;oBAAe,SAAQ;8BAChE,uBACC,mNAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,aAAa;wBAAG,GAAE;;;;;6CAErE,mNAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,aAAa;wBAAG,GAAE;;;;;;;;;;;;;;;;YAM1E,wBACC,mNAAC;gBACC,WAAU;gBACV,SAAS;;;;;;0BAKb,mNAAC;gBACC,WAAW,CAAC,2HAA2H,EACrI,SAAS,kBAAkB,qBAC3B;;kCAGF,mNAAC;wBAAI,WAAU;;0CACX,mNAAC;gCAAG,WAAU;0CAAuD;;;;;;0CACrE,mNAAC;gCAAE,WAAU;0CAAoC;;;;;;;;;;;;kCAIrD,mNAAC;wBAAI,WAAU;kCACb,cAAA,mNAAC;4BAAI,WAAU;sCACb,cAAA,mNAAC,2JAAQ;gCAAC,cAAc;gCAAc,eAAe;gCAAe,kBAAkB;;;;;;;;;;;;;;;;kCAK1F,mNAAC;wBAAI,WAAU;kCAA0E;;;;;;;;;;;;;;AAMjG;GAxDwB;;QACI,6PAAQ;;;KADZ"}},
    {"offset": {"line": 2189, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/UserProfile.tsx"],"sourcesContent":["'use client';\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport { useState, useEffect } from 'react';\nimport { createPublicClient, http, formatUnits, erc20Abi } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\n\nexport default function UserProfile() {\n  const { user, logout, authenticated } = usePrivy();\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [funding, setFunding] = useState(false);\n  const [balance, setBalance] = useState<string>('0.00');\n  const [ethBalance, setEthBalance] = useState<string>('0.00');\n\n  useEffect(() => {\n    if (authenticated && user?.wallet?.address) {\n        fetchBalance();\n    }\n  }, [authenticated, user?.wallet?.address, showDropdown]);\n\n  const fetchBalance = async () => {\n    try {\n        const client = createPublicClient({\n            chain: baseSepolia,\n            transport: http(),\n        });\n\n        // Fetch USDC Balance\n        console.log(\"Fetching balance for:\", user!.wallet!.address);\n        \n        // @ts-expect-error - viem type inference issue\n        const usdcData = await client.readContract({\n            address: USDC_ADDRESS,\n            abi: erc20Abi,\n            functionName: 'balanceOf',\n            args: [user!.wallet!.address as `0x${string}`],\n        });\n        console.log(\"Raw USDC Data:\", usdcData);\n        \n        const usdcFormatted = formatUnits(usdcData as bigint, 6);\n        console.log(\"Formatted USDC:\", usdcFormatted);\n        \n        setBalance(parseFloat(usdcFormatted).toFixed(2));\n\n        // Fetch ETH Balance\n        const ethData = await client.getBalance({ \n            address: user!.wallet!.address as `0x${string}` \n        });\n        const ethFormatted = formatUnits(ethData, 18);\n        setEthBalance(parseFloat(ethFormatted).toFixed(4));\n\n    } catch (e) {\n        console.error(\"Balance fetch error\", e);\n    }\n  };\n\n  if (!authenticated) return null;\n\n  const displayName = user?.email?.address || \n    (user?.wallet?.address ? `${user.wallet.address.slice(0, 6)}...${user.wallet.address.slice(-4)}` : 'User');\n\n  const handleFundWallet = async () => {\n    if (!user?.wallet?.address) return;\n    setFunding(true);\n    try {\n      const res = await fetch('/api/faucet', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ address: user.wallet.address }),\n      });\n      const data = await res.json();\n      if (data.success) {\n        alert('Funding successful! Check your wallet on Base Sepolia.');\n        fetchBalance(); // Refresh\n      } else {\n        alert('Funding failed: ' + (data.error || 'Unknown error'));\n      }\n    } catch (e) {\n      alert('Funding error');\n    } finally {\n      setFunding(false);\n    }\n  };\n\n  return (\n    <div className=\"absolute top-4 right-4 z-50 font-sans\">\n      <div className=\"relative\">\n        <button\n          onClick={() => setShowDropdown(!showDropdown)}\n          className=\"flex items-center gap-3 bg-black/60 backdrop-blur-md px-4 py-2.5 rounded-full shadow-lg hover:shadow-[0_0_15px_rgba(255,255,255,0.1)] transition-all border border-white/10 hover:border-white/20\"\n        >\n          <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-cyan-500 to-purple-600 flex items-center justify-center text-white font-bold text-xs shadow-inner\">\n            {displayName[0].toUpperCase()}\n          </div>\n          <span className=\"text-sm font-medium text-slate-200 hidden sm:block\">\n            {displayName}\n          </span>\n          <svg className={`w-4 h-4 text-slate-400 transition-transform ${showDropdown ? 'rotate-180' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n\n        {showDropdown && (\n          <div className=\"absolute right-0 mt-2 w-72 bg-black/80 backdrop-blur-xl rounded-xl shadow-2xl border border-white/10 overflow-hidden py-1 animate-in fade-in slide-in-from-top-2 duration-200\">\n            <div className=\"px-4 py-3 border-b border-white/10 bg-white/5\">\n              <p className=\"text-[10px] text-cyan-400 uppercase tracking-widest font-bold mb-2\">Connected Wallet</p>\n              <div className=\"flex flex-col gap-1\">\n                <div className=\"flex items-center gap-2 bg-black/40 p-2 rounded border border-white/10\">\n                    <p className=\"text-[10px] font-mono text-slate-400 break-all leading-tight select-all\">\n                        {user?.wallet?.address}\n                    </p>\n                    <button \n                        onClick={() => {\n                            if (user?.wallet?.address) {\n                                navigator.clipboard.writeText(user.wallet.address);\n                                alert('Address copied!');\n                            }\n                        }}\n                        className=\"text-slate-500 hover:text-cyan-400 shrink-0 transition-colors\"\n                        title=\"Copy Address\"\n                    >\n                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" /></svg>\n                    </button>\n                    {user?.wallet?.address && (\n                        <a \n                            href={`https://sepolia.basescan.org/address/${user.wallet.address}`}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"text-blue-500 hover:text-blue-400 shrink-0 transition-colors\"\n                            title=\"View on Explorer\"\n                        >\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" /></svg>\n                        </a>\n                    )}\n                </div>\n              </div>\n              \n              <div className=\"mt-3 flex flex-col gap-2\">\n                  <div className=\"flex items-center justify-between bg-black/40 border border-white/10 rounded-lg px-3 py-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm\">üí∞</span>\n                        <span className=\"text-xs font-bold text-slate-200\">{balance} USDC</span>\n                      </div>\n                  </div>\n                  <div className=\"flex items-center justify-between bg-black/40 border border-white/10 rounded-lg px-3 py-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm\">‚õΩÔ∏è</span>\n                        <span className=\"text-xs font-bold text-slate-200\">{ethBalance} ETH</span>\n                      </div>\n                       <button onClick={fetchBalance} className=\"text-slate-500 hover:text-cyan-400 transition-colors\" title=\"Refresh\">\n                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" /></svg>\n                      </button>\n                  </div>\n                  \n                  {/* My Receipts */}\n                  <a \n                    href={`https://sepolia.basescan.org/address/${user?.wallet?.address}#tokentxnsErc1155`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"w-full flex items-center justify-center gap-2 bg-blue-600/80 hover:bg-blue-600 text-white py-2 rounded-lg text-xs font-bold transition-all shadow-lg shadow-blue-900/20 mt-1\"\n                  >\n                    <span>üìú</span>\n                    Transaction History\n                  </a>\n              </div>\n            </div>\n            \n            {/* Faucet Links */}\n            <div className=\"p-3 border-b border-white/10 bg-white/5\">\n                <p className=\"text-[9px] font-bold text-slate-500 px-1 uppercase tracking-wider mb-2\">Testnet Tools</p>\n                <div className=\"grid grid-cols-2 gap-2\">\n                    <a\n                        href=\"https://portal.cdp.coinbase.com/products/faucet\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"px-2 py-1.5 text-[10px] text-slate-300 bg-white/5 hover:bg-white/10 rounded border border-white/5 transition-colors flex items-center justify-between\"\n                    >\n                        <span>Base ETH</span>\n                        <span className=\"text-slate-500\">‚Üó</span>\n                    </a>\n                     <a\n                        href=\"https://faucet.circle.com/\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"px-2 py-1.5 text-[10px] text-slate-300 bg-white/5 hover:bg-white/10 rounded border border-white/5 transition-colors flex items-center justify-between\"\n                    >\n                        <span>USDC</span>\n                        <span className=\"text-slate-500\">‚Üó</span>\n                    </a>\n                </div>\n            </div>\n\n            <button\n              onClick={logout}\n              className=\"w-full text-left px-4 py-3 text-xs font-bold text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-colors flex items-center gap-2\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                 <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n              </svg>\n              Sign Out Securely\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2720, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/Directions.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useMap, useMapsLibrary } from '@vis.gl/react-google-maps';\n\ninterface DirectionsProps {\n  pickup?: { lat: number; lng: number };\n  dropoff?: { lat: number; lng: number };\n}\n\nexport default function Directions({ pickup, dropoff }: DirectionsProps) {\n  const map = useMap();\n  const routesLibrary = useMapsLibrary('routes');\n  const [directionsService, setDirectionsService] = useState<google.maps.DirectionsService>();\n  const [directionsRenderer, setDirectionsRenderer] = useState<google.maps.DirectionsRenderer>();\n\n  // 1. Initialize Services\n  useEffect(() => {\n    if (!routesLibrary || !map) return;\n\n    const ds = new routesLibrary.DirectionsService();\n    // Suppress default markers so we can use our custom sexy markers\n    const dr = new routesLibrary.DirectionsRenderer({\n        map,\n        suppressMarkers: true, \n        polylineOptions: {\n            strokeColor: '#2563EB', // Tech Blue (matches app theme)\n            strokeWeight: 6,\n            strokeOpacity: 1.0,\n        }\n    });\n\n    setDirectionsService(ds);\n    setDirectionsRenderer(dr);\n\n    return () => {\n        dr.setMap(null); // Cleanup\n    };\n  }, [routesLibrary, map]);\n\n  // 2. Fetch Route\n  useEffect(() => {\n    if (!directionsService || !directionsRenderer) return;\n\n    // Check inputs\n    if (!pickup || !dropoff) {\n        // Clear route if points removed\n        directionsRenderer.setDirections({ routes: [] } as any); \n        return;\n    }\n\n    console.log(\"üìç Directions: Fetching route...\", { pickup, dropoff });\n\n    directionsService.route({\n        origin: pickup,\n        destination: dropoff,\n        travelMode: google.maps.TravelMode.DRIVING,\n    }).then(response => {\n        console.log(\"‚úÖ Directions: Found route!\", response);\n        directionsRenderer.setDirections(response);\n    }).catch(e => {\n        console.error(\"‚ùå Directions request failed\", e);\n    });\n\n  }, [directionsService, directionsRenderer, pickup, dropoff]);\n\n  return null; // Logic only, renders directly on map instance\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAOe,SAAS,WAAW,EAAE,MAAM,EAAE,OAAO,EAAmB;;IACrE,MAAM,MAAM,IAAA,qNAAM;IAClB,MAAM,gBAAgB,IAAA,6NAAc,EAAC;IACrC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,+LAAQ;IAC1D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,+LAAQ;IAE5D,yBAAyB;IACzB,IAAA,gMAAS;gCAAC;YACR,IAAI,CAAC,iBAAiB,CAAC,KAAK;YAE5B,MAAM,KAAK,IAAI,cAAc,iBAAiB;YAC9C,iEAAiE;YACjE,MAAM,KAAK,IAAI,cAAc,kBAAkB,CAAC;gBAC5C;gBACA,iBAAiB;gBACjB,iBAAiB;oBACb,aAAa;oBACb,cAAc;oBACd,eAAe;gBACnB;YACJ;YAEA,qBAAqB;YACrB,sBAAsB;YAEtB;wCAAO;oBACH,GAAG,MAAM,CAAC,OAAO,UAAU;gBAC/B;;QACF;+BAAG;QAAC;QAAe;KAAI;IAEvB,iBAAiB;IACjB,IAAA,gMAAS;gCAAC;YACR,IAAI,CAAC,qBAAqB,CAAC,oBAAoB;YAE/C,eAAe;YACf,IAAI,CAAC,UAAU,CAAC,SAAS;gBACrB,gCAAgC;gBAChC,mBAAmB,aAAa,CAAC;oBAAE,QAAQ,EAAE;gBAAC;gBAC9C;YACJ;YAEA,QAAQ,GAAG,CAAC,oCAAoC;gBAAE;gBAAQ;YAAQ;YAElE,kBAAkB,KAAK,CAAC;gBACpB,QAAQ;gBACR,aAAa;gBACb,YAAY,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO;YAC9C,GAAG,IAAI;wCAAC,CAAA;oBACJ,QAAQ,GAAG,CAAC,8BAA8B;oBAC1C,mBAAmB,aAAa,CAAC;gBACrC;uCAAG,KAAK;wCAAC,CAAA;oBACL,QAAQ,KAAK,CAAC,+BAA+B;gBACjD;;QAEF;+BAAG;QAAC;QAAmB;QAAoB;QAAQ;KAAQ;IAE3D,OAAO,MAAM,+CAA+C;AAC9D;GAzDwB;;QACV,qNAAM;QACI,6NAAc;;;KAFd"}},
    {"offset": {"line": 2817, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/app/uber/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { APIProvider, Map, ControlPosition, AdvancedMarker, Pin } from \"@vis.gl/react-google-maps\";\nimport SearchBox from \"@/components/SearchBox\";\nimport MapSidebar from \"@/components/MapSidebar\";\nimport UserProfile from \"@/components/UserProfile\";\nimport Directions from \"@/components/Directions\";\n\nexport default function UberPage() {\n  const apiKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || \"\";\n  const [pickupCoords, setPickupCoords] = useState<{ lat: number; lng: number } | undefined>();\n  const [dropoffCoords, setDropoffCoords] = useState<{ lat: number; lng: number } | undefined>();\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false);\n  const [topMatch, setTopMatch] = useState<any>(null); // State for Notification\n  \n  // Auto-open sidebar if high match found? Or just show notification.\n  // We'll show notification.\n\n  // Default center: Orange County\n  const center = pickupCoords || dropoffCoords || { lat: 33.6846, lng: -117.8265 };\n\n  const handlePickupChange = (_location: string, coords?: { lat: number; lng: number }) => {\n    if (coords) {\n      setPickupCoords(coords);\n    }\n  };\n\n  const handleDropoffChange = (_location: string, coords?: { lat: number; lng: number }) => {\n    if (coords) {\n      setDropoffCoords(coords);\n    }\n  };\n\n  return (\n    <>\n      {/* Global Style for Google Places Autocomplete */}\n      <style jsx global>{`\n        .pac-container {\n          z-index: 9999 !important;\n          border-radius: 8px;\n          box-shadow:\n            0 4px 6px -1px rgb(0 0 0 / 0.1),\n            0 2px 4px -2px rgb(0 0 0 / 0.1);\n          border: none;\n          margin-top: 4px;\n        }\n        .pac-item {\n          padding: 12px 16px;\n          cursor: pointer;\n          border: none;\n          font-size: 14px;\n        }\n        .pac-item:hover {\n          background-color: #f3f4f6;\n        }\n        .pac-icon {\n          display: none;\n        }\n        .pac-item-query {\n          font-size: 14px;\n          font-weight: 500;\n          color: #111827;\n        }\n      `}</style>\n\n      <div className=\"h-screen w-screen flex relative overflow-hidden\">\n        {/* Sidebar */}\n        {/* Sidebar */}\n        <MapSidebar \n          isOpen={isSidebarOpen} \n          onToggle={() => setIsSidebarOpen(!isSidebarOpen)} \n          pickupCoords={pickupCoords}\n          dropoffCoords={dropoffCoords}\n          onTopMatchUpdate={setTopMatch}\n        />\n        \n        {/* Top Right User Profile */}\n        <UserProfile />\n\n        {/* Map Container */}\n        <div className=\"flex-1 relative h-full\">\n          {apiKey ? (\n            <APIProvider apiKey={apiKey} libraries={[\"places\", \"marker\"]}>\n              <Map\n                key={`${center.lat}-${center.lng}`}\n                defaultCenter={center}\n                defaultZoom={pickupCoords || dropoffCoords ? 13 : 11}\n                gestureHandling=\"greedy\"\n                disableDefaultUI={true}\n                mapId=\"DEMO_MAP_ID\"\n                mapTypeControlOptions={{ position: ControlPosition.BOTTOM_LEFT }}\n                className=\"w-full h-full\"\n              >\n                {pickupCoords && (\n                  <AdvancedMarker \n                    position={pickupCoords}\n                    draggable={true}\n                    onDragEnd={(e: any) => {\n                        if (e.latLng) {\n                            const newLat = e.latLng.lat();\n                            const newLng = e.latLng.lng();\n                            setPickupCoords({ lat: newLat, lng: newLng });\n                        }\n                    }}\n                  >\n                    <Pin background={'#000000'} glyphColor={'#ffffff'} borderColor={'#000000'} />\n                  </AdvancedMarker>\n                )}\n                {dropoffCoords && (\n                   <AdvancedMarker \n                    position={dropoffCoords}\n                    draggable={true}\n                    onDragEnd={(e: any) => {\n                        if (e.latLng) {\n                            const newLat = e.latLng.lat();\n                            const newLng = e.latLng.lng();\n                            setDropoffCoords({ lat: newLat, lng: newLng });\n                        }\n                    }}\n                   >\n                    <Pin background={'#ffffff'} glyphColor={'#000000'} borderColor={'#000000'} />\n                  </AdvancedMarker>\n                )}\n                \n                {/* Route Line */}\n                <Directions pickup={pickupCoords} dropoff={dropoffCoords} />\n              </Map>\n              {/* Search Box with sliding effect */}\n              <SearchBox \n                onPickupChange={handlePickupChange} \n                onDropoffChange={handleDropoffChange} \n                className={isSidebarOpen ? 'translate-x-[320px]' : ''}\n                externalPickupCoords={pickupCoords}\n                externalDropoffCoords={dropoffCoords}\n              />\n              \n              {/* Match Notification Pill */}\n              {topMatch && topMatch.match_score > 60 && !isSidebarOpen && (\n                  <div \n                    className=\"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-xl p-2 pr-4 flex items-center gap-3 cursor-pointer hover:scale-105 transition-transform animate-in slide-in-from-bottom-4 duration-500 z-50 border border-gray-100\"\n                    onClick={() => setIsSidebarOpen(true)}\n                  >\n                      <div className=\"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center shrink-0\">\n                          <span className=\"text-sm font-bold text-green-700\">{topMatch.match_score}%</span>\n                      </div>\n                      <div className=\"flex flex-col\">\n                          <span className=\"text-xs font-bold text-gray-900 border-b border-gray-100 pb-0.5\">High Match Found!</span>\n                          <span className=\"text-[10px] text-gray-500\">{topMatch.seats} seats ‚Ä¢ ${topMatch.price}</span>\n                      </div>\n                      <div className=\"w-8 h-8 rounded-full bg-black flex items-center justify-center text-white\">\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" /></svg>\n                      </div>\n                  </div>\n              )}\n            </APIProvider>\n          ) : (\n            <div className=\"flex items-center justify-center h-full bg-gray-200\">\n              <div className=\"text-center p-8 bg-white rounded-lg shadow-lg\">\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                  ÈúÄË¶Å Google Maps API Key\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Ë´ãÂú® .env Êñá‰ª∂‰∏≠Ê∑ªÂä†ÔºöNEXT_PUBLIC_GOOGLE_MAPS_API_KEY\n                </p>\n              </div>\n              {/* Fallback SearchBox display if no API Key (functionality will be limited) */}\n               <SearchBox \n                 onPickupChange={handlePickupChange} \n                 onDropoffChange={handleDropoffChange}\n                 className={isSidebarOpen ? 'translate-x-[320px]' : ''}\n                 externalPickupCoords={pickupCoords}\n                 externalDropoffCoords={dropoffCoords}\n               />\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}