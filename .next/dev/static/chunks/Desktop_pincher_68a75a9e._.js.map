{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error(\"Missing Supabase environment variables\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n"],"names":[],"mappings":";;;;AAEoB;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,uNAAY,EAAC,aAAa"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/SearchBox.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { usePrivy } from '@privy-io/react-auth';\nimport { supabase } from '@/lib/supabase';\n\ninterface SearchBoxProps {\n  onPickupChange?: (location: string, coords?: { lat: number; lng: number }) => void;\n  onDropoffChange?: (location: string, coords?: { lat: number; lng: number }) => void;\n  className?: string;\n  externalPickupCoords?: { lat: number; lng: number };\n  externalDropoffCoords?: { lat: number; lng: number };\n  onRideCreated?: () => void;\n}\n\nexport default function SearchBox({ \n  onPickupChange, \n  onDropoffChange, \n  className = \"\",\n  externalPickupCoords,\n  externalDropoffCoords,\n  onRideCreated\n}: SearchBoxProps) {\n  const { user, authenticated, login } = usePrivy();\n  const [pickup, setPickup] = useState('');\n  const [dropoff, setDropoff] = useState('');\n  const [pickupCoords, setPickupCoords] = useState<{ lat: number; lng: number } | null>(null);\n  const [dropoffCoords, setDropoffCoords] = useState<{ lat: number; lng: number } | null>(null);\n  \n  // ... (previous states)\n\n  // Sync with External Coordinates (e.g. Map Drag)\n  useEffect(() => {\n    if (externalPickupCoords && \n       (!pickupCoords || externalPickupCoords.lat !== pickupCoords.lat || externalPickupCoords.lng !== pickupCoords.lng)) {\n        \n        // Update local coords immediately\n        setPickupCoords(externalPickupCoords);\n        \n        // Reverse Geocode to get address text\n        if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            geocoder.geocode({ location: externalPickupCoords }).then((response) => {\n                if (response.results[0]) {\n                    setPickup(response.results[0].formatted_address);\n                }\n            }).catch((e) => console.error(\"Reverse geocode failed\", e));\n        }\n    }\n  }, [externalPickupCoords]);\n\n  useEffect(() => {\n    if (externalDropoffCoords && \n       (!dropoffCoords || externalDropoffCoords.lat !== dropoffCoords.lat || externalDropoffCoords.lng !== dropoffCoords.lng)) {\n        \n        setDropoffCoords(externalDropoffCoords);\n        \n        if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            geocoder.geocode({ location: externalDropoffCoords }).then((response) => {\n                if (response.results[0]) {\n                    setDropoff(response.results[0].formatted_address);\n                }\n            }).catch((e) => console.error(\"Reverse geocode failed\", e));\n        }\n    }\n  }, [externalDropoffCoords]);\n\n  // Rest of the existing Effects...\n  const [wechatId, setWechatId] = useState('');\n  const [departureTime, setDepartureTime] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [locating, setLocating] = useState(false);\n  const [showDetails, setShowDetails] = useState(false);\n  const [placesApiReady, setPlacesApiReady] = useState(false);\n\n  const pickupInputRef = useRef<HTMLInputElement>(null);\n  const dropoffInputRef = useRef<HTMLInputElement>(null);\n  const pickupAutocompleteRef = useRef<google.maps.places.Autocomplete | null>(null);\n  const dropoffAutocompleteRef = useRef<google.maps.places.Autocomplete | null>(null);\n\n  // Check if Places API is available\n  useEffect(() => {\n    const checkPlacesAPI = () => {\n      if (window.google && window.google.maps && window.google.maps.places) {\n        setPlacesApiReady(true);\n        return true;\n      }\n      return false;\n    };\n\n    if (checkPlacesAPI()) {\n      return;\n    }\n\n    const interval = setInterval(() => {\n      if (checkPlacesAPI()) {\n        clearInterval(interval);\n      }\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  // Initialize Google Places Autocomplete\n  useEffect(() => {\n    if (!placesApiReady || !window.google || !window.google.maps || !window.google.maps.places) {\n      return;\n    }\n\n    // Setup pickup autocomplete\n    if (pickupInputRef.current && !pickupAutocompleteRef.current) {\n      pickupAutocompleteRef.current = new google.maps.places.Autocomplete(\n        pickupInputRef.current,\n        {\n          componentRestrictions: { country: 'us' },\n          fields: ['formatted_address', 'geometry', 'name'],\n          types: ['establishment', 'geocode'],\n        }\n      );\n\n      pickupAutocompleteRef.current.addListener('place_changed', () => {\n        const place = pickupAutocompleteRef.current?.getPlace();\n        if (place && place.geometry && place.geometry.location) {\n          const address = place.formatted_address || place.name || '';\n          const coords = {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          };\n          setPickup(address);\n          setPickupCoords(coords);\n          if (onPickupChange) {\n            onPickupChange(address, coords);\n          }\n        }\n      });\n    }\n\n    // Setup dropoff autocomplete\n    if (dropoffInputRef.current && !dropoffAutocompleteRef.current) {\n      dropoffAutocompleteRef.current = new google.maps.places.Autocomplete(\n        dropoffInputRef.current,\n        {\n          componentRestrictions: { country: 'us' },\n          fields: ['formatted_address', 'geometry', 'name'],\n          types: ['establishment', 'geocode'],\n        }\n      );\n\n      dropoffAutocompleteRef.current.addListener('place_changed', () => {\n        const place = dropoffAutocompleteRef.current?.getPlace();\n        if (place && place.geometry && place.geometry.location) {\n          const address = place.formatted_address || place.name || '';\n          const coords = {\n            lat: place.geometry.location.lat(),\n            lng: place.geometry.location.lng(),\n          };\n          setDropoff(address);\n          setDropoffCoords(coords);\n          if (onDropoffChange) {\n            onDropoffChange(address, coords);\n          }\n          // Auto show details when both locations are selected\n          if (pickup) {\n            setShowDetails(true);\n          }\n        }\n      });\n    }\n  }, [placesApiReady, onPickupChange, onDropoffChange, pickup]);\n\n  // Geolocation\n  const handleGetCurrentLocation = async () => {\n    if (!navigator.geolocation) {\n      alert('åœ°ç†å®šä½ä¸æ”¯æŒ / Geolocation not supported');\n      return;\n    }\n\n    if (!window.google || !window.google.maps) {\n      alert('åœ°åœ–åŠ è¼‰ä¸­ï¼Œè«‹ç¨å¾Œå†è©¦ / Map is loading, please try again');\n      return;\n    }\n\n    setLocating(true);\n    navigator.geolocation.getCurrentPosition(\n      async (position) => {\n        const { latitude, longitude } = position.coords;\n\n        try {\n          if (window.google && window.google.maps) {\n            const geocoder = new google.maps.Geocoder();\n            const result = await geocoder.geocode({\n              location: { lat: latitude, lng: longitude },\n            });\n\n            if (result.results && result.results.length > 0) {\n              const address = result.results[0].formatted_address;\n              const coords = { lat: latitude, lng: longitude };\n              setPickup(address);\n              setPickupCoords(coords);\n              if (onPickupChange) {\n                onPickupChange(address, coords);\n              }\n            }\n          }\n        } catch (error) {\n          console.error('Geocoding error:', error);\n        } finally {\n          setLocating(false);\n        }\n      },\n      (error) => {\n        console.error('Geolocation error:', error);\n        alert('æ— æ³•èŽ·å–ä½ç½® / Unable to get location');\n        setLocating(false);\n      }\n    );\n  };\n\n  const handleSubmit = async () => {\n    if (!authenticated) {\n      login();\n      return;\n    }\n\n    if (!pickup || !dropoff || !wechatId) {\n      alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ / Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const { error } = await supabase\n        .from('rides')\n        .insert([\n          {\n            user_address: user?.wallet?.address || user?.email?.address || 'unknown',\n            pickup_location: pickup,\n            dropoff_location: dropoff,\n            departure_time: departureTime || new Date().toISOString(),\n            wechat_id: wechatId,\n            status: 'active',\n            pickup_lat: pickupCoords?.lat,\n            pickup_lng: pickupCoords?.lng,\n            dropoff_lat: dropoffCoords?.lat,\n            dropoff_lng: dropoffCoords?.lng,\n          },\n        ])\n        .select()\n        .single();\n\n      if (error) {\n        console.error('Supabase error:', error);\n        alert(`Failed to create ride: ${error.message}`);\n        throw error;\n      }\n\n      alert('è¡Œç¨‹å·²å‘å¸ƒï¼AI æ­£åœ¨å¯»æ‰¾æ‹¼å‹... / Ride published!');\n\n      // Reset\n      setDropoffCoords(null);\n      setWechatId('');\n      setDepartureTime('');\n      setShowDetails(false);\n\n      // Trigger Parent Refresh\n      if (onRideCreated) onRideCreated();\n\n    } catch (error: any) {\n      console.error('Error creating ride:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Manual geocode when Enter is pressed\n  const handleManualGeocode = async (address: string, isPickup: boolean) => {\n    if (!address || !window.google || !window.google.maps) return;\n\n    try {\n      const geocoder = new google.maps.Geocoder();\n      const result = await geocoder.geocode({ address });\n\n      if (result.results && result.results.length > 0) {\n        const location = result.results[0].geometry.location;\n        const formattedAddress = result.results[0].formatted_address;\n        const coords = { lat: location.lat(), lng: location.lng() };\n\n        if (isPickup) {\n          setPickup(formattedAddress);\n          setPickupCoords(coords);\n          if (onPickupChange) {\n            onPickupChange(formattedAddress, coords);\n          }\n        } else {\n          setDropoff(formattedAddress);\n          setDropoffCoords(coords);\n          if (onDropoffChange) {\n            onDropoffChange(formattedAddress, coords);\n          }\n          if (pickup) {\n            setShowDetails(true);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Geocoding error:', error);\n    }\n  };\n\n  const handleSwap = () => {\n    const tempPickup = pickup;\n    const tempPickupCoords = pickupCoords;\n\n    setPickup(dropoff);\n    setPickupCoords(dropoffCoords);\n    if (onPickupChange) onPickupChange(dropoff, dropoffCoords || undefined);\n\n    setDropoff(tempPickup);\n    setDropoffCoords(tempPickupCoords);\n    if (onDropoffChange) onDropoffChange(tempPickup, tempPickupCoords || undefined);\n  };\n\n  return (\n    <>\n      {/* Google Maps Style Search Box -> Uniswap Style Swap Card */}\n      <div className={`absolute top-20 left-4 z-50 w-[94%] max-w-[400px] transition-transform duration-300 ease-in-out font-sans ${className}`}>\n        {/* Places API Status Warning */}\n        {!placesApiReady && (\n          <div className=\"mb-3 bg-yellow-400/10 border border-yellow-400/20 rounded-2xl p-3 shadow-sm backdrop-blur-md\">\n            <div className=\"flex items-center gap-2\">\n              <svg className=\"w-5 h-5 text-yellow-500 shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n              <p className=\"text-xs font-bold text-yellow-500\">\n                Maps API Loading... type manually.\n              </p>\n            </div>\n          </div>\n        )}\n\n        {/* Main Card */}\n        <div className=\"bg-white rounded-xl p-0 shadow-xl border border-gray-100 relative overflow-hidden\">\n          \n          <div className=\"flex gap-0 relative\">\n             {/* Left Column: Connector Authorization */}\n             <div className=\"flex flex-col items-center pt-5 w-12 shrink-0 absolute top-0 bottom-0 left-0 z-10 pointer-events-none\">\n                  <div className=\"w-2 h-2 rounded-full bg-black shrink-0\"></div>\n                  <div className=\"w-px bg-gray-300 h-10 my-2\"></div>\n                  <div className=\"w-2 h-2 bg-black shrink-0\"></div>\n             </div>\n\n             {/* Right Column: Inputs */}\n             <div className=\"flex-1 flex flex-col gap-0\">\n                 {/* Pickup Input Row */}\n                 <div className=\"relative group\">\n                     <div className=\"flex items-center bg-gray-50 m-2 rounded-lg pl-8\">\n                         <input\n                          ref={pickupInputRef}\n                          className=\"w-full bg-transparent px-4 py-2.5 text-sm font-medium text-gray-900 placeholder-gray-500 focus:outline-none truncate\"\n                          placeholder=\"Your location\"\n                          value={pickup}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            setPickup(val);\n                            if (val === '') {\n                                setPickupCoords(null);\n                                onPickupChange?.('', undefined);\n                            }\n                          }}\n                          onKeyDown={(e) => e.key === 'Enter' && !placesApiReady && handleManualGeocode(pickup, true)}\n                        />\n                         {/* Locate Button */}\n                         <button\n                            onClick={handleGetCurrentLocation}\n                            disabled={locating}\n                            className=\"p-2 mr-2 text-slate-500 hover:text-cyan-400 transition-colors\"\n                            title=\"Current Location\"\n                            >\n                             {locating ? (\n                                <svg className=\"animate-spin h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\"><circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle><path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path></svg>\n                             ) : (\n                                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" /><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" /></svg>\n                             )}\n                         </button>\n                     </div>\n                 </div>\n\n                 {/* Divider */}\n                 {/* <div className=\"h-px w-full bg-gray-100 mx-4\" /> */}\n\n                 {/* Dropoff Input Row */}\n                 <div className=\"relative group\">\n                     <div className=\"flex items-center bg-gray-50 m-2 mt-0 rounded-lg pl-8\">\n                         <input\n                          ref={dropoffInputRef}\n                          className=\"w-full bg-transparent px-4 py-2.5 text-sm font-medium text-gray-900 placeholder-gray-500 focus:outline-none truncate\"\n                          placeholder=\"Choose destination\"\n                          value={dropoff}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            setDropoff(val);\n                            if (val === '') {\n                                setDropoffCoords(null);\n                                onDropoffChange?.('', undefined);\n                            }\n                          }}\n                          onKeyDown={(e) => e.key === 'Enter' && !placesApiReady && handleManualGeocode(dropoff, false)}\n                        />\n                     </div>\n                 </div>\n             </div>\n             \n             {/* Far Right: Swap Action */}\n             <div className=\"flex flex-col justify-center\">\n                 <button\n                      onClick={handleSwap}\n                      className=\"p-2 rounded-full hover:bg-white/10 text-slate-500 hover:text-white transition-colors\"\n                      title=\"Swap locations\"\n                    >\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4\" />\n                      </svg>\n                    </button>\n             </div>\n          </div>\n\n          {/* Expanded Details Form */}\n          {showDetails && (\n             <div className=\"px-4 mt-4 animate-in slide-in-from-top-2 duration-200\">\n               {/* Divider */}\n                <div className=\"h-px w-full bg-gray-100 mb-4\"></div>\n                \n                <div className=\"space-y-3\">\n                    {/* Row 1: Date & Time */}\n                    <div className=\"flex gap-3\">\n                         <div className=\"flex-1\">\n                             <label className=\"block text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-1\">\n                                 When\n                             </label>\n                            <input\n                                type=\"datetime-local\"\n                                min={new Date().toISOString().slice(0, 16)}\n                                className=\"w-full bg-gray-50 rounded-lg px-3 py-2 text-sm font-bold text-gray-900 border border-gray-100 focus:border-black focus:outline-none focus:ring-0\"\n                                value={departureTime}\n                                onChange={(e) => setDepartureTime(e.target.value)}\n                            />\n                         </div>\n                    </div>\n\n                     {/* Row 2: WeChat */}\n                    <div className=\"flex gap-3\">\n                         <div className=\"flex-1\">\n                            <label className=\"block text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-1\">\n                                WeChat ID <span className=\"text-gray-300\">(For contact)</span>\n                            </label>\n                            <div className=\"flex items-center bg-gray-50 rounded-lg px-3 py-2 border border-gray-100 focus-within:border-black focus-within:ring-0 transition-colors\">\n                                <span className=\"text-gray-400 mr-2 text-xs\">ID</span>\n                                <input\n                                    className=\"w-full bg-transparent text-sm font-bold text-gray-900 placeholder-gray-400 focus:outline-none\"\n                                    placeholder=\"your_wechat_id\"\n                                    value={wechatId}\n                                    onChange={(e) => setWechatId(e.target.value)}\n                                />\n                            </div>\n                         </div>\n                    </div>\n                </div>\n             </div>\n          )}\n\n          {/* Action Button */}\n          <div className=\"px-4 mt-2 mb-2\">\n             {(!showDetails && pickup && dropoff) ? (\n                 <button\n                    onClick={() => setShowDetails(true)}\n                    className=\"w-[90%] mx-auto block py-3 rounded-lg bg-black text-white font-bold text-sm tracking-wide hover:bg-gray-800 transition-all active:scale-[0.98] shadow-md\"\n                  >\n                    Continue\n                  </button>\n             ) : (\n                <button\n                onClick={handleSubmit}\n                disabled={loading || (showDetails && !wechatId)}\n                className={`w-[90%] mx-auto block py-3 rounded-lg font-bold text-sm tracking-wide transition-all active:scale-[0.98] shadow-sm ${\n                    loading || (showDetails && !wechatId) ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-black text-white hover:bg-gray-900'\n                }`}\n                >\n                {loading ? 'Processing...' : authenticated ? 'Request Ride' : 'Connect Wallet'}\n                </button>\n             )}\n          </div>\n\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 804, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/lib/agent.ts"],"sourcesContent":["export interface Coordinates {\n  lat: number;\n  lng: number;\n}\n\n// Haversine formula to calculate distance in miles\n/**\n *\n * @param coord1\n * @param coord2\n */\nfunction calculateDistance(coord1: Coordinates, coord2: Coordinates): number {\n  const R = 3958.8; // Radius of Earth in miles\n  const dLat = (coord2.lat - coord1.lat) * (Math.PI / 180);\n  const dLon = (coord2.lng - coord1.lng) * (Math.PI / 180);\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(coord1.lat * (Math.PI / 180)) *\n      Math.cos(coord2.lat * (Math.PI / 180)) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\n/**\n *\n * @param userPickup\n * @param userDropoff\n * @param ridePickup\n * @param rideDropoff\n */\nexport function calculateMatchScore(\n  userPickup: Coordinates | undefined,\n  userDropoff: Coordinates | undefined,\n  ridePickup: Coordinates,\n  rideDropoff: Coordinates,\n): { score: number; distance: number } {\n  if (!userPickup) return { score: 0, distance: 0 };\n\n  // 1. Calculate Distances\n  const pickupDist = calculateDistance(userPickup, ridePickup);\n  // If user hasn't entered dropoff, we only score based on pickup\n  const dropoffDist = userDropoff ? calculateDistance(userDropoff, rideDropoff) : 0;\n\n  // 2. Scoring Logic\n  // Perfect score = 100\n  // Penalty: -10 points per mile for pickup\n  // Penalty: -5 points per mile for dropoff\n  // Penalty: -3 points per mile for pickup\n  // Penalty: -1 point per mile for dropoff (Ultra relaxed for demo)\n  let score = 100 - pickupDist * 3;\n\n  if (userDropoff) {\n    score -= dropoffDist * 1;\n  }\n\n  // Cap score between 0 and 99 (nobody is perfect 100 unless exact calc)\n  score = Math.max(10, Math.min(99, Math.round(score)));\n\n  return {\n    score,\n    distance: parseFloat(pickupDist.toFixed(1)),\n  };\n}\n"],"names":[],"mappings":";;;;AAKA,mDAAmD;AACnD;;;;CAIC,GACD,SAAS,kBAAkB,MAAmB,EAAE,MAAmB;IACjE,MAAM,IAAI,QAAQ,2BAA2B;IAC7C,MAAM,OAAO,CAAC,OAAO,GAAG,GAAG,OAAO,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,GAAG;IACvD,MAAM,OAAO,CAAC,OAAO,GAAG,GAAG,OAAO,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,GAAG;IACvD,MAAM,IACJ,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO,KACrC,KAAK,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,KAAK,EAAE,GAAG,GAAG,KAClC,KAAK,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,KAAK,EAAE,GAAG,GAAG,KACpC,KAAK,GAAG,CAAC,OAAO,KAChB,KAAK,GAAG,CAAC,OAAO;IACpB,MAAM,IAAI,IAAI,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;IACrD,OAAO,IAAI;AACb;AASO,SAAS,oBACd,UAAmC,EACnC,WAAoC,EACpC,UAAuB,EACvB,WAAwB;IAExB,IAAI,CAAC,YAAY,OAAO;QAAE,OAAO;QAAG,UAAU;IAAE;IAEhD,yBAAyB;IACzB,MAAM,aAAa,kBAAkB,YAAY;IACjD,gEAAgE;IAChE,MAAM,cAAc,cAAc,kBAAkB,aAAa,eAAe;IAEhF,mBAAmB;IACnB,sBAAsB;IACtB,0CAA0C;IAC1C,0CAA0C;IAC1C,yCAAyC;IACzC,kEAAkE;IAClE,IAAI,QAAQ,MAAM,aAAa;IAE/B,IAAI,aAAa;QACf,SAAS,cAAc;IACzB;IAEA,uEAAuE;IACvE,QAAQ,KAAK,GAAG,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC;IAE7C,OAAO;QACL;QACA,UAAU,WAAW,WAAW,OAAO,CAAC;IAC1C;AACF"}},
    {"offset": {"line": 854, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/RideChat.tsx"],"sourcesContent":["import { useEffect, useState, useRef } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { usePrivy } from '@privy-io/react-auth';\n\ninterface Message {\n  id: string;\n  ride_id: number;\n  sender_address: string;\n  content: string;\n  created_at: string;\n}\n\ninterface RideChatProps {\n    rideId: number;\n    injectedMessages?: Message[];\n}\n\nexport default function RideChat({ rideId, injectedMessages = [] }: RideChatProps) {\n    const { user } = usePrivy();\n    const [messages, setMessages] = useState<Message[]>([]);\n    const [newMessage, setNewMessage] = useState('');\n    const [loading, setLoading] = useState(true);\n    const bottomRef = useRef<HTMLDivElement>(null);\n\n    const userAddress = user?.wallet?.address?.toLowerCase() || 'anon';\n\n    // Handle Injected Demo Messages\n    useEffect(() => {\n        if (injectedMessages && injectedMessages.length > 0) {\n            setMessages(prev => {\n                // Merge and dedupe\n                const existingIds = new Set(prev.map(m => m.id));\n                const newToAppend = injectedMessages.filter(m => !existingIds.has(m.id));\n                if (newToAppend.length === 0) return prev;\n                \n                const combined = [...prev, ...newToAppend].sort((a, b) => \n                    new Date(a.created_at).getTime() - new Date(b.created_at).getTime()\n                );\n                return combined;\n            });\n            scrollToBottom();\n        }\n    }, [injectedMessages]);\n\n    useEffect(() => {\n        fetchMessages();\n        const channel = supabase\n            .channel(`ride_chat:${rideId}`)\n            .on('postgres_changes', { \n                event: 'INSERT', \n                schema: 'public', \n                table: 'messages', \n                filter: `ride_id=eq.${rideId}` \n            }, (payload) => {\n                const newMsg = payload.new as Message; // Re-adding the dedupe logic that was also there\n                setMessages(prev => {\n                    if (prev.some(m => m.id === newMsg.id)) return prev;\n                    return [...prev, newMsg];\n                });\n                scrollToBottom();\n            })\n            .subscribe();\n\n        return () => {\n            supabase.removeChannel(channel);\n        };\n    }, [rideId]);\n\n    const fetchMessages = async () => {\n        const { data } = await supabase\n            .from('messages')\n            .select('*')\n            .eq('ride_id', rideId)\n            .order('created_at', { ascending: true });\n        \n        if (data) setMessages(data);\n        setLoading(false);\n        scrollToBottom();\n    };\n\n    const sendMessage = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!newMessage.trim()) return;\n\n        const content = newMessage.trim();\n        setNewMessage(''); // Optimistic clear\n\n        const { data, error } = await supabase\n            .from('messages')\n            .insert({\n                ride_id: rideId,\n                sender_address: userAddress,\n                content: content\n            })\n            .select() // Fetch the inserted row\n            .single();\n\n        if (error) {\n            console.error(\"Failed to send:\", error);\n            alert(\"Failed to send message\");\n        } else if (data) {\n            // Immediate local update\n            setMessages(prev => [...prev, data]);\n            scrollToBottom();\n        }\n    };\n\n    const scrollToBottom = () => {\n        setTimeout(() => bottomRef.current?.scrollIntoView({ behavior: 'smooth' }), 100);\n    };\n\n    if (loading) return <div className=\"text-xs text-gray-400 text-center py-2\">Loading chat...</div>;\n\n    return (\n        <div className=\"bg-gray-50 rounded-lg border border-gray-200 mt-3 overflow-hidden flex flex-col h-64\">\n             {/* Header */}\n            <div className=\"bg-gray-100 px-3 py-2 border-b border-gray-200 flex justify-between items-center\">\n                <span className=\"text-xs font-bold text-gray-700\">Squad Chat ðŸ’¬</span>\n                <span className=\"text-[10px] text-gray-400\">End-to-End Encrypted (Mock)</span>\n            </div>\n\n            {/* Messages Area */}\n            <div className=\"flex-1 overflow-y-auto p-3 space-y-2\">\n                {messages.length === 0 && (\n                    <div className=\"text-center text-gray-400 text-xs mt-10\">\n                        No messages yet. Say hi! ðŸ‘‹\n                    </div>\n                )}\n                {messages.map((msg) => {\n                    const isMe = msg.sender_address === userAddress;\n                    return (\n                        <div key={msg.id} className={`flex ${isMe ? 'justify-end' : 'justify-start'}`}>\n                            <div className={`max-w-[80%] rounded-lg px-3 py-1.5 text-xs ${\n                                isMe ? 'bg-blue-600 text-white' : 'bg-white border border-gray-200 text-gray-800'\n                            }`}>\n                                <p>{msg.content}</p>\n                            </div>\n                        </div>\n                    );\n                })}\n                <div ref={bottomRef} />\n            </div>\n\n            {/* Input Area */}\n            <form onSubmit={sendMessage} className=\"p-2 bg-white border-t border-gray-200 flex gap-2\">\n                <input\n                    type=\"text\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    placeholder=\"Type a message...\"\n                    className=\"flex-1 text-xs text-gray-900 bg-white placeholder-gray-500 border border-gray-300 rounded-md px-2 py-1.5 focus:outline-none focus:border-blue-500\"\n                />\n                <button \n                    type=\"submit\"\n                    disabled={!newMessage.trim()}\n                    className=\"bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-md hover:bg-blue-700 disabled:opacity-50\"\n                >\n                    Send\n                </button>\n            </form>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1111, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/RideList.tsx"],"sourcesContent":["import { useEffect, useState, useMemo } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { calculateMatchScore, Coordinates } from '@/lib/agent';\nimport { useWallets, usePrivy } from '@privy-io/react-auth';\nimport { createWalletClient, custom, parseUnits, encodeFunctionData } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\nconst BOOKING_PRICE_USDC = 0.01;\nconst BOOKING_PRICE_UNITS = parseUnits(BOOKING_PRICE_USDC.toString(), 6);\n\nconst ERC20_ABI = [\n  {\n    inputs: [\n      { name: 'to', type: 'address' },\n      { name: 'amount', type: 'uint256' },\n    ],\n    name: 'transfer',\n    outputs: [{ name: '', type: 'bool' }],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n] as const;\n\ninterface Ride {\n  id: number;\n  created_at: string;\n  user_address: string;\n  pickup_location: string;\n  dropoff_location: string;\n  departure_time: string;\n  wechat_id: string;\n  status: string;\n  // Real coordinates from DB\n  pickup_lat?: number;\n  pickup_lng?: number;\n  dropoff_lat?: number;\n  dropoff_lng?: number;\n  // Mock fields for UI demo\n  price?: number;\n  seats?: number;\n  match_score?: number;\n  ride_pickup_coords?: Coordinates;\n  ride_dropoff_coords?: Coordinates;\n  distance_from_user?: number;\n  isUnlocked?: boolean;\n}\n\ninterface RideListProps {\n  pickupCoords?: Coordinates;\n  dropoffCoords?: Coordinates;\n  onTopMatchUpdate?: (topMatch: Ride) => void;\n  refreshTrigger?: number;\n}\n\nimport Link from 'next/link';\nimport RideChat from './RideChat';\n\n// ... (existing code)\n\nconst SHORT_USDC_ADDRESS = `${USDC_ADDRESS.slice(0, 6)}...${USDC_ADDRESS.slice(-4)}`;\nconst V2_CONTRACT_ADDRESS = \"0x1225A84FC29FcdA297736ffe22977f8C594C21bc\"; // Deployed on Base Sepolia\n\nexport default function RideList({ pickupCoords, dropoffCoords, onTopMatchUpdate, refreshTrigger = 0 }: RideListProps) {\n  const [rides, setRides] = useState<Ride[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState<number | null>(null); // rideId\n  const [activeChatId, setActiveChatId] = useState<number | null>(null); // For chat toggle\n  const [expandedRideId, setExpandedRideId] = useState<number | null>(null);\n\n  const toggleExpand = (id: number) => {\n      setExpandedRideId(prev => prev === id ? null : id);\n  };\n\n  const [successTicket, setSuccessTicket] = useState<{ id: number; tx: string } | null>(null);\n  const { wallets } = useWallets();\n  const { user } = usePrivy();\n\n  const onToggleChat = (rideId: number) => {\n      setActiveChatId(prev => prev === rideId ? null : rideId);\n  };\n  \n  // -- Action Handlers --\n  const handleBook = async (ride: Ride) => {\n    try {\n        setActionLoading(ride.id);\n        const wallet = wallets[0];\n        if (!wallet) {\n            alert(\"Connect wallet first!\");\n            return;\n        }\n\n        const configRes = await fetch('/api/escrow/config');\n        const { address: agentAddress } = await configRes.json();\n        if (!agentAddress) throw new Error(\"Agent address missing\");\n\n        await wallet.switchChain(baseSepolia.id);\n        const provider = await wallet.getEthereumProvider();\n        const client = createWalletClient({\n            account: wallet.address as `0x${string}`,\n            chain: baseSepolia,\n            transport: custom(provider),\n        });\n\n        const data = encodeFunctionData({\n            abi: ERC20_ABI,\n            functionName: 'transfer',\n            args: [agentAddress as `0x${string}`, BOOKING_PRICE_UNITS],\n        });\n\n        // @ts-expect-error - KZG param not needed for simple transfer\n        const hash = await client.sendTransaction({ to: USDC_ADDRESS, data });\n\n        const depositRes = await fetch('/api/escrow/deposit', {\n            method: 'POST',\n            body: JSON.stringify({ rideId: ride.id, txHash: hash, userAddress: wallet.address })\n        });\n        \n        if (!depositRes.ok) throw new Error(\"Deposit failed\");\n\n        setRides(prev => prev.map(r => r.id === ride.id ? { ...r, status: 'escrow_holding', isUnlocked: true } : r));\n        addToBooked(ride.id);\n        setSuccessTicket({ id: ride.id, tx: hash });\n\n    } catch (e: any) {\n        console.error(\"Booking failed:\", e);\n        if (!e.message?.includes(\"User rejected\")) {\n            alert(`Booking Failed: ${e.shortMessage || e.message}`);\n        }\n    } finally {\n        setActionLoading(null);\n    }\n  };\n\n  function getDistanceFromLatLonInKm(lat1: number, lon1: number, lat2: number, lon2: number) {\n    const R = 6371; \n    const dLat = (lat2 - lat1) * (Math.PI / 180);\n    const dLon = (lon2 - lon1) * (Math.PI / 180);\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n              Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) *\n              Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  }\n\n  const handleRelease = async (ride: Ride) => {\n      if (!navigator.geolocation) {\n          alert(\"Geolocation is not supported\");\n          return;\n      }\n\n      setActionLoading(ride.id);\n\n      navigator.geolocation.getCurrentPosition(async (position) => {\n          const userLat = position.coords.latitude;\n          const userLng = position.coords.longitude;\n          \n          if (ride.dropoff_lat && ride.dropoff_lng) {\n              const distKm = getDistanceFromLatLonInKm(userLat, userLng, ride.dropoff_lat, ride.dropoff_lng);\n              if (distKm * 0.621371 > 0.5) {\n                  alert(`Too far from destination! You are ${(distKm * 0.621371).toFixed(2)} miles away.`);\n                  setActionLoading(null);\n                  return;\n              }\n          }\n\n          try {\n            const res = await fetch('/api/escrow/release', {\n                method: 'POST',\n                body: JSON.stringify({ rideId: ride.id })\n            });\n            const data = await res.json();\n            if (!res.ok) throw new Error(data.error);\n\n            setRides(prev => prev.map(r => r.id === ride.id ? { ...r, status: 'completed' } : r));\n            alert(`Funds Released!`);\n\n          } catch (e: any) {\n             alert(`Release Failed: ${e.message}`);\n          } finally {\n            setActionLoading(null);\n          }\n      }, () => {\n          alert(\"Could not get your location.\");\n          setActionLoading(null);\n      });\n  };\n\n  const openInUber = (ride: Ride) => {\n      const pLat = ride.ride_pickup_coords?.lat;\n      const pLng = ride.ride_pickup_coords?.lng;\n      const dLat = ride.ride_dropoff_coords?.lat;\n      const dLng = ride.ride_dropoff_coords?.lng;\n\n      if (!pLat || !pLng || !dLat || !dLng) {\n          alert(\"Missing coordinates.\");\n          return;\n      }\n      \n      const baseUrl = \"https://m.uber.com/ul/\";\n      const params = new URLSearchParams({\n        action: 'setPickup',\n        client_id: 'pincher_demo',\n        'pickup[latitude]': pLat.toString(),\n        'pickup[longitude]': pLng.toString(),\n        'pickup[nickname]': ride.pickup_location,\n        'dropoff[latitude]': dLat.toString(),\n        'dropoff[longitude]': dLng.toString(),\n        'dropoff[nickname]': ride.dropoff_location,\n      });\n      \n      window.open(`${baseUrl}?${params.toString()}`, '_blank');\n  };\n\n  const handleCopyWeChat = (text: string) => {\n      navigator.clipboard.writeText(text);\n      alert(\"WeChat ID Copied!\");\n  };\n\n\n  const [bookedRideIds, setBookedRideIds] = useState<number[]>([]);\n\n  useEffect(() => {\n      const stored = localStorage.getItem('pincher_booked_rides');\n      if (stored) {\n          try {\n              setBookedRideIds(JSON.parse(stored));\n          } catch (e) { console.error(\"Failed to parse booked rides\", e); }\n      }\n  }, []);\n\n  const addToBooked = (id: number) => {\n      const updated = [...bookedRideIds, id];\n      setBookedRideIds(updated);\n      localStorage.setItem('pincher_booked_rides', JSON.stringify(updated));\n  }\n\n  useEffect(() => {\n    fetchRides();\n  }, [refreshTrigger]);\n\n  async function fetchRides() {\n    try {\n      const { data, error } = await supabase\n        .from('rides')\n        .select('*')\n        .order('departure_time', { ascending: true });\n\n      if (error) throw error;\n      \n      const enrichedRides = (data || []).map((ride: any, index: number) => {\n        const hasRealCoords = ride.pickup_lat && ride.pickup_lng && ride.dropoff_lat && ride.dropoff_lng;\n        let pLat, pLng, dLat, dLng;\n\n        if (hasRealCoords) {\n             pLat = ride.pickup_lat;\n             pLng = ride.pickup_lng;\n             dLat = ride.dropoff_lat;\n             dLng = ride.dropoff_lng;\n        } else {\n            const latOffset = (index % 5 - 2) * 0.005; \n            const lngOffset = (index % 3 - 1) * 0.005;\n            pLat = 33.6846 + latOffset;\n            pLng = -117.8265 + lngOffset;\n            dLat = 33.7 + latOffset;\n            dLng = -117.8 + lngOffset;\n        }\n\n        return {\n          ...ride,\n          price: 10 + (ride.id % 25), \n          seats: 1 + (ride.id % 3),\n          ride_pickup_coords: { lat: pLat, lng: pLng },\n          ride_dropoff_coords: { lat: dLat, lng: dLng },\n          match_score: 0,\n          isUnlocked: ride.status === 'completed' || ride.status === 'escrow_holding'\n        }\n      });\n      \n      setRides(enrichedRides);\n    } catch (error: any) {\n      console.error('Error fetching rides:', error?.message || error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  const sortedRides = useMemo(() => {\n    if (!rides.length) return [];\n    if (!pickupCoords) return rides;\n\n    const scored = rides.map(ride => {\n        if (!ride.ride_pickup_coords || !ride.ride_dropoff_coords) return ride;\n        const { score, distance } = calculateMatchScore(\n            pickupCoords,\n            dropoffCoords,\n            ride.ride_pickup_coords,\n            ride.ride_dropoff_coords\n        );\n        return { ...ride, match_score: score, distance_from_user: distance };\n    });\n\n    return scored.sort((a, b) => (b.match_score || 0) - (a.match_score || 0));\n  }, [rides, pickupCoords, dropoffCoords]);\n\n  useEffect(() => {\n    if (onTopMatchUpdate && sortedRides.length > 0) {\n        onTopMatchUpdate(sortedRides[0]);\n    }\n  }, [sortedRides, onTopMatchUpdate]);\n\n\n\n  const displayedRides = sortedRides.filter(r => {\n      const GRACE_PERIOD_MS = 2 * 60 * 60 * 1000; \n      const isExpired = new Date(r.departure_time).getTime() < (Date.now() - GRACE_PERIOD_MS);\n      if (r.status === 'completed' || r.status === 'cancelled') return false;\n      if (r.status === 'escrow_holding') {\n          const isOrganizer = user?.wallet?.address && r.user_address && \n                              user.wallet.address.toLowerCase() === r.user_address.toLowerCase();\n          const isPassenger = bookedRideIds.includes(r.id);\n          return isOrganizer || isPassenger;\n      }\n      if (r.status === 'active') return !isExpired;\n      return true;\n  });\n\n  if (loading) return (\n      <div className=\"flex justify-center p-8\">\n          <div className=\"w-6 h-6 border-2 border-slate-200 border-t-black rounded-full animate-spin\"></div>\n      </div>\n  );\n\n\n  return (\n    <div className=\"space-y-4\">\n      {/* ... (Header remains same) ... */}\n      \n      {displayedRides.length === 0 ? (\n        <div className=\"text-center py-16 bg-white rounded-xl shadow-sm border border-gray-100\">\n             {/* ... (Empty state remains same) ... */}\n             <div className=\"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3\">\n                  <span className=\"text-xl opacity-50\">ðŸš—</span>\n             </div>\n             <p className=\"text-sm text-gray-900 font-bold\">No rides nearby</p>\n        </div>\n      ) : (\n        <div className=\"space-y-3 pb-20 px-1\">\n          {displayedRides.map((ride) => {\n            const date = new Date(ride.departure_time);\n            const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n            const isBooking = actionLoading === ride.id;\n            const isExpanded = expandedRideId === ride.id;\n            \n            return (\n                <div\n                key={ride.id}\n                onClick={() => toggleExpand(ride.id)}\n                className={`group px-4 py-3 bg-white border-b border-gray-100 last:border-0 hover:bg-gray-50 transition-all cursor-pointer ${\n                    ride.status === 'escrow_holding' ? 'bg-yellow-50/50' : \n                    ride.status === 'completed' ? 'bg-green-50/50' : ''\n                }`}\n                >\n                <div className=\"flex flex-col gap-2\">\n                    {/* Header: Time & Price & Status */}\n                    <div className=\"flex justify-between items-center\">\n                         <div className=\"flex items-center gap-2\">\n                             <span className=\"text-[10px] font-bold text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded\">\n                                 {timeStr}\n                             </span>\n                             {(ride.match_score || 0) > 80 && (\n                                <span className=\"text-[10px] font-bold text-green-600 flex items-center gap-0.5\">\n                                    <svg className=\"w-2.5 h-2.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" /></svg>\n                                    {ride.match_score}% Match\n                                </span>\n                             )}\n                         </div>\n                         <div className=\"flex items-center gap-2\">\n                             {ride.status === 'escrow_holding' && (\n                                 <span className=\"text-[9px] font-bold text-yellow-600 bg-yellow-100 px-1.5 py-0.5 rounded uppercase\">Escrow</span>\n                             )}\n                             <span className=\"text-sm font-black text-black\">0.01 USDC</span>\n                             {/* Chevron */}\n                             <svg className={`w-3 h-3 text-gray-400 transition-transform ${isExpanded ? 'rotate-180' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" /></svg>\n                         </div>\n                    </div>\n\n                    {/* Route Display */}\n                    {isExpanded ? (\n                        // EXPANDED VIEW: Full Addresses\n                        <div className=\"flex flex-col gap-3 mt-1 py-2 border-l-2 border-black pl-3 ml-1 animate-in fade-in duration-200\">\n                            <div>\n                                <p className=\"text-[9px] uppercase font-bold text-gray-400\">Pickup</p>\n                                <p className=\"text-xs font-bold text-black\">{ride.pickup_location}</p>\n                            </div>\n                            <div>\n                                <p className=\"text-[9px] uppercase font-bold text-gray-400\">Dropoff</p>\n                                <p className=\"text-xs font-bold text-black\">{ride.dropoff_location}</p>\n                            </div>\n                            {ride.distance_from_user !== undefined && (\n                                <p className=\"text-[10px] text-gray-500 italic\">\n                                    {(ride.distance_from_user * 0.621371).toFixed(1)} miles addition\n                                </p>\n                            )}\n                        </div>\n                    ) : (\n                        // COLLAPSED VIEW: Summary Line\n                        <div className=\"flex items-center gap-2 text-xs text-gray-900 font-bold leading-tight\">\n                            <span className=\"truncate max-w-[45%]\">{ride.pickup_location.split(',')[0]}</span>\n                            <span className=\"text-gray-300\">âžœ</span>\n                            <span className=\"truncate max-w-[45%]\">{ride.dropoff_location.split(',')[0]}</span>\n                        </div>\n                    )}\n\n                    {/* Action Area */}\n                    <div className=\"mt-1\" onClick={(e) => e.stopPropagation()}>\n                        {ride.status === 'active' && (\n                            <button\n                                onClick={() => handleBook(ride)}\n                                disabled={isBooking}\n                                className=\"w-full py-2 bg-black text-white rounded-md text-[10px] font-bold uppercase tracking-wider hover:bg-gray-800 disabled:bg-gray-200 disabled:text-gray-400 transition-colors flex items-center justify-center gap-2\"\n                            >\n                                {isBooking ? 'Processing...' : 'Pay Deposit (0.01 USDC) & Join'}\n                            </button>\n                        )}\n                        \n                        {ride.status === 'escrow_holding' && (\n                             <div className=\"flex flex-col gap-2 mt-2 pt-2 border-t border-dashed border-gray-100\">\n                                <div className=\"flex items-center justify-between\">\n                                     <span className=\"text-[9px] font-bold text-yellow-600 bg-yellow-50 px-1.5 py-0.5 rounded uppercase\">Ride In Progress</span>\n                                     <div className=\"flex items-center gap-1 text-[10px] text-gray-500\">\n                                        <span className=\"font-bold select-all\">{ride.wechat_id}</span>\n                                        <button onClick={(e) => {e.stopPropagation(); handleCopyWeChat(ride.wechat_id);}} className=\"hover:text-black\" title=\"Copy\">\n                                            <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 012 2v-8a2 2 0 01-2-2h-8a2 2 0 01-2 2v8a2 2 0 012 2z\" /></svg>\n                                        </button>\n                                     </div>\n                                </div>\n\n                                <div className=\"flex gap-2\">\n                                    {/* Organizer Actions */}\n                                    {user?.wallet?.address && ride.user_address && \n                                     user.wallet.address.toLowerCase() === ride.user_address.toLowerCase() ? (\n                                        <div className=\"flex items-center gap-1 w-full\">\n                                            <button\n                                                onClick={() => openInUber(ride)}\n                                                className=\"flex-1 py-1.5 bg-black text-white rounded text-[10px] font-bold hover:bg-gray-800\"\n                                            >\n                                                Open Uber\n                                            </button>\n                                            <button\n                                                onClick={() => alert(\"Simulated: Customer support contacted.\")}\n                                                className=\"flex-1 py-1.5 bg-gray-100 text-gray-600 rounded text-[10px] font-bold hover:bg-gray-200\"\n                                            >\n                                                Support\n                                            </button>\n                                        </div>\n                                    ) : (\n                                        /* Passenger Actions */\n                                        <button\n                                            onClick={() => handleRelease(ride)}\n                                            disabled={isBooking}\n                                            className=\"w-full py-2 bg-green-600 text-white rounded text-[10px] font-bold hover:bg-green-700 disabled:bg-green-400 shadow-sm\"\n                                        >\n                                            {isBooking ? 'Verifying...' : 'âœ… Confirm Pickup'}\n                                        </button>\n                                    )}\n                                </div>\n                            </div>\n                        )}\n                        \n                         {ride.status === 'completed' && (\n                             <div className=\"w-full py-2 bg-gray-100 text-gray-500 rounded-md text-[10px] font-bold uppercase tracking-wider text-center cursor-default\">\n                                 Completed\n                             </div>\n                        )}\n                        \n                        {/* Expanded Chat Toggle */}\n                        {isExpanded && (\n                            <button\n                                onClick={(e) => {\n                                    e.stopPropagation();\n                                    onToggleChat(ride.id);\n                                }}\n                                className=\"mt-2 w-full text-[10px] font-bold text-gray-400 hover:text-black hover:bg-gray-50 py-1.5 rounded border border-transparent hover:border-gray-100 transition-all flex items-center justify-center gap-1\"\n                            >\n                                {activeChatId === ride.id ? 'Hide Chat' : 'ðŸ’¬ Open Chat'}\n                            </button>\n                        )}\n                    </div>\n\n                    {/* Render Chat if Open */}\n                    {activeChatId === ride.id && (\n                        <div className=\"mt-2 pt-2 border-t border-gray-100\" onClick={(e) => e.stopPropagation()}>\n                             <RideChat rideId={ride.id} />\n                        </div>\n                    )}\n                </div>\n                </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Success Modal - Uber White Style */}\n      {successTicket && (\n        <div className=\"fixed inset-0 z-100 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4 animate-in fade-in duration-200\">\n            <div className=\"w-full max-w-sm bg-white rounded-xl shadow-2xl p-6 relative overflow-hidden\">\n                <div className=\"flex flex-col items-center text-center\">\n                    {/* Icon */}\n                    <div className=\"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-4\">\n                        <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" />\n                        </svg>\n                    </div>\n\n                    <h3 className=\"text-xl font-black text-black tracking-tight mb-2\">\n                        Ride Confirmed\n                    </h3>\n                    <p className=\"text-sm text-gray-500 mb-6 max-w-[240px]\">\n                        Deposit locked. Driver is on the way.\n                    </p>\n\n                    {/* Ticket Details */}\n                    <div className=\"w-full bg-gray-50 rounded-lg p-3 mb-6 border border-gray-100\">\n                        <div className=\"flex justify-between items-center mb-2\">\n                            <span className=\"text-[10px] uppercase font-bold text-gray-400 tracking-wider\">Ticket ID</span>\n                            <span className=\"text-xs font-mono font-bold text-black\">#{successTicket.id.toString().padStart(4, '0')}</span>\n                        </div>\n                        <div className=\"w-full h-px bg-gray-200 my-2\"></div>\n                        <div className=\"flex justify-between items-center\">\n                            <span className=\"text-[10px] uppercase font-bold text-gray-400 tracking-wider\">Status</span>\n                            <span className=\"text-[10px] font-bold text-green-700 bg-green-100 px-2 py-0.5 rounded-full\">ACTIVE</span>\n                        </div>\n                    </div>\n\n                    {/* Actions */}\n                    <div className=\"w-full space-y-3\">\n                        <button\n                            onClick={() => setSuccessTicket(null)}\n                            className=\"w-full py-3 rounded-lg bg-black text-white font-bold text-sm hover:bg-gray-800 transition-all active:scale-[0.98]\"\n                        >\n                            Track Driver\n                        </button>\n                        \n                        <a \n                            href={`https://sepolia.basescan.org/tx/${successTicket.tx}`}\n                            target=\"_blank\"\n                            rel=\"noreferrer\"\n                            className=\"block w-full text-center py-2 text-xs font-medium text-gray-400 hover:text-black transition-colors\"\n                        >\n                            View Receipt on BaseScan â†—\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n      )}\n\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2080, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/MapSidebar.tsx"],"sourcesContent":["'use client';\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport RideList from './RideList';\n\ninterface MapSidebarProps {\n  isOpen: boolean;\n  onToggle: () => void;\n  pickupCoords?: { lat: number; lng: number };\n  dropoffCoords?: { lat: number; lng: number };\n  onTopMatchUpdate?: (topMatch: any) => void;\n  refreshTrigger?: number;\n}\n\nexport default function MapSidebar({ isOpen, onToggle, pickupCoords, dropoffCoords, onTopMatchUpdate, refreshTrigger }: MapSidebarProps) {\n  const { authenticated } = usePrivy();\n\n  if (!authenticated) return null;\n\n  return (\n    <>\n      {/* Hamburger Toggle Button */}\n      <button\n        onClick={onToggle}\n        className={`absolute top-4 left-4 z-50 p-2.5 bg-white text-black rounded-full shadow-lg hover:bg-gray-50 transition-all duration-300 ease-in-out active:scale-95 pointer-events-auto border border-gray-100 ${isOpen ? 'translate-x-[320px]' : 'translate-x-0'}`}\n        aria-label=\"Toggle Sidebar\"\n      >\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          {isOpen ? (\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M6 18L18 6M6 6l12 12\" />\n          ) : (\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M4 6h16M4 12h16M4 18h16\" />\n          )}\n        </svg>\n      </button>\n\n      {/* Sidebar Overlay */}\n      {isOpen && (\n        <div \n          className=\"fixed inset-0 bg-black/40 z-40 backdrop-blur-sm transition-opacity\"\n          onClick={onToggle}\n        />\n      )}\n\n      {/* Sidebar Panel */}\n      <div \n        className={`fixed top-0 left-0 bottom-0 w-[320px] bg-white shadow-2xl z-50 flex flex-col transition-transform duration-300 ease-in-out ${\n          isOpen ? 'translate-x-0' : '-translate-x-full'\n        }`}\n      >\n        {/* Header Branding */}\n        <div className=\"px-6 py-6 border-b border-gray-100 bg-white shrink-0\">\n            <h2 className=\"text-3xl font-black text-black tracking-tighter\">Pincher</h2>\n        </div>\n\n        {/* Ride List Content */}\n        <div className=\"flex-1 overflow-y-auto bg-white\">\n          <div className=\"p-0\">\n            <RideList pickupCoords={pickupCoords} dropoffCoords={dropoffCoords} onTopMatchUpdate={onTopMatchUpdate} />\n          </div>\n        </div>\n        \n        {/* Footer */}\n        <div className=\"p-4 border-t border-gray-100 bg-gray-50\">\n          <p className=\"text-center text-[10px] text-gray-400 font-medium\">\n             Pincher Protocol Â© 2025\n          </p>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAce,SAAS,WAAW,EAAE,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,aAAa,EAAE,gBAAgB,EAAE,cAAc,EAAmB;;IACrI,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,6PAAQ;IAElC,IAAI,CAAC,eAAe,OAAO;IAE3B,qBACE;;0BAEE,mNAAC;gBACC,SAAS;gBACT,WAAW,CAAC,gMAAgM,EAAE,SAAS,wBAAwB,iBAAiB;gBAChQ,cAAW;0BAEX,cAAA,mNAAC;oBAAI,WAAU;oBAAU,MAAK;oBAAO,QAAO;oBAAe,SAAQ;8BAChE,uBACC,mNAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,aAAa;wBAAK,GAAE;;;;;6CAEvE,mNAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,aAAa;wBAAK,GAAE;;;;;;;;;;;;;;;;YAM5E,wBACC,mNAAC;gBACC,WAAU;gBACV,SAAS;;;;;;0BAKb,mNAAC;gBACC,WAAW,CAAC,2HAA2H,EACrI,SAAS,kBAAkB,qBAC3B;;kCAGF,mNAAC;wBAAI,WAAU;kCACX,cAAA,mNAAC;4BAAG,WAAU;sCAAkD;;;;;;;;;;;kCAIpE,mNAAC;wBAAI,WAAU;kCACb,cAAA,mNAAC;4BAAI,WAAU;sCACb,cAAA,mNAAC,2JAAQ;gCAAC,cAAc;gCAAc,eAAe;gCAAe,kBAAkB;;;;;;;;;;;;;;;;kCAK1F,mNAAC;wBAAI,WAAU;kCACb,cAAA,mNAAC;4BAAE,WAAU;sCAAoD;;;;;;;;;;;;;;;;;;;AAO3E;GAzDwB;;QACI,6PAAQ;;;KADZ"}},
    {"offset": {"line": 2224, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/UserProfile.tsx"],"sourcesContent":["'use client';\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport { useState, useEffect } from 'react';\nimport { createPublicClient, http, formatUnits, erc20Abi } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\n\nexport default function UserProfile() {\n  const { user, logout, authenticated } = usePrivy();\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [funding, setFunding] = useState(false);\n  const [balance, setBalance] = useState<string>('0.00');\n  const [ethBalance, setEthBalance] = useState<string>('0.00');\n\n  useEffect(() => {\n    if (authenticated && user?.wallet?.address) {\n        fetchBalance();\n    }\n  }, [authenticated, user?.wallet?.address, showDropdown]);\n\n  const fetchBalance = async () => {\n    try {\n        const client = createPublicClient({\n            chain: baseSepolia,\n            transport: http(),\n        });\n\n        // Fetch USDC Balance\n        console.log(\"Fetching balance for:\", user!.wallet!.address);\n        \n        // @ts-expect-error - viem type inference issue\n        const usdcData = await client.readContract({\n            address: USDC_ADDRESS,\n            abi: erc20Abi,\n            functionName: 'balanceOf',\n            args: [user!.wallet!.address as `0x${string}`],\n        });\n        console.log(\"Raw USDC Data:\", usdcData);\n        \n        const usdcFormatted = formatUnits(usdcData as bigint, 6);\n        console.log(\"Formatted USDC:\", usdcFormatted);\n        \n        setBalance(parseFloat(usdcFormatted).toFixed(2));\n\n        // Fetch ETH Balance\n        const ethData = await client.getBalance({ \n            address: user!.wallet!.address as `0x${string}` \n        });\n        const ethFormatted = formatUnits(ethData, 18);\n        setEthBalance(parseFloat(ethFormatted).toFixed(4));\n\n    } catch (e) {\n        console.error(\"Balance fetch error\", e);\n    }\n  };\n\n  if (!authenticated) return null;\n\n  const displayName = user?.email?.address || \n    (user?.wallet?.address ? `${user.wallet.address.slice(0, 6)}...${user.wallet.address.slice(-4)}` : 'User');\n\n  const handleFundWallet = async () => {\n    if (!user?.wallet?.address) return;\n    setFunding(true);\n    try {\n      const res = await fetch('/api/faucet', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ address: user.wallet.address }),\n      });\n      const data = await res.json();\n      if (data.success) {\n        alert('Funding successful! Check your wallet on Base Sepolia.');\n        fetchBalance(); // Refresh\n      } else {\n        alert('Funding failed: ' + (data.error || 'Unknown error'));\n      }\n    } catch (e) {\n      alert('Funding error');\n    } finally {\n      setFunding(false);\n    }\n  };\n\n  return (\n    <div className=\"absolute top-4 right-4 z-50 font-sans\">\n      <div className=\"relative\">\n        <button\n          onClick={() => setShowDropdown(!showDropdown)}\n          className=\"flex items-center gap-2 bg-white/90 backdrop-blur-md px-2 pr-4 py-1.5 rounded-full shadow-md hover:bg-white transition-all border border-gray-100 group\"\n        >\n          <div className=\"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-black font-bold text-xs\">\n            {displayName[0].toUpperCase()}\n          </div>\n          <div className=\"flex flex-col items-start\">\n             <span className=\"text-xs font-bold text-gray-900 group-hover:text-black transition-colors leading-none\">\n                {displayName}\n            </span>\n          </div>\n          <svg className={`w-3 h-3 text-gray-400 ml-1 transition-transform ${showDropdown ? 'rotate-180' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n\n        {showDropdown && (\n          <div className=\"absolute right-0 mt-2 w-72 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden py-1 animate-in fade-in slide-in-from-top-2 duration-200 ring-1 ring-black/5\">\n            <div className=\"px-4 py-3 bg-gray-50 border-b border-gray-100\">\n              <p className=\"text-[10px] text-gray-400 uppercase tracking-widest font-bold mb-3\">Wallet Connected</p>\n              <div className=\"flex flex-col gap-2\">\n                <div className=\"flex items-center gap-2 bg-white p-2.5 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors shadow-sm\">\n                    <p className=\"text-[10px] font-mono text-gray-500 break-all leading-tight\">\n                        {user?.wallet?.address}\n                    </p>\n                    <button \n                        onClick={() => {\n                            if (user?.wallet?.address) {\n                                navigator.clipboard.writeText(user.wallet.address);\n                                alert('Address copied!');\n                            }\n                        }}\n                        className=\"text-gray-400 hover:text-black shrink-0 transition-colors\"\n                        title=\"Copy Address\"\n                    >\n                        <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" /></svg>\n                    </button>\n                    {user?.wallet?.address && (\n                        <a \n                            href={`https://sepolia.basescan.org/address/${user.wallet.address}`}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"text-blue-500 hover:text-blue-700 shrink-0 transition-colors\"\n                            title=\"View on Explorer\"\n                        >\n                            <svg className=\"w-3.5 h-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" /></svg>\n                        </a>\n                    )}\n                </div>\n              </div>\n              \n              <div className=\"mt-3 grid grid-cols-2 gap-2\">\n                  <div className=\"flex flex-col bg-white border border-gray-200 rounded-lg p-2 shadow-sm\">\n                      <span className=\"text-[9px] text-gray-400 font-bold uppercase\">Balance</span>\n                      <span className=\"text-sm font-bold text-gray-900 mt-0.5\">{balance} <span className=\"text-[9px] text-gray-400\">USDC</span></span>\n                  </div>\n                  <div className=\"flex flex-col bg-white border border-gray-200 rounded-lg p-2 shadow-sm\">\n                      <div className=\"flex justify-between items-start\">\n                         <span className=\"text-[9px] text-gray-400 font-bold uppercase\">Gas</span>\n                         <button onClick={fetchBalance} className=\"text-gray-400 hover:text-black transition-colors\"><svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" /></svg></button>\n                      </div>\n                      <span className=\"text-sm font-bold text-gray-900 mt-0.5\">{ethBalance} <span className=\"text-[9px] text-gray-400\">ETH</span></span>\n                  </div>\n              </div>\n\n               <a \n                    href={`https://sepolia.basescan.org/address/${user?.wallet?.address}#tokentxnsErc1155`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"w-full flex items-center justify-center gap-2 bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300 text-gray-600 hover:text-black py-2.5 rounded-lg text-[10px] font-bold uppercase tracking-wide transition-all mt-3 shadow-sm\"\n                  >\n                    <span>ðŸ“œ</span> History\n                  </a>\n            </div>\n            \n            {/* Faucet Links */}\n            <div className=\"p-3 bg-white\">\n                <p className=\"text-[9px] font-bold text-gray-400 px-1 uppercase tracking-wider mb-2\">Testnet Tools</p>\n                <div className=\"grid grid-cols-2 gap-2\">\n                    <a\n                        href=\"https://portal.cdp.coinbase.com/products/faucet\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"px-2 py-1.5 text-[10px] text-gray-600 bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 transition-colors flex items-center justify-between\"\n                    >\n                        <span>Base ETH</span>\n                        <span className=\"text-gray-400\">â†—</span>\n                    </a>\n                     <a\n                        href=\"https://faucet.circle.com/\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"px-2 py-1.5 text-[10px] text-gray-600 bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 transition-colors flex items-center justify-between\"\n                    >\n                        <span>USDC</span>\n                        <span className=\"text-gray-400\">â†—</span>\n                    </a>\n                </div>\n            </div>\n\n            <button\n              onClick={logout}\n              className=\"w-full text-left px-4 py-3 text-xs font-bold text-red-500 hover:bg-red-50 transition-colors flex items-center gap-2 border-t border-gray-100\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                 <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n              </svg>\n              Sign Out Securely\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2770, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/Directions.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useMap, useMapsLibrary } from '@vis.gl/react-google-maps';\n\ninterface DirectionsProps {\n  pickup?: { lat: number; lng: number };\n  dropoff?: { lat: number; lng: number };\n}\n\nexport default function Directions({ pickup, dropoff }: DirectionsProps) {\n  const map = useMap();\n  const routesLibrary = useMapsLibrary('routes');\n  const [directionsService, setDirectionsService] = useState<google.maps.DirectionsService>();\n  const [directionsRenderer, setDirectionsRenderer] = useState<google.maps.DirectionsRenderer>();\n\n  // 1. Initialize Services\n  useEffect(() => {\n    if (!routesLibrary || !map) return;\n\n    const ds = new routesLibrary.DirectionsService();\n    // Suppress default markers so we can use our custom sexy markers\n    const dr = new routesLibrary.DirectionsRenderer({\n        map,\n        suppressMarkers: true, \n        polylineOptions: {\n            strokeColor: '#2563EB', // Tech Blue (matches app theme)\n            strokeWeight: 6,\n            strokeOpacity: 1.0,\n        }\n    });\n\n    setDirectionsService(ds);\n    setDirectionsRenderer(dr);\n\n    return () => {\n        dr.setMap(null); // Cleanup\n    };\n  }, [routesLibrary, map]);\n\n  // 2. Fetch Route\n  useEffect(() => {\n    if (!directionsService || !directionsRenderer) return;\n\n    // Check inputs\n    if (!pickup || !dropoff) {\n        // Clear route if points removed\n        directionsRenderer.setDirections({ routes: [] } as any); \n        return;\n    }\n\n    console.log(\"ðŸ“ Directions: Fetching route...\", { pickup, dropoff });\n\n    directionsService.route({\n        origin: pickup,\n        destination: dropoff,\n        travelMode: google.maps.TravelMode.DRIVING,\n    }).then(response => {\n        console.log(\"âœ… Directions: Found route!\", response);\n        directionsRenderer.setDirections(response);\n    }).catch(e => {\n        console.error(\"âŒ Directions request failed\", e);\n    });\n\n  }, [directionsService, directionsRenderer, pickup, dropoff]);\n\n  return null; // Logic only, renders directly on map instance\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAOe,SAAS,WAAW,EAAE,MAAM,EAAE,OAAO,EAAmB;;IACrE,MAAM,MAAM,IAAA,qNAAM;IAClB,MAAM,gBAAgB,IAAA,6NAAc,EAAC;IACrC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,+LAAQ;IAC1D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,+LAAQ;IAE5D,yBAAyB;IACzB,IAAA,gMAAS;gCAAC;YACR,IAAI,CAAC,iBAAiB,CAAC,KAAK;YAE5B,MAAM,KAAK,IAAI,cAAc,iBAAiB;YAC9C,iEAAiE;YACjE,MAAM,KAAK,IAAI,cAAc,kBAAkB,CAAC;gBAC5C;gBACA,iBAAiB;gBACjB,iBAAiB;oBACb,aAAa;oBACb,cAAc;oBACd,eAAe;gBACnB;YACJ;YAEA,qBAAqB;YACrB,sBAAsB;YAEtB;wCAAO;oBACH,GAAG,MAAM,CAAC,OAAO,UAAU;gBAC/B;;QACF;+BAAG;QAAC;QAAe;KAAI;IAEvB,iBAAiB;IACjB,IAAA,gMAAS;gCAAC;YACR,IAAI,CAAC,qBAAqB,CAAC,oBAAoB;YAE/C,eAAe;YACf,IAAI,CAAC,UAAU,CAAC,SAAS;gBACrB,gCAAgC;gBAChC,mBAAmB,aAAa,CAAC;oBAAE,QAAQ,EAAE;gBAAC;gBAC9C;YACJ;YAEA,QAAQ,GAAG,CAAC,oCAAoC;gBAAE;gBAAQ;YAAQ;YAElE,kBAAkB,KAAK,CAAC;gBACpB,QAAQ;gBACR,aAAa;gBACb,YAAY,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO;YAC9C,GAAG,IAAI;wCAAC,CAAA;oBACJ,QAAQ,GAAG,CAAC,8BAA8B;oBAC1C,mBAAmB,aAAa,CAAC;gBACrC;uCAAG,KAAK;wCAAC,CAAA;oBACL,QAAQ,KAAK,CAAC,+BAA+B;gBACjD;;QAEF;+BAAG;QAAC;QAAmB;QAAoB;QAAQ;KAAQ;IAE3D,OAAO,MAAM,+CAA+C;AAC9D;GAzDwB;;QACV,qNAAM;QACI,6NAAc;;;KAFd"}},
    {"offset": {"line": 2867, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/components/UserOnboarding.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { usePrivy, useWallets } from '@privy-io/react-auth';\nimport { createPublicClient, http, formatEther, formatUnits } from 'viem';\nimport { baseSepolia } from 'viem/chains';\nimport Image from 'next/image';\n\nconst client = createPublicClient({\n  chain: baseSepolia,\n  transport: http(),\n});\n\ninterface UserOnboardingProps {\n  onComplete: () => void;\n}\n\nexport default function UserOnboarding({ onComplete }: UserOnboardingProps) {\n  const { login, authenticated, user } = usePrivy();\n  const { wallets } = useWallets();\n  const [step, setStep] = useState<1 | 2 | 3>(1);\n  const [balance, setBalance] = useState<{ eth: string; usdc: string } | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [faucetStatus, setFaucetStatus] = useState<'idle' | 'claiming' | 'success' | 'error'>('idle');\n\n  // Step 1 -> 2: Auto transition when authenticated\n  useEffect(() => {\n    if (authenticated && user?.wallet?.address) {\n      setStep(2);\n      checkBalance(user.wallet.address);\n    }\n  }, [authenticated, user]);\n\n  const checkBalance = async (address: string) => {\n    setLoading(true);\n    try {\n      const ethBal = await client.getBalance({ address: address as `0x${string}` });\n      \n      const USDC_ADDRESS = '0x036CbD53842c5426634e7929541eC2318f3dCF7e';\n      // @ts-expect-error - viem type mismatch\n      const usdcBal = await client.readContract({\n        address: USDC_ADDRESS,\n        abi: [{ name: 'balanceOf', type: 'function', inputs: [{ name: 'owner', type: 'address' }], outputs: [{ name: 'balance', type: 'uint256' }], stateMutability: 'view' }],\n        functionName: 'balanceOf',\n        args: [address as `0x${string}`],\n      }) as bigint;\n\n      const eth = formatEther(ethBal);\n      const usdc = formatUnits(usdcBal, 6);\n\n      setBalance({ eth, usdc });\n    } catch (e) {\n      console.error(\"Balance check failed\", e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const claimFaucet = async () => {\n    if (!user?.wallet?.address) return;\n    setFaucetStatus('claiming');\n    try {\n      const res = await fetch('/api/faucet/claim', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ address: user.wallet.address }),\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error);\n      \n      setFaucetStatus('success');\n      // Re-check balance after short delay\n      setTimeout(() => checkBalance(user.wallet.address!), 3000);\n    } catch (e) {\n      console.error(\"Faucet error\", e);\n      setFaucetStatus('error');\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-100 flex items-center justify-center bg-gray-100/50 backdrop-blur-sm\">\n      <div className=\"w-full max-w-md bg-white border border-gray-100 rounded-2xl p-8 shadow-2xl relative overflow-hidden\">\n        \n        <div className=\"relative z-10 flex flex-col items-center text-center\">\n          {/* Brand Welcome */}\n          <div className=\"relative w-32 h-32 mb-2\">\n            <Image\n                src=\"/pincher-v1.5.png\"\n                alt=\"Pincher Logo\"\n                fill\n                className=\"object-contain\"\n                priority\n            />\n          </div>\n          <h2 className=\"text-xl font-black text-black tracking-tight mb-1\">\n            Welcome to Pincher\n          </h2>\n          <p className=\"text-sm font-medium text-gray-500 mb-8\">\n            Share Rides. Smart Fares.\n          </p>\n\n          <div className=\"space-y-6 w-full text-left\">\n            \n            {/* Step 1: Identity */}\n            {step === 1 && (\n              <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <span className=\"text-xs font-bold text-gray-500 uppercase tracking-widest\">Step 1/2</span>\n                  <span className=\"text-xs font-bold text-black uppercase tracking-widest\">Identity</span>\n                </div>\n                \n                <button\n                  onClick={login}\n                  className=\"w-full py-4 bg-black hover:bg-gray-800 rounded-xl text-white font-bold transition-all flex items-center justify-center gap-3 shadow-md hover:shadow-lg active:scale-[0.98]\"\n                >\n                  Login / Sign Up\n                </button>\n              </div>\n            )}\n\n            {/* Step 2: Fuel */}\n            {step === 2 && (\n              <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500\">\n                 <div className=\"flex items-center justify-between mb-4\">\n                  <span className=\"text-xs font-bold text-gray-500 uppercase tracking-widest\">Step 2/2</span>\n                  <span className=\"text-xs font-bold text-black uppercase tracking-widest\">Gas & Tokens</span>\n                </div>\n                \n                <div className=\"bg-gray-50 border border-gray-100 rounded-xl p-4 mb-6\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                     <span className=\"text-xs text-gray-500 font-medium\">Wallet Balance</span>\n                     {loading ? (\n                         <span className=\"text-xs text-gray-400 animate-pulse\">Scanning...</span>\n                     ) : (\n                         <div className=\"text-right\">\n                             <div className=\"text-sm font-bold text-black\">{balance?.usdc || '0.00'} USDC</div>\n                             <div className=\"text-[10px] font-mono text-gray-400\">{balance?.eth || '0.00'} ETH</div>\n                         </div>\n                     )}\n                  </div>\n\n                  {balance && parseFloat(balance.usdc) < 1 && (\n                      <button\n                        onClick={claimFaucet}\n                        disabled={faucetStatus === 'claiming' || faucetStatus === 'success'}\n                        className=\"w-full py-3 bg-black text-white hover:bg-gray-900 rounded-lg font-bold text-sm shadow-md disabled:opacity-50 disabled:cursor-not-allowed transition-all relative overflow-hidden active:scale-[0.98]\"\n                      >\n                         {faucetStatus === 'claiming' ? (\n                             <span className=\"flex items-center justify-center gap-2\">\n                                 <svg className=\"animate-spin h-4 w-4 text-white\" viewBox=\"0 0 24 24\"><circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\"/><path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"/></svg>\n                                 Sending Test Tokens...\n                             </span>\n                         ) : faucetStatus === 'success' ? (\n                             'Funds Received!'\n                         ) : (\n                             'Claim 50 Test-USDC & ETH'\n                         )}\n                      </button>\n                  )}\n                  {balance && parseFloat(balance.usdc) >= 1 && (\n                      <div className=\"text-center text-xs text-green-700 font-bold py-2 bg-green-50 rounded-lg border border-green-100\">\n                          Ready to use!\n                      </div>\n                  )}\n                </div>\n\n                {/* Step 3 Action moved here */}\n                <button\n                    onClick={onComplete}\n                    disabled={balance ? parseFloat(balance.usdc) < 1 : true}\n                    className=\"w-full py-4 bg-black text-white hover:bg-gray-900 disabled:bg-gray-200 disabled:text-gray-400 rounded-xl font-bold text-lg tracking-wide transition-all shadow-lg active:scale-[0.98]\"\n                >\n                    Start Ride\n                </button>\n              </div>\n            )}\n\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3275, "column": 0}, "map": {"version":3,"sources":["file:///Users/jhinresh/Desktop/pincher/app/uber/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { APIProvider, Map, ControlPosition, AdvancedMarker, Pin } from \"@vis.gl/react-google-maps\";\nimport SearchBox from \"@/components/SearchBox\";\nimport MapSidebar from \"@/components/MapSidebar\";\nimport UserProfile from \"@/components/UserProfile\";\nimport Directions from \"@/components/Directions\";\nimport UserOnboarding from '@/components/UserOnboarding';\n\nexport default function UberPage() {\n  const apiKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || \"\";\n  const [pickupCoords, setPickupCoords] = useState<{ lat: number; lng: number } | undefined>();\n  const [dropoffCoords, setDropoffCoords] = useState<{ lat: number; lng: number } | undefined>();\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false);\n  const [topMatch, setTopMatch] = useState<any>(null); // State for Notification\n  const [hasOnboarded, setHasOnboarded] = useState(false);\n  const [refreshKey, setRefreshKey] = useState(0);\n\n  // Auto-open sidebar if high match found? Or just show notification.\n  // We'll show notification.\n\n  // Default center: Orange County\n  const center = pickupCoords || dropoffCoords || { lat: 33.6846, lng: -117.8265 };\n\n  const handlePickupChange = (_location: string, coords?: { lat: number; lng: number }) => {\n    if (coords) {\n      setPickupCoords(coords);\n    }\n  };\n\n  const handleDropoffChange = (_location: string, coords?: { lat: number; lng: number }) => {\n    if (coords) {\n      setDropoffCoords(coords);\n    }\n  };\n\n  const handleRideCreated = () => {\n      setRefreshKey(prev => prev + 1);\n      setIsSidebarOpen(true); // Auto open sidebar to see new ride\n  };\n\n  return (\n    <>\n      {!hasOnboarded && (\n          <UserOnboarding onComplete={() => setHasOnboarded(true)} />\n      )}\n      {/* Global Style for Google Places Autocomplete */}\n      <style jsx global>{`\n        .pac-container {\n          z-index: 9999 !important;\n          border-radius: 8px;\n          box-shadow:\n            0 4px 6px -1px rgb(0 0 0 / 0.1),\n            0 2px 4px -2px rgb(0 0 0 / 0.1);\n          border: none;\n          margin-top: 4px;\n        }\n        .pac-item {\n          padding: 12px 16px;\n          cursor: pointer;\n          border: none;\n          font-size: 14px;\n        }\n        .pac-item:hover {\n          background-color: #f3f4f6;\n        }\n        .pac-icon {\n          display: none;\n        }\n        .pac-item-query {\n          font-size: 14px;\n          font-weight: 500;\n          color: #111827;\n        }\n      `}</style>\n\n      <div className=\"h-screen w-screen flex relative overflow-hidden\">\n        {/* Sidebar */}\n        {/* Sidebar */}\n        <MapSidebar \n          isOpen={isSidebarOpen} \n          onToggle={() => setIsSidebarOpen(!isSidebarOpen)} \n          pickupCoords={pickupCoords}\n          dropoffCoords={dropoffCoords}\n          onTopMatchUpdate={setTopMatch}\n          refreshTrigger={refreshKey}\n        />\n        \n        {/* Top Right User Profile */}\n        <UserProfile />\n\n        {/* Map Container */}\n        <div className=\"flex-1 relative h-full\">\n          {apiKey ? (\n            <APIProvider apiKey={apiKey} libraries={[\"places\", \"marker\"]}>\n              <Map\n                key={`${center.lat}-${center.lng}`}\n                defaultCenter={center}\n                defaultZoom={pickupCoords || dropoffCoords ? 13 : 11}\n                gestureHandling=\"greedy\"\n                disableDefaultUI={true}\n                mapId=\"DEMO_MAP_ID\"\n                mapTypeControlOptions={{ position: ControlPosition.BOTTOM_LEFT }}\n                className=\"w-full h-full\"\n              >\n                {pickupCoords && (\n                  <AdvancedMarker \n                    position={pickupCoords}\n                    draggable={true}\n                    onDragEnd={(e: any) => {\n                        if (e.latLng) {\n                            const newLat = e.latLng.lat();\n                            const newLng = e.latLng.lng();\n                            setPickupCoords({ lat: newLat, lng: newLng });\n                        }\n                    }}\n                  >\n                    <Pin background={'#000000'} glyphColor={'#ffffff'} borderColor={'#000000'} />\n                  </AdvancedMarker>\n                )}\n                {dropoffCoords && (\n                   <AdvancedMarker \n                    position={dropoffCoords}\n                    draggable={true}\n                    onDragEnd={(e: any) => {\n                        if (e.latLng) {\n                            const newLat = e.latLng.lat();\n                            const newLng = e.latLng.lng();\n                            setDropoffCoords({ lat: newLat, lng: newLng });\n                        }\n                    }}\n                   >\n                    <Pin background={'#ffffff'} glyphColor={'#000000'} borderColor={'#000000'} />\n                  </AdvancedMarker>\n                )}\n                \n                {/* Route Line */}\n                <Directions pickup={pickupCoords} dropoff={dropoffCoords} />\n              </Map>\n              {/* Search Box with sliding effect */}\n              <SearchBox \n                onPickupChange={handlePickupChange} \n                onDropoffChange={handleDropoffChange} \n                className={isSidebarOpen ? 'translate-x-[320px]' : ''}\n                externalPickupCoords={pickupCoords}\n                externalDropoffCoords={dropoffCoords}\n                onRideCreated={handleRideCreated}\n              />\n              \n              {/* Match Notification Pill */}\n              {topMatch && topMatch.match_score > 60 && !isSidebarOpen && (\n                  <div \n                    className=\"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-xl p-2 pr-4 flex items-center gap-3 cursor-pointer hover:scale-105 transition-transform animate-in slide-in-from-bottom-4 duration-500 z-50 border border-gray-100\"\n                    onClick={() => setIsSidebarOpen(true)}\n                  >\n                      <div className=\"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center shrink-0\">\n                          <span className=\"text-sm font-bold text-green-700\">{topMatch.match_score}%</span>\n                      </div>\n                      <div className=\"flex flex-col\">\n                          <span className=\"text-xs font-bold text-gray-900 border-b border-gray-100 pb-0.5\">High Match Found!</span>\n                          <span className=\"text-[10px] text-gray-500\">{topMatch.seats} seats â€¢ ${topMatch.price}</span>\n                      </div>\n                      <div className=\"w-8 h-8 rounded-full bg-black flex items-center justify-center text-white\">\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" /></svg>\n                      </div>\n                  </div>\n              )}\n            </APIProvider>\n          ) : (\n            <div className=\"flex items-center justify-center h-full bg-gray-200\">\n              <div className=\"text-center p-8 bg-white rounded-lg shadow-lg\">\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                  éœ€è¦ Google Maps API Key\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  è«‹åœ¨ .env æ–‡ä»¶ä¸­æ·»åŠ ï¼šNEXT_PUBLIC_GOOGLE_MAPS_API_KEY\n                </p>\n              </div>\n              {/* Fallback SearchBox display if no API Key (functionality will be limited) */}\n               <SearchBox \n                 onPickupChange={handlePickupChange} \n                 onDropoffChange={handleDropoffChange}\n                 className={isSidebarOpen ? 'translate-x-[320px]' : ''}\n                 externalPickupCoords={pickupCoords}\n                 externalDropoffCoords={dropoffCoords}\n               />\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}