{"version":3,"sources":["../../../../../../Desktop/pincher/app/test-map/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { APIProvider, Map } from '@vis.gl/react-google-maps';\n\nexport default function TestMapPage() {\n  const [status, setStatus] = useState<string>('初始化中...');\n  const [apiKey, setApiKey] = useState<string>('');\n  const [testResults, setTestResults] = useState<{\n    apiKeyExists: boolean;\n    mapsLoaded: boolean;\n    placesLoaded: boolean;\n    geocodingWorks: boolean;\n  }>({\n    apiKeyExists: false,\n    mapsLoaded: false,\n    placesLoaded: false,\n    geocodingWorks: false,\n  });\n\n  useEffect(() => {\n    // Check API Key\n    const key = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || '';\n    setApiKey(key);\n\n    if (!key) {\n      setStatus('❌ 找不到 API Key');\n      return;\n    }\n\n    setTestResults(prev => ({ ...prev, apiKeyExists: true }));\n    setStatus('✅ API Key 已配置');\n\n    // Check if Google Maps loads\n    const checkInterval = setInterval(() => {\n      if (window.google && window.google.maps) {\n        setTestResults(prev => ({ ...prev, mapsLoaded: true }));\n        setStatus('✅ Google Maps API 已加載');\n\n        if (window.google.maps.places) {\n          setTestResults(prev => ({ ...prev, placesLoaded: true }));\n          setStatus('✅ Places API 已加載');\n        }\n\n        clearInterval(checkInterval);\n      }\n    }, 500);\n\n    return () => clearInterval(checkInterval);\n  }, []);\n\n  // Test geocoding\n  const testGeocoding = async () => {\n    if (!window.google || !window.google.maps) {\n      alert('Google Maps 還沒加載完成');\n      return;\n    }\n\n    try {\n      const geocoder = new google.maps.Geocoder();\n      const result = await geocoder.geocode({ address: 'UCI' });\n\n      console.log('Geocoding result:', result);\n\n      // Check for errors\n      if (!result) {\n        alert('❌ Geocoding API 沒有返回任何結果\\n可能原因：Geocoding API 未啟用');\n        return;\n      }\n\n      if (result.results && result.results.length > 0) {\n        setTestResults(prev => ({ ...prev, geocodingWorks: true }));\n        alert(`✅ Geocoding 測試成功！\\n找到地址：${result.results[0].formatted_address}`);\n      } else {\n        alert(`❌ Geocoding 失敗\\n狀態：${JSON.stringify(result)}`);\n      }\n    } catch (error: any) {\n      console.error('Geocoding error:', error);\n      alert(`❌ Geocoding 錯誤：\\n${error.message}\\n\\n請檢查：\\n1. Geocoding API 是否已啟用\\n2. API Key 限制是否正確配置`);\n    }\n  };\n\n  const center = { lat: 33.6846, lng: -117.8265 };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-md p-6\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-4\">\n          🧪 Google Maps API 測試頁面\n        </h1>\n\n        {/* Status */}\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center gap-3\">\n            <span className=\"text-2xl\">{testResults.apiKeyExists ? '✅' : '⏳'}</span>\n            <div>\n              <p className=\"font-semibold\">API Key 配置</p>\n              <p className=\"text-sm text-gray-600 font-mono\">\n                {apiKey ? `${apiKey.substring(0, 20)}...` : '未找到'}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            <span className=\"text-2xl\">{testResults.mapsLoaded ? '✅' : '⏳'}</span>\n            <div>\n              <p className=\"font-semibold\">Maps JavaScript API</p>\n              <p className=\"text-sm text-gray-600\">\n                {testResults.mapsLoaded ? '已加載' : '加載中...'}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            <span className=\"text-2xl\">{testResults.placesLoaded ? '✅' : '⏳'}</span>\n            <div>\n              <p className=\"font-semibold\">Places API</p>\n              <p className=\"text-sm text-gray-600\">\n                {testResults.placesLoaded ? '已加載' : '加載中...'}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            <span className=\"text-2xl\">{testResults.geocodingWorks ? '✅' : '⏹️'}</span>\n            <div className=\"flex-1\">\n              <p className=\"font-semibold\">Geocoding API</p>\n              <button\n                onClick={testGeocoding}\n                disabled={!testResults.mapsLoaded}\n                className=\"mt-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed\"\n              >\n                測試 Geocoding\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Current Status */}\n        <div className=\"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <p className=\"text-sm font-medium text-blue-900\">\n            當前狀態：{status}\n          </p>\n        </div>\n      </div>\n\n      {/* Map Test */}\n      <div className=\"p-6\">\n        <h2 className=\"text-2xl font-bold mb-4\">地圖顯示測試</h2>\n        <div className=\"bg-white rounded-lg shadow-lg overflow-hidden\" style={{ height: '500px' }}>\n          {apiKey ? (\n            <APIProvider apiKey={apiKey}>\n              <Map\n                defaultCenter={center}\n                defaultZoom={11}\n                gestureHandling=\"greedy\"\n                disableDefaultUI={false}\n              />\n            </APIProvider>\n          ) : (\n            <div className=\"flex items-center justify-center h-full bg-gray-100\">\n              <div className=\"text-center\">\n                <p className=\"text-xl font-bold text-gray-800 mb-2\">\n                  ❌ 找不到 API Key\n                </p>\n                <p className=\"text-sm text-gray-600\">\n                  請檢查 .env 文件中的 NEXT_PUBLIC_GOOGLE_MAPS_API_KEY\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Instructions */}\n      <div className=\"p-6\">\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-6\">\n          <h3 className=\"text-lg font-bold text-yellow-900 mb-3\">\n            📋 如何判斷結果\n          </h3>\n          <ul className=\"space-y-2 text-sm text-yellow-800\">\n            <li>✅ <strong>全部打勾</strong> → Google Maps 配置正確，可以使用！</li>\n            <li>⏳ <strong>Maps/Places 一直加載中</strong> → API 可能沒啟用，或 HTTP referrer 有問題</li>\n            <li>❌ <strong>看不到地圖</strong> → 打開瀏覽器控制台（F12）查看錯誤信息</li>\n            <li>🗺️ <strong>看到地圖和紅色標記</strong> → 地圖功能正常！</li>\n          </ul>\n        </div>\n\n        {/* Console Errors */}\n        <div className=\"mt-6 bg-red-50 border border-red-200 rounded-lg p-6\">\n          <h3 className=\"text-lg font-bold text-red-900 mb-3\">\n            🐛 如果看到錯誤\n          </h3>\n          <p className=\"text-sm text-red-800 mb-3\">\n            打開瀏覽器控制台（按 F12），複製所有 Google Maps 相關的錯誤給我。\n          </p>\n          <p className=\"text-sm text-red-800\">\n            常見錯誤：<br />\n            • <code className=\"bg-red-100 px-1\">RefererNotAllowedMapError</code> → 需要添加 localhost 到 HTTP referrers<br />\n            • <code className=\"bg-red-100 px-1\">ApiNotActivatedMapError</code> → 需要啟用對應的 API<br />\n            • <code className=\"bg-red-100 px-1\">InvalidKeyMapError</code> → API Key 無效\n          </p>\n        </div>\n      </div>\n\n      {/* Back Link */}\n      <div className=\"p-6\">\n        <a\n          href=\"/uber\"\n          className=\"inline-block px-6 py-3 bg-gray-800 text-white rounded-lg font-medium hover:bg-gray-700\"\n        >\n          ← 返回主應用\n        </a>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}