module.exports=[846083,(a,b,c)=>{b.exports=a.x("pino-9074cb0be45f9371",()=>require("pino-9074cb0be45f9371"))},380218,a=>{"use strict";var b=a.i(846083);a.s(["pino",()=>b.default])},285182,a=>{"use strict";var b=a.i(686775),c=a.i(618740),d=a.i(572373),e=a.i(400620);let f=(0,b.proxy)({message:"",variant:"info",open:!1}),g=(0,d.withErrorBoundary)({state:f,subscribeKey:(a,b)=>(0,c.subscribeKey)(f,a,b),open(a,b){let{debug:c}=e.OptionsController.state,{code:d,displayMessage:g,debugMessage:h}=a;g&&c&&(f.message=g,f.variant=b,f.open=!0),h&&console.error("function"==typeof h?h():h,d?{code:d}:void 0)},warn(a,b,c){f.open=!0,f.message=a,f.variant="warning",b&&console.warn(b,c)},close(){f.open=!1,f.message="",f.variant="info"}});a.s(["AlertController",0,g])},678766,a=>{"use strict";var b=a.i(846083),c=a.i(911704);let d="custom_context";class e{constructor(a){this.nodeValue=a,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class f{constructor(a){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=a,this.sizeInBytes=0}append(a){let b=new e(a);if(b.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${a} with size ${b.size}`);for(;this.size+b.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=b):this.head=b,this.tail=b,this.lengthInNodes++,this.sizeInBytes+=b.size}shift(){if(!this.head)return;let a=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=a.size}toArray(){let a=[],b=this.head;for(;null!==b;)a.push(b.value),b=b.next;return a}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let a=this.head;return{next:()=>{if(!a)return{done:!0,value:null};let b=a.value;return a=a.next,{done:!1,value:b}}}}}class g{constructor(a,c=1024e3){this.level=a??"error",this.levelValue=b.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=c,this.logs=new f(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(a,c){c===b.levels.values.error?console.error(a):c===b.levels.values.warn?console.warn(a):c===b.levels.values.debug?console.debug(a):c===b.levels.values.trace?console.trace(a):console.log(a)}appendToLogs(a){this.logs.append((0,c.safeJsonStringify)({timestamp:new Date().toISOString(),log:a}));let b="string"==typeof a?JSON.parse(a).level:a.level;b>=this.levelValue&&this.forwardToConsole(a,b)}getLogs(){return this.logs}clearLogs(){this.logs=new f(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(a){let b=this.getLogArray();return b.push((0,c.safeJsonStringify)({extraMetadata:a})),new Blob(b,{type:"application/json"})}}class h{constructor(a,b=1024e3){this.baseChunkLogger=new g(a,b)}write(a){this.baseChunkLogger.appendToLogs(a)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(a){return this.baseChunkLogger.logsToBlob(a)}}var i=Object.defineProperty,j=Object.defineProperties,k=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(a,b,c)=>b in a?i(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,p=(a,b)=>{for(var c in b||(b={}))m.call(b,c)&&o(a,c,b[c]);if(l)for(var c of l(b))n.call(b,c)&&o(a,c,b[c]);return a};function q(a){return j(p({},a),k({level:a?.level||"info"}))}function r(a,b=d){return typeof a.bindings>"u"?function(a,b=d){return a[b]||""}(a,b):a.bindings().context||""}function s(a,b,c=d){let e=function(a,b,c=d){let e=r(a,c);return e.trim()?`${e}/${b}`:b}(a,b,c);return function(a,b,c=d){return a[c]=b,a}(a.child({context:e}),e,c)}function t(a){var c;let d;return"u">typeof a.loggerOverride&&"string"!=typeof a.loggerOverride?{logger:a.loggerOverride,chunkLoggerController:null}:(d=new h(null==(c=a.opts)?void 0:c.level,a.maxSizeInBytes),{logger:(0,b.default)(j(p({},a.opts),k({level:"trace"})),d),chunkLoggerController:d})}a.s(["generateChildLogger",()=>s,"generatePlatformLogger",()=>t,"getDefaultLoggerOptions",()=>q,"getLoggerContext",()=>r])},120975,a=>{"use strict";let b,c,d,e,f;var g,h,i,j,k=a.i(427699);a.i(822238),a.i(697984),a.i(678766),a.i(380218),a.i(673975);var l=a.i(581332),m=Object.defineProperty;l.IEvents;l.IEvents,l.IEvents,l.IEvents,l.IEvents,l.IEvents,k.default,k.EventEmitter;var n=a.i(135037);a.i(911704),a.i(526629),a.i(851896),a.i(163848),a.i(716134),a.i(272392),a.i(275730),a.i(553635),a.i(541597),a.i(59345),a.i(875596),a.i(301704),a.i(840818),a.i(442468),a.i(364547),a.i(89941),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let o=BigInt(0x100000000-1),p=BigInt(32);function q(a,b=!1){return b?{h:Number(a&o),l:Number(a>>p&o)}:{h:0|Number(a>>p&o),l:0|Number(a&o)}}function r(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let f=0;f<c;f++){let{h:c,l:g}=q(a[f],b);[d[f],e[f]]=[c,g]}return[d,e]}let s=(a,b,c)=>a>>>c,t=(a,b,c)=>a<<32-c|b>>>c,u=(a,b,c)=>a>>>c|b<<32-c,v=(a,b,c)=>a<<32-c|b>>>c,w=(a,b,c)=>a<<64-c|b>>>c-32,x=(a,b,c)=>a>>>c-32|b<<64-c;function y(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}let z=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0),A=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0,B=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0),C=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0,D=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0),E=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0,F="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function G(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function H(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function I(a,...b){if(!G(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function J(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.createHasher");H(a.outputLen),H(a.blockLen)}function K(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function L(a,b){I(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function M(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function N(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}function O(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function P(a,b){return a<<32-b|a>>>b}let Q=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function R(a){return a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255}let S=Q?a=>a:a=>R(a),T=Q?a=>a:function(a){for(let b=0;b<a.length;b++)a[b]=R(a[b]);return a},U="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,V=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function W(a){if(I(a),U)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=V[a[c]];return b}function X(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:void 0}function Y(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(U)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=X(a.charCodeAt(e)),f=X(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function Z(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}function $(a){return"string"==typeof a&&(a=Z(a)),I(a),a}function _(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];I(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}class aa{}function ab(a){let b=b=>a().update($(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function ac(a=32){if(F&&"function"==typeof F.getRandomValues)return F.getRandomValues(new Uint8Array(a));if(F&&"function"==typeof F.randomBytes)return Uint8Array.from(F.randomBytes(a));throw Error("crypto.getRandomValues must be defined")}let ad=BigInt(0),ae=BigInt(1),af=BigInt(2),ag=BigInt(7),ah=BigInt(256),ai=BigInt(113),aj=[],ak=[],al=[];for(let a=0,b=ae,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],aj.push(2*(5*d+c)),ak.push((a+1)*(a+2)/2%64);let e=ad;for(let a=0;a<7;a++)(b=(b<<ae^(b>>ag)*ai)%ah)&af&&(e^=ae<<(ae<<BigInt(a))-ae);al.push(e)}let am=r(al,!0),an=am[0],ao=am[1],ap=(a,b,c)=>c>32?b<<c-32|a>>>64-c:a<<c|b>>>32-c,aq=(a,b,c)=>c>32?a<<c-32|b>>>64-c:b<<c|a>>>32-c;class ar extends aa{constructor(a,b,c,d=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,H(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=M(this.state)}clone(){return this._cloneInto()}keccak(){T(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=ap(f,g,1)^c[d],i=aq(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=ak[c],f=ap(b,e,d),g=aq(b,e,d),h=aj[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=an[d],a[1]^=ao[d]}N(c)}(this.state32,this.rounds),T(this.state32),this.posOut=0,this.pos=0}update(a){K(this),I(a=$(a));let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){K(this,!1),I(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return H(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(L(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,N(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new ar(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}ab(()=>new ar(136,1,32));class as extends aa{constructor(a,b,c,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.buffer=new Uint8Array(a),this.view=O(this.buffer)}update(a){K(this),I(a=$(a));let{view:b,buffer:c,blockLen:d}=this,e=a.length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=O(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){K(this),L(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:f}=this;b[f++]=128,N(this.buffer.subarray(f)),this.padOffset>d-f&&(this.process(c,0),f=0);for(let a=f;a<d;a++)b[a]=0;(function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)})(c,d-8,BigInt(8*this.length),e),this.process(c,0);let g=O(a),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let i=h/4,j=this.get();if(i>j.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<i;a++)g.setUint32(4*a,j[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.destroyed=f,a.finished=e,a.length=d,a.pos=g,d%b&&a.buffer.set(c),a}clone(){return this._cloneInto()}}let at=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),au=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),av=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),aw=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),ax=new Uint32Array(64);class ay extends as{constructor(a=32){super(64,a,8,!1),this.A=0|at[0],this.B=0|at[1],this.C=0|at[2],this.D=0|at[3],this.E=0|at[4],this.F=0|at[5],this.G=0|at[6],this.H=0|at[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)ax[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=ax[a-15],c=ax[a-2],d=P(b,7)^P(b,18)^b>>>3,e=P(c,17)^P(c,19)^c>>>10;ax[a]=e+ax[a-7]+d+ax[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){var k,l,m,n;let b=j+(P(g,6)^P(g,11)^P(g,25))+((k=g)&h^~k&i)+aw[a]+ax[a]|0,o=(P(c,2)^P(c,13)^P(c,22))+((l=c)&(m=d)^l&(n=e)^m&n)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+o|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){N(ax)}destroy(){this.set(0,0,0,0,0,0,0,0),N(this.buffer)}}let az=r(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),aA=az[0],aB=az[1],aC=new Uint32Array(80),aD=new Uint32Array(80);class aE extends as{constructor(a=64){super(128,a,16,!1),this.Ah=0|av[0],this.Al=0|av[1],this.Bh=0|av[2],this.Bl=0|av[3],this.Ch=0|av[4],this.Cl=0|av[5],this.Dh=0|av[6],this.Dl=0|av[7],this.Eh=0|av[8],this.El=0|av[9],this.Fh=0|av[10],this.Fl=0|av[11],this.Gh=0|av[12],this.Gl=0|av[13],this.Hh=0|av[14],this.Hl=0|av[15]}get(){let{Ah:a,Al:b,Bh:c,Bl:d,Ch:e,Cl:f,Dh:g,Dl:h,Eh:i,El:j,Fh:k,Fl:l,Gh:m,Gl:n,Hh:o,Hl:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.Ah=0|a,this.Al=0|b,this.Bh=0|c,this.Bl=0|d,this.Ch=0|e,this.Cl=0|f,this.Dh=0|g,this.Dl=0|h,this.Eh=0|i,this.El=0|j,this.Fh=0|k,this.Fl=0|l,this.Gh=0|m,this.Gl=0|n,this.Hh=0|o,this.Hl=0|p}process(a,b){for(let c=0;c<16;c++,b+=4)aC[c]=a.getUint32(b),aD[c]=a.getUint32(b+=4);for(let a=16;a<80;a++){let b=0|aC[a-15],c=0|aD[a-15],d=u(b,c,1)^u(b,c,8)^s(b,c,7),e=v(b,c,1)^v(b,c,8)^t(b,c,7),f=0|aC[a-2],g=0|aD[a-2],h=u(f,g,19)^w(f,g,61)^s(f,g,6),i=B(e,v(f,g,19)^x(f,g,61)^t(f,g,6),aD[a-7],aD[a-16]),j=C(i,d,h,aC[a-7],aC[a-16]);aC[a]=0|j,aD[a]=0|i}let{Ah:c,Al:d,Bh:e,Bl:f,Ch:g,Cl:h,Dh:i,Dl:j,Eh:k,El:l,Fh:m,Fl:n,Gh:o,Gl:p,Hh:q,Hl:r}=this;for(let a=0;a<80;a++){let b=u(k,l,14)^u(k,l,18)^w(k,l,41),s=v(k,l,14)^v(k,l,18)^x(k,l,41),t=k&m^~k&o,B=D(r,s,l&n^~l&p,aB[a],aD[a]),C=E(B,q,b,t,aA[a],aC[a]),F=0|B,G=u(c,d,28)^w(c,d,34)^w(c,d,39),H=v(c,d,28)^x(c,d,34)^x(c,d,39),I=c&e^c&g^e&g,J=d&f^d&h^f&h;q=0|o,r=0|p,o=0|m,p=0|n,m=0|k,n=0|l,({h:k,l:l}=y(0|i,0|j,0|C,0|F)),i=0|g,j=0|h,g=0|e,h=0|f,e=0|c,f=0|d;let K=z(F,H,J);c=A(K,C,G,I),d=0|K}({h:c,l:d}=y(0|this.Ah,0|this.Al,0|c,0|d)),({h:e,l:f}=y(0|this.Bh,0|this.Bl,0|e,0|f)),({h:g,l:h}=y(0|this.Ch,0|this.Cl,0|g,0|h)),({h:i,l:j}=y(0|this.Dh,0|this.Dl,0|i,0|j)),({h:k,l:l}=y(0|this.Eh,0|this.El,0|k,0|l)),({h:m,l:n}=y(0|this.Fh,0|this.Fl,0|m,0|n)),({h:o,l:p}=y(0|this.Gh,0|this.Gl,0|o,0|p)),({h:q,l:r}=y(0|this.Hh,0|this.Hl,0|q,0|r)),this.set(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r)}roundClean(){N(aC,aD)}destroy(){N(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class aF extends aE{constructor(){super(48),this.Ah=0|au[0],this.Al=0|au[1],this.Bh=0|au[2],this.Bl=0|au[3],this.Ch=0|au[4],this.Cl=0|au[5],this.Dh=0|au[6],this.Dl=0|au[7],this.Eh=0|au[8],this.El=0|au[9],this.Fh=0|au[10],this.Fl=0|au[11],this.Gh=0|au[12],this.Gl=0|au[13],this.Hh=0|au[14],this.Hl=0|au[15]}}let aG=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class aH extends aE{constructor(){super(32),this.Ah=0|aG[0],this.Al=0|aG[1],this.Bh=0|aG[2],this.Bl=0|aG[3],this.Ch=0|aG[4],this.Cl=0|aG[5],this.Dh=0|aG[6],this.Dl=0|aG[7],this.Eh=0|aG[8],this.El=0|aG[9],this.Fh=0|aG[10],this.Fl=0|aG[11],this.Gh=0|aG[12],this.Gl=0|aG[13],this.Hh=0|aG[14],this.Hl=0|aG[15]}}let aI=ab(()=>new ay),aJ=ab(()=>new aE),aK=ab(()=>new aF),aL=(ab(()=>new aH),Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9])),aM=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),aN=new Uint32Array(32);function aO(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=aN[2*a],j=aN[2*a+1],k=aN[2*b],l=aN[2*b+1],m=aN[2*c],n=aN[2*c+1],o=aN[2*d],p=aN[2*d+1],q=z(i,k,g);j=A(q,j,l,h),i=0|q,({Dh:p,Dl:o}={Dh:p^j,Dl:o^i}),({Dh:p,Dl:o}={Dh:o,Dl:p}),({h:n,l:m}=y(n,m,p,o)),({Bh:l,Bl:k}={Bh:l^n,Bl:k^m}),({Bh:l,Bl:k}={Bh:u(l,k,24),Bl:v(l,k,24)}),aN[2*a]=i,aN[2*a+1]=j,aN[2*b]=k,aN[2*b+1]=l,aN[2*c]=m,aN[2*c+1]=n,aN[2*d]=o,aN[2*d+1]=p}function aP(a,b,c,d,e,f){let g=e[f],h=e[f+1],i=aN[2*a],j=aN[2*a+1],k=aN[2*b],l=aN[2*b+1],m=aN[2*c],n=aN[2*c+1],o=aN[2*d],p=aN[2*d+1],q=z(i,k,g);j=A(q,j,l,h),i=0|q,({Dh:p,Dl:o}={Dh:p^j,Dl:o^i}),({Dh:p,Dl:o}={Dh:u(p,o,16),Dl:v(p,o,16)}),({h:n,l:m}=y(n,m,p,o)),({Bh:l,Bl:k}={Bh:l^n,Bl:k^m}),({Bh:l,Bl:k}={Bh:w(l,k,63),Bl:x(l,k,63)}),aN[2*a]=i,aN[2*a+1]=j,aN[2*b]=k,aN[2*b+1]=l,aN[2*c]=m,aN[2*c+1]=n,aN[2*d]=o,aN[2*d+1]=p}class aQ extends aa{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,H(a),H(b),this.blockLen=a,this.outputLen=b,this.buffer=new Uint8Array(a),this.buffer32=M(this.buffer)}update(a){K(this),I(a=$(a));let{blockLen:b,buffer:c,buffer32:d}=this,e=a.length,f=a.byteOffset,g=a.buffer;for(let h=0;h<e;){this.pos===b&&(T(d),this.compress(d,0,!1),T(d),this.pos=0);let i=Math.min(b-this.pos,e-h),j=f+h;if(i===b&&!(j%4)&&h+i<e){let a=new Uint32Array(g,j,Math.floor((e-h)/4));T(a);for(let c=0;h+b<e;c+=d.length,h+=b)this.length+=b,this.compress(a,c,!1);T(a);continue}c.set(a.subarray(h,h+i),this.pos),this.pos+=i,this.length+=i,h+=i}return this}digestInto(a){K(this),L(a,this);let{pos:b,buffer32:c}=this;this.finished=!0,N(this.buffer.subarray(b)),T(c),this.compress(c,0,!0),T(c);let d=M(a);this.get().forEach((a,b)=>d[b]=S(a))}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){let{buffer:b,length:c,finished:d,destroyed:e,outputLen:f,pos:g}=this;return a||(a=new this.constructor({dkLen:f})),a.set(...this.get()),a.buffer.set(b),a.destroyed=e,a.finished=d,a.length=c,a.pos=g,a.outputLen=f,a}clone(){return this._cloneInto()}}class aR extends aQ{constructor(a={}){const b=void 0===a.dkLen?64:a.dkLen;super(128,b),this.v0l=0|aM[0],this.v0h=0|aM[1],this.v1l=0|aM[2],this.v1h=0|aM[3],this.v2l=0|aM[4],this.v2h=0|aM[5],this.v3l=0|aM[6],this.v3h=0|aM[7],this.v4l=0|aM[8],this.v4h=0|aM[9],this.v5l=0|aM[10],this.v5h=0|aM[11],this.v6l=0|aM[12],this.v6h=0|aM[13],this.v7l=0|aM[14],this.v7h=0|aM[15],function(a,b={},c,d,e){if(H(64),a<0||a>64)throw Error("outputLen bigger than keyLen");let{key:f,salt:g,personalization:h}=b;if(void 0!==f&&(f.length<1||f.length>64))throw Error("key length must be undefined or 1..64");if(void 0!==g&&16!==g.length)throw Error("salt must be undefined or 16");if(void 0!==h&&16!==h.length)throw Error("personalization must be undefined or 16")}(b,a,0,0,0);let{key:c,personalization:d,salt:e}=a,f=0;if(void 0!==c&&(f=(c=$(c)).length),this.v0l^=this.outputLen|f<<8|0x1010000,void 0!==e){const a=M(e=$(e));this.v4l^=S(a[0]),this.v4h^=S(a[1]),this.v5l^=S(a[2]),this.v5h^=S(a[3])}if(void 0!==d){const a=M(d=$(d));this.v6l^=S(a[0]),this.v6h^=S(a[1]),this.v7l^=S(a[2]),this.v7h^=S(a[3])}if(void 0!==c){const a=new Uint8Array(this.blockLen);a.set(c),this.update(a)}}get(){let{v0l:a,v0h:b,v1l:c,v1h:d,v2l:e,v2h:f,v3l:g,v3h:h,v4l:i,v4h:j,v5l:k,v5h:l,v6l:m,v6h:n,v7l:o,v7h:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.v0l=0|a,this.v0h=0|b,this.v1l=0|c,this.v1h=0|d,this.v2l=0|e,this.v2h=0|f,this.v3l=0|g,this.v3h=0|h,this.v4l=0|i,this.v4h=0|j,this.v5l=0|k,this.v5h=0|l,this.v6l=0|m,this.v6h=0|n,this.v7l=0|o,this.v7h=0|p}compress(a,b,c){this.get().forEach((a,b)=>aN[b]=a),aN.set(aM,16);let{h:d,l:e}=q(BigInt(this.length));aN[24]=aM[8]^e,aN[25]=aM[9]^d,c&&(aN[28]=~aN[28],aN[29]=~aN[29]);let f=0;for(let c=0;c<12;c++)aO(0,4,8,12,a,b+2*aL[f++]),aP(0,4,8,12,a,b+2*aL[f++]),aO(1,5,9,13,a,b+2*aL[f++]),aP(1,5,9,13,a,b+2*aL[f++]),aO(2,6,10,14,a,b+2*aL[f++]),aP(2,6,10,14,a,b+2*aL[f++]),aO(3,7,11,15,a,b+2*aL[f++]),aP(3,7,11,15,a,b+2*aL[f++]),aO(0,5,10,15,a,b+2*aL[f++]),aP(0,5,10,15,a,b+2*aL[f++]),aO(1,6,11,12,a,b+2*aL[f++]),aP(1,6,11,12,a,b+2*aL[f++]),aO(2,7,8,13,a,b+2*aL[f++]),aP(2,7,8,13,a,b+2*aL[f++]),aO(3,4,9,14,a,b+2*aL[f++]),aP(3,4,9,14,a,b+2*aL[f++]);this.v0l^=aN[0]^aN[16],this.v0h^=aN[1]^aN[17],this.v1l^=aN[2]^aN[18],this.v1h^=aN[3]^aN[19],this.v2l^=aN[4]^aN[20],this.v2h^=aN[5]^aN[21],this.v3l^=aN[6]^aN[22],this.v3h^=aN[7]^aN[23],this.v4l^=aN[8]^aN[24],this.v4h^=aN[9]^aN[25],this.v5l^=aN[10]^aN[26],this.v5h^=aN[11]^aN[27],this.v6l^=aN[12]^aN[28],this.v6h^=aN[13]^aN[29],this.v7l^=aN[14]^aN[30],this.v7h^=aN[15]^aN[31],N(aN)}destroy(){this.destroyed=!0,N(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}function aS(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function aT(a){if("boolean"!=typeof a)throw Error(`boolean expected, not ${a}`)}function aU(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function aV(a,...b){if(!aS(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function aW(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function aX(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function aY(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}i=a=>new aR(a),(b=(a,b)=>i(b).update($(a)).digest()).outputLen=(c=i({})).outputLen,b.blockLen=c.blockLen,b.create=a=>i(a),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let aZ=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function a$(a){if("string"==typeof a)a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a);else if(aS(a))a=a1(a);else throw Error("Uint8Array expected, got "+typeof a);return a}function a_(a,b,c=!0){if(void 0===b)return new Uint8Array(a);if(b.length!==a)throw Error("invalid output length, expected "+a+", got: "+b.length);if(c&&b.byteOffset%4!=0)throw Error("invalid output, must be aligned");return b}function a0(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}function a1(a){return Uint8Array.from(a)}let a2=a=>Uint8Array.from(a.split("").map(a=>a.charCodeAt(0))),a3=a2("expand 16-byte k"),a4=a2("expand 32-byte k"),a5=aX(a3),a6=aX(a4);function a7(a,b){return a<<b|a>>>32-b}function a8(a){return a.byteOffset%4==0}let a9=0x100000000-1,ba=new Uint32Array,bb=(a,b)=>255&a[b++]|(255&a[b++])<<8;class bc{constructor(a){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,aV(a=a$(a),32);const b=bb(a,0),c=bb(a,2),d=bb(a,4),e=bb(a,6),f=bb(a,8),g=bb(a,10),h=bb(a,12),i=bb(a,14);this.r[0]=8191&b,this.r[1]=(b>>>13|c<<3)&8191,this.r[2]=(c>>>10|d<<6)&7939,this.r[3]=(d>>>7|e<<9)&8191,this.r[4]=(e>>>4|f<<12)&255,this.r[5]=f>>>1&8190,this.r[6]=(f>>>14|g<<2)&8191,this.r[7]=(g>>>11|h<<5)&8065,this.r[8]=(h>>>8|i<<8)&8191,this.r[9]=i>>>5&127;for(let b=0;b<8;b++)this.pad[b]=bb(a,16+2*b)}process(a,b,c=!1){let{h:d,r:e}=this,f=e[0],g=e[1],h=e[2],i=e[3],j=e[4],k=e[5],l=e[6],m=e[7],n=e[8],o=e[9],p=bb(a,b+0),q=bb(a,b+2),r=bb(a,b+4),s=bb(a,b+6),t=bb(a,b+8),u=bb(a,b+10),v=bb(a,b+12),w=bb(a,b+14),x=d[0]+(8191&p),y=d[1]+((p>>>13|q<<3)&8191),z=d[2]+((q>>>10|r<<6)&8191),A=d[3]+((r>>>7|s<<9)&8191),B=d[4]+((s>>>4|t<<12)&8191),C=d[5]+(t>>>1&8191),D=d[6]+((t>>>14|u<<2)&8191),E=d[7]+((u>>>11|v<<5)&8191),F=d[8]+((v>>>8|w<<8)&8191),G=d[9]+(w>>>5|2048*!c),H=0,I=0+x*f+5*o*y+5*n*z+5*m*A+5*l*B;H=I>>>13,I&=8191,I+=5*k*C+5*j*D+5*i*E+5*h*F+5*g*G,H+=I>>>13,I&=8191;let J=H+x*g+y*f+5*o*z+5*n*A+5*m*B;H=J>>>13,J&=8191,J+=5*l*C+5*k*D+5*j*E+5*i*F+5*h*G,H+=J>>>13,J&=8191;let K=H+x*h+y*g+z*f+5*o*A+5*n*B;H=K>>>13,K&=8191,K+=5*m*C+5*l*D+5*k*E+5*j*F+5*i*G,H+=K>>>13,K&=8191;let L=H+x*i+y*h+z*g+A*f+5*o*B;H=L>>>13,L&=8191,L+=5*n*C+5*m*D+5*l*E+5*k*F+5*j*G,H+=L>>>13,L&=8191;let M=H+x*j+y*i+z*h+A*g+B*f;H=M>>>13,M&=8191,M+=5*o*C+5*n*D+5*m*E+5*l*F+5*k*G,H+=M>>>13,M&=8191;let N=H+x*k+y*j+z*i+A*h+B*g;H=N>>>13,N&=8191,N+=C*f+5*o*D+5*n*E+5*m*F+5*l*G,H+=N>>>13,N&=8191;let O=H+x*l+y*k+z*j+A*i+B*h;H=O>>>13,O&=8191,O+=C*g+D*f+5*o*E+5*n*F+5*m*G,H+=O>>>13,O&=8191;let P=H+x*m+y*l+z*k+A*j+B*i;H=P>>>13,P&=8191,P+=C*h+D*g+E*f+5*o*F+5*n*G,H+=P>>>13,P&=8191;let Q=H+x*n+y*m+z*l+A*k+B*j;H=Q>>>13,Q&=8191,Q+=C*i+D*h+E*g+F*f+5*o*G,H+=Q>>>13,Q&=8191;let R=H+x*o+y*n+z*m+A*l+B*k;H=R>>>13,R&=8191,R+=C*j+D*i+E*h+F*g+G*f,H+=R>>>13,R&=8191,I=8191&(H=(H=(H<<2)+H|0)+I|0),H>>>=13,J+=H,d[0]=I,d[1]=J,d[2]=K,d[3]=L,d[4]=M,d[5]=N,d[6]=O,d[7]=P,d[8]=Q,d[9]=R}finalize(){let{h:a,pad:b}=this,c=new Uint16Array(10),d=a[1]>>>13;a[1]&=8191;for(let b=2;b<10;b++)a[b]+=d,d=a[b]>>>13,a[b]&=8191;a[0]+=5*d,d=a[0]>>>13,a[0]&=8191,a[1]+=d,d=a[1]>>>13,a[1]&=8191,a[2]+=d,c[0]=a[0]+5,d=c[0]>>>13,c[0]&=8191;for(let b=1;b<10;b++)c[b]=a[b]+d,d=c[b]>>>13,c[b]&=8191;c[9]-=8192;let e=(1^d)-1;for(let a=0;a<10;a++)c[a]&=e;e=~e;for(let b=0;b<10;b++)a[b]=a[b]&e|c[b];a[0]=(a[0]|a[1]<<13)&65535,a[1]=(a[1]>>>3|a[2]<<10)&65535,a[2]=(a[2]>>>6|a[3]<<7)&65535,a[3]=(a[3]>>>9|a[4]<<4)&65535,a[4]=(a[4]>>>12|a[5]<<1|a[6]<<14)&65535,a[5]=(a[6]>>>2|a[7]<<11)&65535,a[6]=(a[7]>>>5|a[8]<<8)&65535,a[7]=(a[8]>>>8|a[9]<<5)&65535;let f=a[0]+b[0];a[0]=65535&f;for(let c=1;c<8;c++)f=(a[c]+b[c]|0)+(f>>>16)|0,a[c]=65535&f;aY(c)}update(a){aW(this),aV(a=a$(a));let{buffer:b,blockLen:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(c-this.pos,d-e);if(f===c){for(;c<=d-e;e+=c)this.process(a,e);continue}b.set(a.subarray(e,e+f),this.pos),this.pos+=f,e+=f,this.pos===c&&(this.process(b,0,!1),this.pos=0)}return this}destroy(){aY(this.h,this.r,this.buffer,this.pad)}digestInto(a){aW(this),function(a,b){aV(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}(a,this),this.finished=!0;let{buffer:b,h:c}=this,{pos:d}=this;if(d){for(b[d++]=1;d<16;d++)b[d]=0;this.process(b,0,!0)}this.finalize();let e=0;for(let b=0;b<8;b++)a[e++]=c[b]>>>0,a[e++]=c[b]>>>8;return a}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}}let bd=(j=a=>new bc(a),(d=(a,b)=>j(b).update(a$(a)).digest()).outputLen=(e=j(new Uint8Array(32))).outputLen,d.blockLen=e.blockLen,d.create=a=>j(a),d),be=function(a,b){let{allowShortKeys:c,extendNonceFn:d,counterLength:e,counterRight:f,rounds:g}=function(a,b){if(null==b||"object"!=typeof b)throw Error("options must be defined");return Object.assign(a,b)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},b);if("function"!=typeof a)throw Error("core must be a function");return aU(e),aU(g),aT(f),aT(c),(b,h,i,j,k=0)=>{aV(b),aV(h),aV(i);let l=i.length;if(void 0===j&&(j=new Uint8Array(l)),aV(j),aU(k),k<0||k>=a9)throw Error("arx: counter overflow");if(j.length<l)throw Error(`arx: output (${j.length}) is shorter than data (${l})`);let m=[],n=b.length,o,p;if(32===n)m.push(o=a1(b)),p=a6;else if(16===n&&c)(o=new Uint8Array(32)).set(b),o.set(b,16),p=a5,m.push(o);else throw Error(`arx: invalid 32-byte key, got length=${n}`);a8(h)||m.push(h=a1(h));let q=aX(o);if(d){if(24!==h.length)throw Error("arx: extended nonce must be 24 bytes");d(p,q,aX(h.subarray(0,16)),q),h=h.subarray(16)}let r=16-e;if(r!==h.length)throw Error(`arx: nonce must be ${r} or 16 bytes`);if(12!==r){let a=new Uint8Array(12);a.set(h,f?0:12-h.length),h=a,m.push(h)}return function(a,b,c,d,e,f,g,h){let i=e.length,j=new Uint8Array(64),k=aX(j),l=a8(e)&&a8(f),m=l?aX(e):ba,n=l?aX(f):ba;for(let o=0;o<i;g++){if(a(b,c,d,k,g,h),g>=a9)throw Error("arx: counter overflow");let p=Math.min(64,i-o);if(l&&64===p){let a=o/4;if(o%4!=0)throw Error("arx: invalid block position");for(let b=0,c;b<16;b++)n[c=a+b]=m[c]^k[b];o+=64;continue}for(let a=0,b;a<p;a++)f[b=o+a]=e[b]^j[a];o+=p}}(a,p,q,aX(h),i,j,k,g),aY(...m),j}}(function(a,b,c,d,e,f=20){let g=a[0],h=a[1],i=a[2],j=a[3],k=b[0],l=b[1],m=b[2],n=b[3],o=b[4],p=b[5],q=b[6],r=b[7],s=c[0],t=c[1],u=c[2],v=g,w=h,x=i,y=j,z=k,A=l,B=m,C=n,D=o,E=p,F=q,G=r,H=e,I=s,J=t,K=u;for(let a=0;a<f;a+=2)D=D+(H=a7(H^(v=v+z|0),16))|0,v=v+(z=a7(z^D,12))|0,D=D+(H=a7(H^v,8))|0,z=a7(z^D,7),E=E+(I=a7(I^(w=w+A|0),16))|0,w=w+(A=a7(A^E,12))|0,E=E+(I=a7(I^w,8))|0,A=a7(A^E,7),F=F+(J=a7(J^(x=x+B|0),16))|0,x=x+(B=a7(B^F,12))|0,F=F+(J=a7(J^x,8))|0,B=a7(B^F,7),G=G+(K=a7(K^(y=y+C|0),16))|0,y=y+(C=a7(C^G,12))|0,G=G+(K=a7(K^y,8))|0,C=a7(C^G,7),F=F+(K=a7(K^(v=v+A|0),16))|0,v=v+(A=a7(A^F,12))|0,F=F+(K=a7(K^v,8))|0,A=a7(A^F,7),G=G+(H=a7(H^(w=w+B|0),16))|0,w=w+(B=a7(B^G,12))|0,G=G+(H=a7(H^w,8))|0,B=a7(B^G,7),D=D+(I=a7(I^(x=x+C|0),16))|0,x=x+(C=a7(C^D,12))|0,D=D+(I=a7(I^x,8))|0,C=a7(C^D,7),E=E+(J=a7(J^(y=y+z|0),16))|0,y=y+(z=a7(z^E,12))|0,E=E+(J=a7(J^y,8))|0,z=a7(z^E,7);let L=0;d[L++]=g+v|0,d[L++]=h+w|0,d[L++]=i+x|0,d[L++]=j+y|0,d[L++]=k+z|0,d[L++]=l+A|0,d[L++]=m+B|0,d[L++]=n+C|0,d[L++]=o+D|0,d[L++]=p+E|0,d[L++]=q+F|0,d[L++]=r+G|0,d[L++]=e+H|0,d[L++]=s+I|0,d[L++]=t+J|0,d[L++]=u+K|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),bf=new Uint8Array(16),bg=(a,b)=>{a.update(b);let c=b.length%16;c&&a.update(bf.subarray(c))},bh=new Uint8Array(32);function bi(a,b,c,d,e){var f,g;let h,i,j=a(b,c,bh),k=bd.create(j);e&&bg(k,e),bg(k,d);let l=(f=d.length,g=e?e.length:0,aT(!0),a0(i=new DataView((h=new Uint8Array(16)).buffer,h.byteOffset,h.byteLength),0,BigInt(g),!0),a0(i,8,BigInt(f),!0),h);k.update(l);let m=k.digest();return aY(j,l),m}g={blockSize:64,nonceLength:12,tagLength:16},h=(a,b,c)=>({encrypt(d,e){let f=d.length;(e=a_(f+16,e,!1)).set(d);let g=e.subarray(0,-16);be(a,b,g,g,1);let h=bi(be,a,b,g,c);return e.set(h,f),aY(h),e},decrypt(d,e){e=a_(d.length-16,e,!1);let f=d.subarray(0,-16),g=d.subarray(-16),h=bi(be,a,b,f,c);if(!function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c}(g,h))throw Error("invalid tag");return e.set(d.subarray(0,-16)),be(a,b,e,e,1),aY(h),e}}),Object.assign(function(a,...b){if(aV(a),!aZ)throw Error("Non little-endian hardware is not yet supported");if(void 0!==g.nonceLength){let a=b[0];if(!a)throw Error("nonce / iv required");g.varSizeNonce?aV(a):aV(a,g.nonceLength)}let c=g.tagLength;c&&void 0!==b[1]&&aV(b[1]);let d=h(a,...b),e=(a,b)=>{if(void 0!==b){if(2!==a)throw Error("cipher output not supported");aV(b)}},f=!1;return{encrypt(a,b){if(f)throw Error("cannot encrypt() twice with same key + nonce");return f=!0,aV(a),e(d.encrypt.length,b),d.encrypt(a,b)},decrypt(a,b){if(aV(a),c&&a.length<c)throw Error("invalid ciphertext length: smaller than tagLength="+c);return e(d.decrypt.length,b),d.decrypt(a,b)}}},g);class bj extends aa{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,J(a);const c=$(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const d=this.blockLen,e=new Uint8Array(d);e.set(c.length>d?a.create().update(c).digest():c);for(let a=0;a<e.length;a++)e[a]^=54;this.iHash.update(e),this.oHash=a.create();for(let a=0;a<e.length;a++)e[a]^=106;this.oHash.update(e),N(e)}update(a){return K(this),this.iHash.update(a),this}digestInto(a){K(this),I(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let bk=(a,b,c)=>new bj(a,b).update(c).digest();bk.create=(a,b)=>new bj(a,b),Uint8Array.from([0]),Uint8Array.of();let bl=BigInt(0),bm=BigInt(1);function bn(a,b=""){if("boolean"!=typeof a)throw Error((b&&`"${b}"`)+"expected boolean, got type="+typeof a);return a}function bo(a,b,c=""){let d=G(a),e=a?.length,f=void 0!==b;if(!d||f&&e!==b)throw Error((c&&`"${c}" `)+"expected Uint8Array"+(f?` of length ${b}`:"")+", got "+(d?`length=${e}`:`type=${typeof a}`));return a}function bp(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function bq(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?bl:BigInt("0x"+a)}function br(a){return I(a),bq(W(Uint8Array.from(a).reverse()))}function bs(a,b){return Y(a.toString(16).padStart(2*b,"0"))}function bt(a,b){return bs(a,b).reverse()}function bu(a,b,c){let d;if("string"==typeof b)try{d=Y(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(G(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}let bv=a=>"bigint"==typeof a&&bl<=a;function bw(a,b,c,d){if(!(bv(b)&&bv(c)&&bv(d))||!(c<=b)||!(b<d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}function bx(a){let b;for(b=0;a>bl;a>>=bm,b+=1);return b}let by=a=>(bm<<BigInt(a))-bm;function bz(a,b,c={}){if(!a||"object"!=typeof a)throw Error("expected valid options object");function d(b,c,d){let e=a[b];if(d&&void 0===e)return;let f=typeof e;if(f!==c||null===e)throw Error(`param "${b}" is invalid: expected ${c}, got ${f}`)}Object.entries(b).forEach(([a,b])=>d(a,b,!1)),Object.entries(c).forEach(([a,b])=>d(a,b,!0))}function bA(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let bB=BigInt(0),bC=BigInt(1),bD=BigInt(2),bE=BigInt(3),bF=BigInt(4),bG=BigInt(5),bH=BigInt(7),bI=BigInt(8),bJ=BigInt(9),bK=BigInt(16);function bL(a,b){let c=a%b;return c>=bB?c:b+c}function bM(a,b,c){let d=a;for(;b-- >bB;)d*=d,d%=c;return d}function bN(a,b){if(a===bB)throw Error("invert: expected non-zero number");if(b<=bB)throw Error("invert: expected positive modulus, got "+b);let c=bL(a,b),d=b,e=bB,f=bC;for(;c!==bB;){let a=d/c,b=d%c,g=e-f*a;d=c,c=b,e=f,f=g}if(d!==bC)throw Error("invert: does not exist");return bL(e,b)}function bO(a,b,c){if(!a.eql(a.sqr(b),c))throw Error("Cannot find square root")}function bP(a,b){let c=(a.ORDER+bC)/bF,d=a.pow(b,c);return bO(a,d,b),d}function bQ(a,b){let c=(a.ORDER-bG)/bI,d=a.mul(b,bD),e=a.pow(d,c),f=a.mul(b,e),g=a.mul(a.mul(f,bD),e),h=a.mul(f,a.sub(g,a.ONE));return bO(a,h,b),h}function bR(a){if(a<bE)throw Error("sqrt is not defined for small field");let b=a-bC,c=0;for(;b%bD===bB;)b/=bD,c++;let d=bD,e=bW(a);for(;1===bU(e,d);)if(d++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===c)return bP;let f=e.pow(d,b),g=(b+bC)/bD;return function(a,d){if(a.is0(d))return d;if(1!==bU(a,d))throw Error("Cannot find square root");let e=c,h=a.mul(a.ONE,f),i=a.pow(d,b),j=a.pow(d,g);for(;!a.eql(i,a.ONE);){if(a.is0(i))return a.ZERO;let b=1,c=a.sqr(i);for(;!a.eql(c,a.ONE);)if(b++,c=a.sqr(c),b===e)throw Error("Cannot find square root");let d=bC<<BigInt(e-b-1),f=a.pow(h,d);e=b,h=a.sqr(f),i=a.mul(i,h),j=a.mul(j,f)}return j}}let bS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function bT(a,b,c=!1){let d=Array(b.length).fill(c?a.ZERO:void 0),e=b.reduce((b,c,e)=>a.is0(c)?b:(d[e]=b,a.mul(b,c)),a.ONE),f=a.inv(e);return b.reduceRight((b,c,e)=>a.is0(c)?b:(d[e]=a.mul(b,d[e]),a.mul(b,c)),f),d}function bU(a,b){let c=(a.ORDER-bC)/bD,d=a.pow(b,c),e=a.eql(d,a.ONE),f=a.eql(d,a.ZERO),g=a.eql(d,a.neg(a.ONE));if(!e&&!f&&!g)throw Error("invalid Legendre symbol result");return e?1:f?0:-1}function bV(a,b){void 0!==b&&H(b);let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function bW(a,b,c=!1,d={}){let e;if(a<=bB)throw Error("invalid field: expected ORDER > 0, got "+a);let f,g,h=!1,i;if("object"==typeof b&&null!=b){if(d.sqrt||c)throw Error("cannot specify opts in two arguments");b.BITS&&(f=b.BITS),b.sqrt&&(g=b.sqrt),"boolean"==typeof b.isLE&&(c=b.isLE),"boolean"==typeof b.modFromBytes&&(h=b.modFromBytes),i=b.allowedLengths}else"number"==typeof b&&(f=b),d.sqrt&&(g=d.sqrt);let{nBitLength:j,nByteLength:k}=bV(a,f);if(k>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l=Object.freeze({ORDER:a,isLE:c,BITS:j,BYTES:k,MASK:by(j),ZERO:bB,ONE:bC,allowedLengths:i,create:b=>bL(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return bB<=b&&b<a},is0:a=>a===bB,isValidNot0:a=>!l.is0(a)&&l.isValid(a),isOdd:a=>(a&bC)===bC,neg:b=>bL(-b,a),eql:(a,b)=>a===b,sqr:b=>bL(b*b,a),add:(b,c)=>bL(b+c,a),sub:(b,c)=>bL(b-c,a),mul:(b,c)=>bL(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<bB)throw Error("invalid exponent, negatives unsupported");if(c===bB)return a.ONE;if(c===bC)return b;let d=a.ONE,e=b;for(;c>bB;)c&bC&&(d=a.mul(d,e)),e=a.sqr(e),c>>=bC;return d})(l,a,b),div:(b,c)=>bL(b*bN(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>bN(b,a),sqrt:g||(b=>{let c,d,f,g,h,i;return e||(e=a%bF===bE?bP:a%bI===bG?bQ:a%bK===bJ?(c=bW(a),f=(d=bR(a))(c,c.neg(c.ONE)),g=d(c,f),h=d(c,c.neg(f)),i=(a+bH)/bK,(a,b)=>{let c=a.pow(b,i),d=a.mul(c,f),e=a.mul(c,g),j=a.mul(c,h),k=a.eql(a.sqr(d),b),l=a.eql(a.sqr(e),b);c=a.cmov(c,d,k),d=a.cmov(j,e,l);let m=a.eql(a.sqr(d),b),n=a.cmov(c,d,m);return bO(a,n,b),n}):bR(a)),e(l,b)}),toBytes:a=>c?bt(a,k):bs(a,k),fromBytes:(b,d=!0)=>{if(i){if(!i.includes(b.length)||b.length>k)throw Error("Field.fromBytes: expected "+i+" bytes, got "+b.length);let a=new Uint8Array(k);a.set(b,c?0:a.length-b.length),b=a}if(b.length!==k)throw Error("Field.fromBytes: expected "+k+" bytes, got "+b.length);let e=c?br(b):bq(W(b));if(h&&(e=bL(e,a)),!d&&!l.isValid(e))throw Error("invalid field element: outside of range 0..ORDER");return e},invertBatch:a=>bT(l,a),cmov:(a,b,c)=>c?b:a});return Object.freeze(l)}function bX(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function bY(a){let b=bX(a);return b+Math.ceil(b/2)}let bZ=BigInt(0),b$=BigInt(1);function b_(a,b){let c=b.negate();return a?c:b}function b0(a,b){let c=bT(a.Fp,b.map(a=>a.Z));return b.map((b,d)=>a.fromAffine(b.toAffine(c[d])))}function b1(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function b2(a,b){b1(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),e=2**a;return{windows:c,windowSize:d,mask:by(a),maxNumber:e,shiftBy:BigInt(a)}}function b3(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:g}=c,h=Number(a&e),i=a>>g;h>d&&(h-=f,i+=b$);let j=b*d;return{nextN:i,offset:j+Math.abs(h)-1,isZero:0===h,isNeg:h<0,isNegF:b%2!=0,offsetF:j}}let b4=new WeakMap,b5=new WeakMap;function b6(a){return b5.get(a)||1}function b7(a){if(a!==bZ)throw Error("invalid wNAF")}class b8{constructor(a,b){this.BASE=a.BASE,this.ZERO=a.ZERO,this.Fn=a.Fn,this.bits=b}_unsafeLadder(a,b,c=this.ZERO){let d=a;for(;b>bZ;)b&b$&&(c=c.add(d)),d=d.double(),b>>=b$;return c}precomputeWindow(a,b){let{windows:c,windowSize:d}=b2(b,this.bits),e=[],f=a,g=f;for(let a=0;a<c;a++){g=f,e.push(g);for(let a=1;a<d;a++)g=g.add(f),e.push(g);f=g.double()}return e}wNAF(a,b,c){if(!this.Fn.isValid(c))throw Error("invalid scalar");let d=this.ZERO,e=this.BASE,f=b2(a,this.bits);for(let a=0;a<f.windows;a++){let{nextN:g,offset:h,isZero:i,isNeg:j,isNegF:k,offsetF:l}=b3(c,a,f);c=g,i?e=e.add(b_(k,b[l])):d=d.add(b_(j,b[h]))}return b7(c),{p:d,f:e}}wNAFUnsafe(a,b,c,d=this.ZERO){let e=b2(a,this.bits);for(let a=0;a<e.windows&&c!==bZ;a++){let{nextN:f,offset:g,isZero:h,isNeg:i}=b3(c,a,e);if(c=f,!h){let a=b[g];d=d.add(i?a.negate():a)}}return b7(c),d}getPrecomputes(a,b,c){let d=b4.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&("function"==typeof c&&(d=c(d)),b4.set(b,d))),d}cached(a,b,c){let d=b6(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)}unsafe(a,b,c,d){let e=b6(a);return 1===e?this._unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)}createCache(a,b){b1(b,this.bits),b5.set(a,b),b4.delete(a)}hasCache(a){return 1!==b6(a)}}function b9(a,b,c){if(!b)return bW(a,{isLE:c});if(b.ORDER!==a)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return bz(b,bS.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),b}BigInt(0),BigInt(1),BigInt(2),BigInt(8),Z("HashToScalar-");let ca=BigInt(0),cb=BigInt(1),cc=BigInt(2),cd=BigInt(1),ce=BigInt(2),cf=BigInt(3),cg=BigInt(5),ch=BigInt(8),ci=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),cj={p:ci,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:ch,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")},ck=(function(a){let{P:b,type:c,adjustScalarBytes:d,powPminus2:e,randomBytes:f}=(bz(a,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...a})),g="x25519"===c;if(!g&&"x448"!==c)throw Error("invalid type");let h=g?32:56,i=BigInt(g?9:5),j=BigInt(g?121665:39081),k=g?cc**BigInt(254):cc**BigInt(447),l=k+(g?BigInt(8)*cc**BigInt(251)-cb:BigInt(4)*cc**BigInt(445)-cb)+cb,m=a=>bL(a,b),n=bt(m(i),h);n.slice()}({P:f=bW(cj.p,{isLE:!0}).ORDER,type:"x25519",powPminus2:a=>{let b,c,d,e,g,h,i,j,k,l,m,n,o,p,{pow_p_5_8:q,b2:r}=(b=BigInt(10),c=BigInt(20),d=BigInt(40),e=BigInt(80),h=bM(g=a*a%ci*a%ci,ce,ci)*g%ci,i=bM(h,cd,ci)*a%ci,j=bM(i,cg,ci)*i%ci,k=bM(j,b,ci)*j%ci,l=bM(k,c,ci)*k%ci,m=bM(l,d,ci)*l%ci,n=bM(m,e,ci)*m%ci,o=bM(n,e,ci)*m%ci,p=bM(o,b,ci)*j%ci,{pow_p_5_8:bM(p,ce,ci)*a%ci,b2:g});return bL(bM(q,cf,f)*r,f)},adjustScalarBytes:function(a){return a[0]&=248,a[31]&=127,a[31]|=64,a}}),(a,b)=>(a+(a>=0?b:-b)/cq)/b);function cl(a){if(!["compact","recovered","der"].includes(a))throw Error('Signature format must be "compact", "recovered", or "der"');return a}function cm(a,b){let c={};for(let d of Object.keys(b))c[d]=void 0===a[d]?b[d]:a[d];return bn(c.lowS,"lowS"),bn(c.prehash,"prehash"),void 0!==c.format&&cl(c.format),c}let cn={Err:class extends Error{constructor(a=""){super(a)}},_tlv:{encode:(a,b)=>{let{Err:c}=cn;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=bp(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?bp(e.length/2|128):"";return bp(a)+f+e+b},decode(a,b){let{Err:c}=cn,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=cn;if(a<co)throw new b("integer: negative integers are not allowed");let c=bp(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=cn;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return bq(W(a))}},toSig(a){let{Err:b,_int:c,_tlv:d}=cn,e=bu("signature",a),{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=cn,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},co=BigInt(0),cp=BigInt(1),cq=BigInt(2),cr=BigInt(3),cs=BigInt(4);function ct(a,b){let c,{BYTES:d}=a;if("bigint"==typeof b)c=b;else{let e=bu("private key",b);try{c=a.fromBytes(e)}catch{throw Error(`invalid private key: expected ui8a of size ${d}, got ${typeof b}`)}}if(!a.isValidNot0(c))throw Error("invalid private key: out of range [1..N-1]");return c}function cu(a){return Uint8Array.of(a?2:3)}function cv(a,b){return{secretKey:b.BYTES,publicKey:1+a.BYTES,publicKeyUncompressed:1+2*a.BYTES,publicKeyHasPrefix:!0,signature:2*b.BYTES}}function cw(a,b){let c=b=>(function(a){let b,{CURVE:c,curveOpts:d,hash:e,ecdsaOpts:f}=function(a){let b,c,d,e,{CURVE:f,curveOpts:g}=(b={a:a.a,b:a.b,p:a.Fp.ORDER,n:a.n,h:a.h,Gx:a.Gx,Gy:a.Gy},c=a.Fp,d=a.allowedPrivateKeyLengths?Array.from(new Set(a.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,e={Fp:c,Fn:bW(b.n,{BITS:a.nBitLength,allowedLengths:d,modFromBytes:a.wrapPrivateKey}),allowInfinityPoint:a.allowInfinityPoint,endo:a.endo,isTorsionFree:a.isTorsionFree,clearCofactor:a.clearCofactor,fromBytes:a.fromBytes,toBytes:a.toBytes},{CURVE:b,curveOpts:e}),h={hmac:a.hmac,randomBytes:a.randomBytes,lowS:a.lowS,bits2int:a.bits2int,bits2int_modN:a.bits2int_modN};return{CURVE:f,curveOpts:g,hash:a.hash,ecdsaOpts:h}}(a),g=function(a,b,c={}){J(b),bz(c,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let d=c.randomBytes||ac,e=c.hmac||((a,...c)=>bk(b,a,_(...c))),{Fp:f,Fn:g}=a,{ORDER:h,BITS:i}=g,{keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:n}=function(a,b={}){let{Fn:c}=a,d=b.randomBytes||ac,e=Object.assign(cv(a.Fp,c),{seed:bY(c.ORDER)});function f(a){try{return!!ct(c,a)}catch{return!1}}function g(a=d(e.seed)){return function(a,b,c=!1){let d=a.length,e=bX(b),f=bY(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=bL(c?br(a):bq(W(a)),b-bC)+bC;return c?bt(g,e):bs(g,e)}(bo(a,e.seed,"seed"),c.ORDER)}function h(b,d=!0){return a.BASE.multiply(ct(c,b)).toBytes(d)}function i(b){if("bigint"==typeof b)return!1;if(b instanceof a)return!0;let{secretKey:d,publicKey:f,publicKeyUncompressed:g}=e;if(c.allowedLengths||d===f)return;let h=bu("key",b).length;return h===f||h===g}return Object.freeze({getPublicKey:h,getSharedSecret:function(b,d,e=!0){if(!0===i(b))throw Error("first arg must be private key");if(!1===i(d))throw Error("second arg must be public key");let f=ct(c,b);return a.fromHex(d).multiply(f).toBytes(e)},keygen:function(a){let b=g(a);return{secretKey:b,publicKey:h(b)}},Point:a,utils:{isValidSecretKey:f,isValidPublicKey:function(b,c){let{publicKey:d,publicKeyUncompressed:f}=e;try{let e=b.length;return(!0!==c||e===d)&&(!1!==c||e===f)&&!!a.fromBytes(b)}catch{return!1}},randomSecretKey:g,isValidPrivateKey:f,randomPrivateKey:g,normPrivateKeyToScalar:a=>ct(c,a),precompute:(b=8,c=a.BASE)=>c.precompute(b,!1)},lengths:e})}(a,c),o={prehash:!1,lowS:"boolean"==typeof c.lowS&&c.lowS,format:void 0,extraEntropy:!1},p="compact";function q(a,b){if(!g.isValidNot0(b))throw Error(`invalid signature ${a}: out of range 1..Point.Fn.ORDER`);return b}class r{constructor(a,b,c){this.r=q("r",a),this.s=q("s",b),null!=c&&(this.recovery=c),Object.freeze(this)}static fromBytes(a,b=p){var c,d;let e,f;if(c=a,cl(d=b),f=n.signature,bo(c,"compact"===d?f:"recovered"===d?f+1:void 0,`${d} signature`),"der"===b){let{r:b,s:c}=cn.toSig(bo(a));return new r(b,c)}"recovered"===b&&(e=a[0],b="compact",a=a.subarray(1));let h=g.BYTES,i=a.subarray(0,h),j=a.subarray(h,2*h);return new r(g.fromBytes(i),g.fromBytes(j),e)}static fromHex(a,b){return this.fromBytes(Y(a),b)}addRecoveryBit(a){return new r(this.r,this.s,a)}recoverPublicKey(b){let c=f.ORDER,{r:d,s:e,recovery:i}=this;if(null==i||![0,1,2,3].includes(i))throw Error("recovery id invalid");if(h*cq<c&&i>1)throw Error("recovery id is ambiguous for h>1 curve");let j=2===i||3===i?d+h:d;if(!f.isValid(j))throw Error("recovery id 2 or 3 invalid");let k=f.toBytes(j),l=a.fromBytes(_(cu((1&i)==0),k)),m=g.inv(j),n=t(bu("msgHash",b)),o=g.create(-n*m),p=g.create(e*m),q=a.BASE.multiplyUnsafe(o).add(l.multiplyUnsafe(p));if(q.is0())throw Error("point at infinify");return q.assertValidity(),q}hasHighS(){return this.s>h>>cp}toBytes(a=p){if(cl(a),"der"===a)return Y(cn.hexFromSig(this));let b=g.toBytes(this.r),c=g.toBytes(this.s);if("recovered"===a){if(null==this.recovery)throw Error("recovery bit must be present");return _(Uint8Array.of(this.recovery),b,c)}return _(b,c)}toHex(a){return W(this.toBytes(a))}assertValidity(){}static fromCompact(a){return r.fromBytes(bu("sig",a),"compact")}static fromDER(a){return r.fromBytes(bu("sig",a),"der")}normalizeS(){return this.hasHighS()?new r(this.r,g.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return W(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return W(this.toBytes("compact"))}}let s=c.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let b=bq(W(a)),c=8*a.length-i;return c>0?b>>BigInt(c):b},t=c.bits2int_modN||function(a){return g.create(s(a))},u=by(i);function v(a){return bw("num < 2^"+i,a,co,u),g.toBytes(a)}function w(a,c){return bo(a,void 0,"message"),c?bo(b(a),void 0,"prehashed message"):a}return Object.freeze({keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:n,Point:a,sign:function(c,f,i={}){let{seed:j,k2sig:k}=function(b,c,e){if(["recovered","canonical"].some(a=>a in e))throw Error("sign() legacy options not supported");let{lowS:f,prehash:i,extraEntropy:j}=cm(e,o),k=t(b=w(b,i)),l=ct(g,c),m=[v(l),v(k)];if(null!=j&&!1!==j){let a=!0===j?d(n.secretKey):j;m.push(bu("extraEntropy",a))}return{seed:_(...m),k2sig:function(b){let c=s(b);if(!g.isValidNot0(c))return;let d=g.inv(c),e=a.BASE.multiply(c).toAffine(),i=g.create(e.x);if(i===co)return;let j=g.create(d*g.create(k+i*l));if(j===co)return;let m=2*(e.x!==i)|Number(e.y&cp),n=j;return f&&j>h>>cp&&(n=g.neg(j),m^=1),new r(i,n,m)}}}(c=bu("message",c),f,i);return(function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=a=>new Uint8Array(a),e=d(a),f=d(a),g=0,h=()=>{e.fill(1),f.fill(0),g=0},i=(...a)=>c(f,e,...a),j=(a=d(0))=>{f=i(Uint8Array.of(0),a),e=i(),0!==a.length&&(f=i(Uint8Array.of(1),a),e=i())},k=()=>{if(g++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(e=i()).slice();c.push(b),a+=e.length}return _(...c)};return(a,b)=>{let c;for(h(),j(a);!(c=b(k()));)j();return h(),c}})(b.outputLen,g.BYTES,e)(j,k)},verify:function(b,c,d,e={}){let{lowS:f,prehash:h,format:i}=cm(e,o);if(d=bu("publicKey",d),c=w(bu("message",c),h),"strict"in e)throw Error("options.strict was renamed to lowS");let j=void 0===i?function(a){let b,c="string"==typeof a||G(a),d=!c&&null!==a&&"object"==typeof a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!c&&!d)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(d)b=new r(a.r,a.s);else if(c){try{b=r.fromBytes(bu("sig",a),"der")}catch(a){if(!(a instanceof cn.Err))throw a}if(!b)try{b=r.fromBytes(bu("sig",a),"compact")}catch{return!1}}return b||!1}(b):r.fromBytes(bu("sig",b),i);if(!1===j)return!1;try{let b=a.fromBytes(d);if(f&&j.hasHighS())return!1;let{r:e,s:h}=j,i=t(c),k=g.inv(h),l=g.create(i*k),m=g.create(e*k),n=a.BASE.multiplyUnsafe(l).add(b.multiplyUnsafe(m));return!n.is0()&&g.create(n.x)===e}catch{return!1}},recoverPublicKey:function(a,b,c={}){let{prehash:d}=cm(c,o);return b=w(b,d),r.fromBytes(a,"recovered").recoverPublicKey(b).toBytes()},Signature:r,hash:b})}(function(a,b={}){let c=function(a,b,c={},d){if(void 0===d&&(d="edwards"===a),!b||"object"!=typeof b)throw Error(`expected valid ${a} CURVE object`);for(let a of["p","n","h"]){let c=b[a];if(!("bigint"==typeof c&&c>bZ))throw Error(`CURVE.${a} must be positive bigint`)}let e=b9(b.p,c.Fp,d),f=b9(b.n,c.Fn,d);for(let c of["Gx","Gy","a","weierstrass"===a?"b":"d"])if(!e.isValid(b[c]))throw Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return{CURVE:b=Object.freeze(Object.assign({},b)),Fp:e,Fn:f}}("weierstrass",a,b),{Fp:d,Fn:e}=c,f=c.CURVE,{h:g,n:h}=f;bz(b,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=b;if(i&&(!d.is0(f.a)||"bigint"!=typeof i.beta||!Array.isArray(i.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let j=cv(d,e);function k(){if(!d.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let l=b.toBytes||function(a,b,c){let{x:e,y:f}=b.toAffine(),g=d.toBytes(e);return(bn(c,"isCompressed"),c)?(k(),_(cu(!d.isOdd(f)),g)):_(Uint8Array.of(4),g,d.toBytes(f))},m=b.fromBytes||function(a){bo(a,void 0,"Point");let{publicKey:b,publicKeyUncompressed:c}=j,e=a.length,f=a[0],g=a.subarray(1);if(e===b&&(2===f||3===f)){let a,b=d.fromBytes(g);if(!d.isValid(b))throw Error("bad point: is not on curve, wrong x");let c=n(b);try{a=d.sqrt(c)}catch(a){throw Error("bad point: is not on curve, sqrt error"+(a instanceof Error?": "+a.message:""))}return k(),(1&f)==1!==d.isOdd(a)&&(a=d.neg(a)),{x:b,y:a}}if(e===c&&4===f){let a=d.BYTES,b=d.fromBytes(g.subarray(0,a)),c=d.fromBytes(g.subarray(a,2*a));if(!o(b,c))throw Error("bad point: is not on curve");return{x:b,y:c}}throw Error(`bad point: got length ${e}, expected compressed=${b} or uncompressed=${c}`)};function n(a){let b=d.sqr(a),c=d.mul(b,a);return d.add(d.add(c,d.mul(a,f.a)),f.b)}function o(a,b){let c=d.sqr(b),e=n(a);return d.eql(c,e)}if(!o(f.Gx,f.Gy))throw Error("bad curve params: generator point");let p=d.mul(d.pow(f.a,cr),cs),q=d.mul(d.sqr(f.b),BigInt(27));if(d.is0(d.add(p,q)))throw Error("bad curve params: a or b");function r(a,b,c=!1){if(!d.isValid(b)||c&&d.is0(b))throw Error(`bad point coordinate ${a}`);return b}function s(a){if(!(a instanceof x))throw Error("ProjectivePoint expected")}function t(a){if(!i||!i.basises)throw Error("no endo");return function(a,b,c){let[[d,e],[f,g]]=b,h=ck(g*a,c),i=ck(-e*a,c),j=a-h*d-i*f,k=-h*e-i*g,l=j<co,m=k<co;l&&(j=-j),m&&(k=-k);let n=by(Math.ceil(bx(c)/2))+cp;if(j<co||j>=n||k<co||k>=n)throw Error("splitScalar (endomorphism): failed, k="+a);return{k1neg:l,k1:j,k2neg:m,k2:k}}(a,i.basises,e.ORDER)}let u=bA((a,b)=>{let{X:c,Y:e,Z:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),v=bA(a=>{if(a.is0()){if(b.allowInfinityPoint&&!d.is0(a.Y))return;throw Error("bad point: ZERO")}let{x:c,y:e}=a.toAffine();if(!d.isValid(c)||!d.isValid(e))throw Error("bad point: x or y not field elements");if(!o(c,e))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function w(a,b,c,e,f){return c=new x(d.mul(c.X,a),c.Y,c.Z),b=b_(e,b),c=b_(f,c),b.add(c)}class x{constructor(a,b,c){this.X=r("x",a),this.Y=r("y",b,!0),this.Z=r("z",c),Object.freeze(this)}static CURVE(){return f}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof x)throw Error("projective point not allowed");return d.is0(b)&&d.is0(c)?x.ZERO:new x(b,c,d.ONE)}static fromBytes(a){let b=x.fromAffine(m(bo(a,void 0,"point")));return b.assertValidity(),b}static fromHex(a){return x.fromBytes(bu("pointHex",a))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(a=8,b=!0){return z.createCache(this,a),b||this.multiply(cr),this}assertValidity(){v(this)}hasEvenY(){let{y:a}=this.toAffine();if(!d.isOdd)throw Error("Field doesn't support isOdd");return!d.isOdd(a)}equals(a){s(a);let{X:b,Y:c,Z:e}=this,{X:f,Y:g,Z:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),j=d.eql(d.mul(c,h),d.mul(g,e));return i&&j}negate(){return new x(this.X,d.neg(this.Y),this.Z)}double(){let{a:a,b}=f,c=d.mul(b,cr),{X:e,Y:g,Z:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(e,e),m=d.mul(g,g),n=d.mul(h,h),o=d.mul(e,g);return o=d.add(o,o),k=d.mul(e,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(c,n),j=d.add(i,j),i=d.sub(m,j),j=d.add(m,j),j=d.mul(i,j),i=d.mul(o,i),k=d.mul(c,k),n=d.mul(a,n),o=d.sub(l,n),o=d.mul(a,o),o=d.add(o,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,n),l=d.mul(l,o),j=d.add(j,l),n=d.mul(g,h),n=d.add(n,n),l=d.mul(n,o),i=d.sub(i,l),k=d.mul(n,m),k=d.add(k,k),new x(i,j,k=d.add(k,k))}add(a){s(a);let{X:b,Y:c,Z:e}=this,{X:g,Y:h,Z:i}=a,j=d.ZERO,k=d.ZERO,l=d.ZERO,m=f.a,n=d.mul(f.b,cr),o=d.mul(b,g),p=d.mul(c,h),q=d.mul(e,i),r=d.add(b,c),t=d.add(g,h);r=d.mul(r,t),t=d.add(o,p),r=d.sub(r,t),t=d.add(b,e);let u=d.add(g,i);return t=d.mul(t,u),u=d.add(o,q),t=d.sub(t,u),u=d.add(c,e),j=d.add(h,i),u=d.mul(u,j),j=d.add(p,q),u=d.sub(u,j),l=d.mul(m,t),j=d.mul(n,q),l=d.add(j,l),j=d.sub(p,l),l=d.add(p,l),k=d.mul(j,l),p=d.add(o,o),p=d.add(p,o),q=d.mul(m,q),t=d.mul(n,t),p=d.add(p,q),q=d.sub(o,q),q=d.mul(m,q),t=d.add(t,q),o=d.mul(p,t),k=d.add(k,o),o=d.mul(u,t),j=d.mul(r,j),j=d.sub(j,o),o=d.mul(r,p),l=d.mul(u,l),new x(j,k,l=d.add(l,o))}subtract(a){return this.add(a.negate())}is0(){return this.equals(x.ZERO)}multiply(a){let c,d,{endo:f}=b;if(!e.isValidNot0(a))throw Error("invalid scalar: out of range");let g=a=>z.cached(this,a,a=>b0(x,a));if(f){let{k1neg:b,k1:e,k2neg:h,k2:i}=t(a),{p:j,f:k}=g(e),{p:l,f:m}=g(i);d=k.add(m),c=w(f.beta,j,l,b,h)}else{let{p:b,f:e}=g(a);c=b,d=e}return b0(x,[c,d])[0]}multiplyUnsafe(a){let{endo:c}=b;if(!e.isValid(a))throw Error("invalid scalar: out of range");if(a===co||this.is0())return x.ZERO;if(a===cp)return this;if(z.hasCache(this))return this.multiply(a);if(!c)return z.unsafe(this,a);{let{k1neg:b,k1:d,k2neg:e,k2:f}=t(a),{p1:g,p2:h}=function(a,b,c,d){let e=b,f=a.ZERO,g=a.ZERO;for(;c>bZ||d>bZ;)c&b$&&(f=f.add(e)),d&b$&&(g=g.add(e)),e=e.double(),c>>=b$,d>>=b$;return{p1:f,p2:g}}(x,this,d,f);return w(c.beta,g,h,b,e)}}multiplyAndAddUnsafe(a,b,c){let d=this.multiplyUnsafe(b).add(a.multiplyUnsafe(c));return d.is0()?void 0:d}toAffine(a){return u(this,a)}isTorsionFree(){let{isTorsionFree:a}=b;return g===cp||(a?a(x,this):z.unsafe(this,h).is0())}clearCofactor(){let{clearCofactor:a}=b;return g===cp?this:a?a(x,this):this.multiplyUnsafe(g)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}toBytes(a=!0){return bn(a,"isCompressed"),this.assertValidity(),l(x,this,a)}toHex(a=!0){return W(this.toBytes(a))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(a=!0){return this.toBytes(a)}_setWindowSize(a){this.precompute(a)}static normalizeZ(a){return b0(x,a)}static msm(a,b){return function(a,b,c,d){(function(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})})(c,a),function(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}(d,b);let e=c.length,f=d.length;if(e!==f)throw Error("arrays of points and scalars must have equal length");let g=a.ZERO,h=bx(BigInt(e)),i=1;h>12?i=h-3:h>4?i=h-2:h>0&&(i=2);let j=by(i),k=Array(Number(j)+1).fill(g),l=Math.floor((b.BITS-1)/i)*i,m=g;for(let a=l;a>=0;a-=i){k.fill(g);for(let b=0;b<f;b++){let e=Number(d[b]>>BigInt(a)&j);k[e]=k[e].add(c[b])}let b=g;for(let a=k.length-1,c=g;a>0;a--)c=c.add(k[a]),b=b.add(c);if(m=m.add(b),0!==a)for(let a=0;a<i;a++)m=m.double()}return m}(x,e,a,b)}static fromPrivateKey(a){return x.BASE.multiply(ct(e,a))}}x.BASE=new x(f.Gx,f.Gy,d.ONE),x.ZERO=new x(d.ZERO,d.ONE,d.ZERO),x.Fp=d,x.Fn=e;let y=e.BITS,z=new b8(x,b.endo?Math.ceil(y/2):y);return x.BASE.precompute(8),x}(c,d),e,f);return b=g.Point,Object.assign({},g,{ProjectivePoint:b,CURVE:Object.assign({},a,bV(b.Fn.ORDER,b.Fn.BITS))})})({...a,hash:b});return{...c(b),create:c}}let cx={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},cy={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},cz={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},cA=bW(cx.p),cB=bW(cy.p),cC=bW(cz.p);cw({...cx,Fp:cA,lowS:!1},aI),cw({...cy,Fp:cB,lowS:!1},aK),cw({...cz,Fp:cC,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},aJ),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,a.i(168326),a.i(371964),a.i(771167),a.i(416537),a.i(576863),n.ONE_DAY,n.SIX_HOURS,n.THIRTY_DAYS,n.FIVE_SECONDS,n.THIRTY_DAYS,n.ONE_DAY,n.ONE_DAY,n.THIRTY_SECONDS,n.THIRTY_SECONDS,n.ONE_DAY,n.ONE_DAY,n.ONE_DAY;var cD=function(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[0]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&&-1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var n=f-e;n!==f&&0===g[n];)n++;for(var o=new Uint8Array(d+(f-n)),p=d;n!==f;)o[p++]=g[n++];return o}}}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,n=g-1;(0!==l||m<d)&&-1!==n;n--,m++)l+=256*j[n]>>>0,j[n]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var o=g-d;o!==g&&0===j[o];)o++;for(var p=i.repeat(c);o<g;++o)p+=a.charAt(j[o]);return p},decodeUnsafe:l,decode:function(a){var c=l(a);if(c)return c;throw Error(`Non-${b} character`)}}};let cE=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")};class cF{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class cG{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return cI(this,a)}}class cH{constructor(a){this.decoders=a}or(a){return cI(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let cI=(a,b)=>new cH({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class cJ{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new cF(a,b,c),this.decoder=new cG(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let cK=({name:a,prefix:b,encode:c,decode:d})=>new cJ(a,b,c,d),cL=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:e}=cD(c,b);return cK({prefix:a,name:b,encode:d,decode:a=>cE(e(a))})},cM=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>cK({prefix:b,name:a,encode:a=>((a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let d=0;d<a.length;++d)for(h=h<<8|a[d],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f})(a,d,c),decode:b=>((a,b,c,d)=>{let e={};for(let a=0;a<b.length;++a)e[b[a]]=a;let f=a.length;for(;"="===a[f-1];)--f;let g=new Uint8Array(f*c/8|0),h=0,i=0,j=0;for(let b=0;b<f;++b){let f=e[a[b]];if(void 0===f)throw SyntaxError(`Non-${d} character`);i=i<<c|f,(h+=c)>=8&&(h-=8,g[j++]=255&i>>h)}if(h>=c||255&i<<8-h)throw SyntaxError("Unexpected end of data");return g})(b,d,c,a)});var cN=Object.freeze({__proto__:null,identity:cK({prefix:"\0",name:"identity",encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)})}),cO=Object.freeze({__proto__:null,base2:cM({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),cP=Object.freeze({__proto__:null,base8:cM({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),cQ=Object.freeze({__proto__:null,base10:cL({prefix:"9",name:"base10",alphabet:"0123456789"})}),cR=Object.freeze({__proto__:null,base16:cM({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:cM({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),cS=Object.freeze({__proto__:null,base32:cM({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper:cM({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad:cM({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper:cM({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex:cM({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper:cM({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad:cM({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:cM({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:cM({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),cT=Object.freeze({__proto__:null,base36:cL({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:cL({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),cU=Object.freeze({__proto__:null,base58btc:cL({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:cL({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),cV=Object.freeze({__proto__:null,base64:cM({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad:cM({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:cM({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:cM({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let cW=Array.from(""),cX=cW.reduce((a,b,c)=>(a[c]=b,a),[]),cY=cW.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]);var cZ=Object.freeze({__proto__:null,base256emoji:cK({prefix:"",name:"base256emoji",encode:function(a){return a.reduce((a,b)=>a+=cX[b],"")},decode:function(a){let b=[];for(let c of a){let a=cY[c.codePointAt(0)];if(void 0===a)throw Error(`Non-base256emoji character: ${c}`);b.push(a)}return new Uint8Array(b)}})});function c$(a,b,c){b=b||[],c=c||0;for(var d=c;a>=0x80000000;)b[c++]=255&a|128,a/=128;for(;-128&a;)b[c++]=255&a|128,a>>>=7;return b[c]=0|a,c$.bytes=c-d+1,b}var c_=function(a){return a<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:a<0x800000000?5:a<0x40000000000?6:a<0x2000000000000?7:a<0x100000000000000?8:a<0x8000000000000000?9:10};let c0=(a,b,c=0)=>(c$(a,b,c),b),c1=(a,b)=>{let c=b.byteLength,d=c_(a),e=d+c_(c),f=new Uint8Array(e+c);return c0(a,f,0),c0(c,f,d),f.set(b,e),new c2(a,c,b,f)};class c2{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}let c3=({name:a,code:b,encode:c})=>new c4(a,b,c);class c4{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?c1(this.code,b):b.then(a=>c1(this.code,a))}throw Error("Unknown type, must be binary type")}}let c5=a=>async b=>new Uint8Array(await crypto.subtle.digest(a,b));var c6=Object.freeze({__proto__:null,sha256:c3({name:"sha2-256",code:18,encode:c5("SHA-256")}),sha512:c3({name:"sha2-512",code:19,encode:c5("SHA-512")})}),c7=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:cE,digest:a=>c1(0,cE(a))}});new TextEncoder,new TextDecoder;let c8={...cN,...cO,...cP,...cQ,...cR,...cS,...cT,...cU,...cV,...cZ};function c9(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}({...c6,...c7}),c9("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),c9("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{let b=function(a=0){var b;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(b=globalThis.Buffer.allocUnsafe(a),null!=globalThis.Buffer?new Uint8Array(b.buffer,b.byteOffset,b.byteLength):b):new Uint8Array(a)}((a=a.substring(1)).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),c8.base16,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,n.THIRTY_DAYS,n.SEVEN_DAYS,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.ONE_DAY,n.ONE_DAY,n.ONE_DAY,n.ONE_DAY,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.ONE_DAY,n.ONE_DAY,n.ONE_DAY,n.ONE_DAY,n.ONE_HOUR,n.ONE_HOUR,n.FIVE_MINUTES,n.FIVE_MINUTES,n.FIVE_MINUTES,n.SEVEN_DAYS,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,a.i(577058),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var da=a.i(496507),db=a.i(51507),dc=a.i(363882),dd=a.i(621297),de=a.i(394406),df=a.i(402242),dg=a.i(764993),dh=a.i(400620),di=a.i(433927),dj=a.i(774263),dk=a.i(54677),dl=a.i(926119);let dm=null,dn={getSIWX:()=>dh.OptionsController.state.siwx,async initializeIfEnabled(a=dc.ChainController.getActiveCaipAddress()){let b=dh.OptionsController.state.siwx;if(!(b&&a))return;let[c,d,e]=a.split(":");if(dc.ChainController.checkIfSupportedNetwork(c,`${c}:${d}`))try{if(dh.OptionsController.state.remoteFeatures?.emailCapture){let a=dc.ChainController.getAccountData(c)?.user;await dg.ModalController.open({view:"DataCapture",data:{email:a?.email??void 0}});return}if(dm&&await dm,(await b.getSessions(`${c}:${d}`,e)).length)return;await dg.ModalController.open({view:"SIWXSignMessage"})}catch(a){console.error("SIWXUtil:initializeIfEnabled",a),df.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(a)}),await dd.ConnectionController._getClient()?.disconnect().catch(console.error),di.RouterController.reset("Connect"),dj.SnackController.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){let a=dh.OptionsController.state.siwx,b=dl.CoreHelperUtil.getPlainAddress(dc.ChainController.getActiveCaipAddress()),c=(0,dk.getActiveCaipNetwork)(),d=dd.ConnectionController._getClient();if(!a)throw Error("SIWX is not enabled");if(!b)throw Error("No ActiveCaipAddress found");if(!c)throw Error("No ActiveCaipNetwork or client found");if(!d)throw Error("No ConnectionController client found");try{let e=await a.createMessage({chainId:c.caipNetworkId,accountAddress:b}),f=e.toString();de.ConnectorController.getConnectorId(c.chainNamespace)===da.ConstantsUtil.CONNECTOR_ID.AUTH&&di.RouterController.pushTransactionStack({});let g=await d.signMessage(f);await a.addSession({data:e,message:f,signature:g}),dc.ChainController.setLastConnectedSIWECaipNetwork(c),dg.ModalController.close(),df.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(a){dg.ModalController.state.open&&"ApproveTransaction"!==di.RouterController.state.view||await dg.ModalController.open({view:"SIWXSignMessage"}),dj.SnackController.showError("Error signing message"),df.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(a)}),console.error("SWIXUtil:requestSignMessage",a)}},async cancelSignMessage(){try{let a=this.getSIWX();if(a?.getRequired?.()){let b=dc.ChainController.getLastConnectedSIWECaipNetwork();if(b){let c=await a?.getSessions(b?.caipNetworkId,dl.CoreHelperUtil.getPlainAddress(dc.ChainController.getActiveCaipAddress())||"");c&&c.length>0?await dc.ChainController.switchActiveNetwork(b):await dd.ConnectionController.disconnect()}else await dd.ConnectionController.disconnect()}else dg.ModalController.close();dg.ModalController.close(),df.EventsController.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(a){console.error("SIWXUtil:cancelSignMessage",a)}},async getAllSessions(){let a=this.getSIWX(),b=dc.ChainController.getAllRequestedCaipNetworks(),c=[];return await Promise.all(b.map(async b=>{let d=await a?.getSessions(b.caipNetworkId,dl.CoreHelperUtil.getPlainAddress(dc.ChainController.getActiveCaipAddress())||"");d&&c.push(...d)})),c},async getSessions(a){let b=dh.OptionsController.state.siwx,c=a?.address;if(!c){let a=dc.ChainController.getActiveCaipAddress();c=dl.CoreHelperUtil.getPlainAddress(a)}let d=a?.caipNetworkId;if(!d){let a=dc.ChainController.getActiveCaipNetwork();d=a?.caipNetworkId}return b&&c&&d?b.getSessions(d,c):[]},async isSIWXCloseDisabled(){let a=this.getSIWX();if(a){let b="ApproveTransaction"===di.RouterController.state.view,c="SIWXSignMessage"===di.RouterController.state.view;if(b||c)return a.getRequired?.()&&0===(await this.getSessions()).length}return!1},async authConnectorAuthenticate({authConnector:a,chainId:b,socialUri:c,preferredAccountType:d,chainNamespace:e}){let f=dn.getSIWX(),g=(0,dk.getActiveCaipNetwork)();if(!f||!e.includes(da.ConstantsUtil.CHAIN.EVM)||dh.OptionsController.state.remoteFeatures?.emailCapture){let e=await a.connect({chainId:b,socialUri:c,preferredAccountType:d});return{address:e.address,chainId:e.chainId,accounts:e.accounts}}let h=`${e}:${b}`,i=await f.createMessage({chainId:h,accountAddress:"<<AccountAddress>>"}),j={accountAddress:i.accountAddress,chainId:i.chainId,domain:i.domain,uri:i.uri,version:i.version,nonce:i.nonce,notBefore:i.notBefore,statement:i.statement,resources:i.resources,requestId:i.requestId,issuedAt:i.issuedAt,expirationTime:i.expirationTime,serializedMessage:i.toString()},k=await a.connect({chainId:b,socialUri:c,siwxMessage:j,preferredAccountType:d});if(j.accountAddress=k.address,j.serializedMessage=k.message||"",k.signature&&k.message){let a=dn.addEmbeddedWalletSession(j,k.message,k.signature);await a}return dc.ChainController.setLastConnectedSIWECaipNetwork(g),{address:k.address,chainId:k.chainId,accounts:k.accounts}},async addEmbeddedWalletSession(a,b,c){if(dm)return dm;let d=dn.getSIWX();return d?dm=d.addSession({data:a,message:b,signature:c}).finally(()=>{dm=null}):Promise.resolve()},async universalProviderAuthenticate({universalProvider:a,chains:b,methods:c}){let d=dn.getSIWX(),e=(0,dk.getActiveCaipNetwork)(),f=new Set(b.map(a=>a.split(":")[0]));if(!d||1!==f.size||!f.has("eip155"))return!1;let g=await d.createMessage({chainId:(0,dk.getActiveCaipNetwork)()?.caipNetworkId||"",accountAddress:""}),h=await a.authenticate({nonce:g.nonce,domain:g.domain,uri:g.uri,exp:g.expirationTime,iat:g.issuedAt,nbf:g.notBefore,requestId:g.requestId,version:g.version,resources:g.resources,statement:g.statement,chainId:g.chainId,methods:c,chains:[g.chainId,...b.filter(a=>a!==g.chainId)]});dj.SnackController.showLoading("Authenticating...",{autoClose:!1});let i={...h.session.peer.metadata,name:h.session.peer.metadata.name,icon:h.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(dc.ChainController.setAccountProp("connectedWalletInfo",i,Array.from(f)[0]),h?.auths?.length){let b=h.auths.map(b=>{let c=a.client.formatAuthMessage({request:b.p,iss:b.p.iss});return{data:{...b.p,accountAddress:b.p.iss.split(":").slice(-1).join(""),chainId:b.p.iss.split(":").slice(2,4).join(":"),uri:b.p.aud,version:b.p.version||g.version,expirationTime:b.p.exp,issuedAt:b.p.iat,notBefore:b.p.nbf},message:c,signature:b.s.s,cacao:b}});try{await d.setSessions(b),e&&dc.ChainController.setLastConnectedSIWECaipNetwork(e),df.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:dn.getSIWXEventProperties()})}catch(b){throw console.error("SIWX:universalProviderAuth - failed to set sessions",b),df.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:dn.getSIWXEventProperties(b)}),await a.disconnect().catch(console.error),b}finally{dj.SnackController.hide()}}return!0},getSIWXEventProperties(a){let b=dc.ChainController.state.activeChain;if(!b)throw Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:dc.ChainController.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:(0,dk.getPreferredAccountType)(b)===db.W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,message:a?dl.CoreHelperUtil.parseError(a):void 0}},async clearSessions(){let a=this.getSIWX();a&&await a.setSessions([])}};a.s(["SIWXUtil",0,dn],120975)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__566fa357._.js.map