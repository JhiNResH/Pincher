(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,548828,(e,t,r)=>{"use strict";let i=e.r(294790);t.exports=o;let n=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function o(e){var t,r;(e=e||{}).browser=e.browser||{};let i=e.browser.transmit;if(i&&"function"!=typeof i.send)throw Error("pino: transmit option must have a send function");let h=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let c=e.serializers||{},b=(t=e.browser.serialize,Array.isArray(t)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(c)),g=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(g=!1),"function"==typeof h&&(h.error=h.fatal=h.warn=h.info=h.debug=h.trace=h),!1===e.enabled&&(e.level="silent");let y=e.level||"info",w=Object.create(h);w.log||(w.log=u),Object.defineProperty(w,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(w,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,s(m,w,"error","log"),s(m,w,"fatal","error"),s(m,w,"warn","error"),s(m,w,"info","log"),s(m,w,"debug","log"),s(m,w,"trace","log")}});let m={transmit:i,serialize:b,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?d:p};return w.levels=o.levels,w.level=y,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=u,w.serializers=c,w._serialize=b,w._stdErrSerialize=g,w.child=function(t,r){if(!t)throw Error("missing bindings for child Pino");r=r||{},b&&t.serializers&&(r.serializers=t.serializers);let n=r.serializers;if(b&&n){var o=Object.assign({},c,n),s=!0===e.browser.serialize?Object.keys(o):b;delete t.serializers,f([t],s,o,this._stdErrSerialize)}function h(e){this._childLevel=(0|e._childLevel)+1,this.error=a(e,t,"error"),this.fatal=a(e,t,"fatal"),this.warn=a(e,t,"warn"),this.info=a(e,t,"info"),this.debug=a(e,t,"debug"),this.trace=a(e,t,"trace"),o&&(this.serializers=o,this._serialize=s),i&&(this._logEvent=l([].concat(e._logEvent.bindings,t)))}return h.prototype=this,new h(this)},i&&(w._logEvent=l()),w}function s(e,t,r,s){let a=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?u:a[r]?a[r]:n[r]||n[s]||u,function(e,t,r){if(e.transmit||t[r]!==u){var s;t[r]=(s=t[r],function(){let a=e.timestamp(),h=Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var u,d,p,b=0;b<h.length;b++)h[b]=arguments[b];if(e.serialize&&!e.asObject&&f(h,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?s.call(c,function(e,t,r,n){e._serialize&&f(r,e._serialize,e.serializers,e._stdErrSerialize);let s=r.slice(),a=s[0],l={};n&&(l.time=n),l.level=o.levels.values[t];let h=(0|e._childLevel)+1;if(h<1&&(h=1),null!==a&&"object"==typeof a){for(;h--&&"object"==typeof s[0];)Object.assign(l,s.shift());a=s.length?i(s.shift(),s):void 0}else"string"==typeof a&&(a=i(s.shift(),s));return void 0!==a&&(l.msg=a),l}(this,r,h,a)):s.apply(c,h),e.transmit){let i,n,s,c,b,g,y=e.transmit.level||t.level,w=o.levels.values[y],m=o.levels.values[r];if(m<w)return;u=this,d={ts:a,methodLevel:r,methodValue:m,transmitLevel:y,transmitValue:o.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},p=h,i=d.send,n=d.ts,s=d.methodLevel,c=d.methodValue,b=d.val,g=u._logEvent.bindings,f(p,u._serialize||Object.keys(u.serializers),u.serializers,void 0===u._stdErrSerialize||u._stdErrSerialize),u._logEvent.ts=n,u._logEvent.messages=p.filter(function(e){return -1===g.indexOf(e)}),u._logEvent.level.label=s,u._logEvent.level.value=c,i(s,u._logEvent,b),u._logEvent=l(g)}})}}(e,t,r)}function f(e,t,r,i){for(let n in e)if(i&&e[n]instanceof Error)e[n]=o.stdSerializers.err(e[n]);else if("object"==typeof e[n]&&!Array.isArray(e[n]))for(let i in e[n])t&&t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function a(e,t,r){return function(){let i=Array(1+arguments.length);i[0]=t;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return e[r].apply(this,i)}}function l(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function h(){return{}}function c(e){return e}function u(){}function d(){return!1}function p(){return Date.now()}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers={mapHttpRequest:h,mapHttpResponse:h,wrapRequestSerializer:c,wrapResponseSerializer:c,wrapErrorSerializer:c,req:h,res:h,err:function(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}},o.stdTimeFunctions=Object.assign({},{nullTime:d,epochTime:p,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},730374,e=>{"use strict";var t=e.i(548828);e.s(["pino",()=>t.default])},442950,e=>{"use strict";var t=e.i(639576),r=e.i(875332),i=e.i(38472),n=e.i(843498);let o=(0,t.proxy)({message:"",variant:"info",open:!1}),s=(0,i.withErrorBoundary)({state:o,subscribeKey:(e,t)=>(0,r.subscribeKey)(o,e,t),open(e,t){let{debug:r}=n.OptionsController.state,{code:i,displayMessage:s,debugMessage:f}=e;s&&r&&(o.message=s,o.variant=t,o.open=!0),f&&console.error("function"==typeof f?f():f,i?{code:i}:void 0)},warn(e,t,r){o.open=!0,o.message=e,o.variant="warning",t&&console.warn(t,r)},close(){o.open=!1,o.message="",o.variant="info"}});e.s(["AlertController",0,s])},992689,e=>{"use strict";var t=e.i(548828),r=e.i(358195);let i="custom_context";class n{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class o{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new n(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}class s{constructor(e,r=1024e3){this.level=e??"error",this.levelValue=t.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new o(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===t.levels.values.error?console.error(e):r===t.levels.values.warn?console.warn(e):r===t.levels.values.debug?console.debug(e):r===t.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,r.safeJsonStringify)({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new o(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push((0,r.safeJsonStringify)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class f{constructor(e,t=1024e3){this.baseChunkLogger=new s(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}class a{constructor(e,t=1024e3){this.baseChunkLogger=new s(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var l=Object.defineProperty,h=Object.defineProperties,c=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,b=(e,t,r)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))d.call(t,r)&&b(e,r,t[r]);if(u)for(var r of u(t))p.call(t,r)&&b(e,r,t[r]);return e};function y(e){return h(g({},e),c({level:e?.level||"info"}))}function w(e,t=i){return typeof e.bindings>"u"?function(e,t=i){return e[t]||""}(e,t):e.bindings().context||""}function m(e,t,r=i){let n=function(e,t,r=i){let n=w(e,r);return n.trim()?`${n}/${t}`:t}(e,t,r);return function(e,t,r=i){return e[r]=t,e}(e.child({context:n}),n,r)}function x(e){var r,i,n,o;let s,l,u,d;return"u">typeof e.loggerOverride&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:"u">typeof window?(d=new f(null==(n=(i=e).opts)?void 0:n.level,i.maxSizeInBytes),{logger:(0,t.default)((l=g({},i.opts),u={level:"trace",browser:h(g({},null==(o=i.opts)?void 0:o.browser),c({write:e=>d.write(e)}))},h(l,c(u)))),chunkLoggerController:d}):(s=new a(null==(r=e.opts)?void 0:r.level,e.maxSizeInBytes),{logger:(0,t.default)(h(g({},e.opts),c({level:"trace"})),s),chunkLoggerController:s})}e.s(["generateChildLogger",()=>m,"generatePlatformLogger",()=>x,"getDefaultLoggerOptions",()=>y,"getLoggerContext",()=>w])},12560,e=>{"use strict";let t,r,i,n,o;e.i(389978),e.i(427217);var s,f,a,l,h=e.i(465076);e.i(824064),e.i(717618),e.i(992689),e.i(730374),e.i(315903);var c=e.i(506003),u=Object.defineProperty;c.IEvents;c.IEvents,c.IEvents,c.IEvents,c.IEvents,c.IEvents,h.default,h.EventEmitter;var d=e.i(712854);e.i(358195),e.i(187261),e.i(760150),e.i(720978),e.i(345467),e.i(731495),e.i(127017),e.i(370115),e.i(364664),e.i(891548),e.i(971400),e.i(465107),e.i(414113),e.i(471729),e.i(683174),e.i(868653),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let p=BigInt(0x100000000-1),b=BigInt(32);function g(e,t=!1){return t?{h:Number(e&p),l:Number(e>>b&p)}:{h:0|Number(e>>b&p),l:0|Number(e&p)}}function y(e,t=!1){let r=e.length,i=new Uint32Array(r),n=new Uint32Array(r);for(let o=0;o<r;o++){let{h:r,l:s}=g(e[o],t);[i[o],n[o]]=[r,s]}return[i,n]}let w=(e,t,r)=>e>>>r,m=(e,t,r)=>e<<32-r|t>>>r,x=(e,t,r)=>e>>>r|t<<32-r,v=(e,t,r)=>e<<32-r|t>>>r,E=(e,t,r)=>e<<64-r|t>>>r-32,A=(e,t,r)=>e>>>r-32|t<<64-r;function I(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/0x100000000|0)|0,l:0|n}}let B=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),O=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0,C=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),S=(e,t,r,i,n)=>t+r+i+n+(e/0x100000000|0)|0,U=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0),L=(e,t,r,i,n,o)=>t+r+i+n+o+(e/0x100000000|0)|0,_="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function N(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function k(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function R(e,...t){if(!N(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function j(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");k(e.outputLen),k(e.blockLen)}function T(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function P(e,t){R(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function z(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function D(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function F(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function H(e,t){return e<<32-t|e>>>t}let V=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function M(e){return e<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}let q=V?e=>e:e=>M(e),X=V?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=M(e[t]);return e},W="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Y=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Z(e){if(R(e),W)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Y[e[r]];return t}function K(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function G(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(W)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=K(e.charCodeAt(n)),o=K(e.charCodeAt(n+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+o}return i}function $(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function J(e){return"string"==typeof e&&(e=$(e)),R(e),e}function Q(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];R(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}class ee{}function et(e){let t=t=>e().update(J(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function er(e=32){if(_&&"function"==typeof _.getRandomValues)return _.getRandomValues(new Uint8Array(e));if(_&&"function"==typeof _.randomBytes)return Uint8Array.from(_.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}let ei=BigInt(0),en=BigInt(1),eo=BigInt(2),es=BigInt(7),ef=BigInt(256),ea=BigInt(113),el=[],eh=[],ec=[];for(let e=0,t=en,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],el.push(2*(5*i+r)),eh.push((e+1)*(e+2)/2%64);let n=ei;for(let e=0;e<7;e++)(t=(t<<en^(t>>es)*ea)%ef)&eo&&(n^=en<<(en<<BigInt(e))-en);ec.push(n)}let eu=y(ec,!0),ed=eu[0],ep=eu[1],eb=(e,t,r)=>r>32?t<<r-32|e>>>64-r:e<<r|t>>>32-r,eg=(e,t,r)=>r>32?e<<r-32|t>>>64-r:t<<r|e>>>32-r;class ey extends ee{constructor(e,t,r,i=!1,n=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,k(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=z(this.state)}clone(){return this._cloneInto()}keccak(){X(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,n=(t+2)%10,o=r[n],s=r[n+1],f=eb(o,s,1)^r[i],a=eg(o,s,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=f,e[t+r+1]^=a}let t=e[2],n=e[3];for(let r=0;r<24;r++){let i=eh[r],o=eb(t,n,i),s=eg(t,n,i),f=el[r];t=e[f],n=e[f+1],e[f]=o,e[f+1]=s}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=ed[i],e[1]^=ep[i]}D(r)}(this.state32,this.rounds),X(this.state32),this.posOut=0,this.pos=0}update(e){T(this),R(e=J(e));let{blockLen:t,state:r}=this,i=e.length;for(let n=0;n<i;){let o=Math.min(t-this.pos,i-n);for(let t=0;t<o;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){T(this,!1),R(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return k(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(P(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,D(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:o}=this;return e||(e=new ey(t,r,i,o,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}et(()=>new ey(136,1,32));class ew extends ee{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=F(this.buffer)}update(e){T(this),R(e=J(e));let{view:t,buffer:r,blockLen:i}=this,n=e.length;for(let o=0;o<n;){let s=Math.min(i-this.pos,n-o);if(s===i){let t=F(e);for(;i<=n-o;o+=i)this.process(t,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){T(this),P(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:n}=this,{pos:o}=this;t[o++]=128,D(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let e=o;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>n&o),f=Number(r&o),a=4*!!i,l=4*!i;e.setUint32(t+a,s,i),e.setUint32(t+l,f,i)})(r,i-8,BigInt(8*this.length),n),this.process(r,0);let s=F(e),f=this.outputLen;if(f%4)throw Error("_sha2: outputLen should be aligned to 32bit");let a=f/4,l=this.get();if(a>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<a;e++)s.setUint32(4*e,l[e],n)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=n,e.length=i,e.pos=s,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}let em=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),ex=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),ev=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),eE=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),eA=new Uint32Array(64);class eI extends ew{constructor(e=32){super(64,e,8,!1),this.A=0|em[0],this.B=0|em[1],this.C=0|em[2],this.D=0|em[3],this.E=0|em[4],this.F=0|em[5],this.G=0|em[6],this.H=0|em[7]}get(){let{A:e,B:t,C:r,D:i,E:n,F:o,G:s,H:f}=this;return[e,t,r,i,n,o,s,f]}set(e,t,r,i,n,o,s,f){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|o,this.G=0|s,this.H=0|f}process(e,t){for(let r=0;r<16;r++,t+=4)eA[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=eA[e-15],r=eA[e-2],i=H(t,7)^H(t,18)^t>>>3,n=H(r,17)^H(r,19)^r>>>10;eA[e]=n+eA[e-7]+i+eA[e-16]|0}let{A:r,B:i,C:n,D:o,E:s,F:f,G:a,H:l}=this;for(let e=0;e<64;e++){var h,c,u,d;let t=l+(H(s,6)^H(s,11)^H(s,25))+((h=s)&f^~h&a)+eE[e]+eA[e]|0,p=(H(r,2)^H(r,13)^H(r,22))+((c=r)&(u=i)^c&(d=n)^u&d)|0;l=a,a=f,f=s,s=o+t|0,o=n,n=i,i=r,r=t+p|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,o=o+this.D|0,s=s+this.E|0,f=f+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,i,n,o,s,f,a,l)}roundClean(){D(eA)}destroy(){this.set(0,0,0,0,0,0,0,0),D(this.buffer)}}let eB=y(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),eO=eB[0],eC=eB[1],eS=new Uint32Array(80),eU=new Uint32Array(80);class eL extends ew{constructor(e=64){super(128,e,16,!1),this.Ah=0|ev[0],this.Al=0|ev[1],this.Bh=0|ev[2],this.Bl=0|ev[3],this.Ch=0|ev[4],this.Cl=0|ev[5],this.Dh=0|ev[6],this.Dl=0|ev[7],this.Eh=0|ev[8],this.El=0|ev[9],this.Fh=0|ev[10],this.Fl=0|ev[11],this.Gh=0|ev[12],this.Gl=0|ev[13],this.Hh=0|ev[14],this.Hl=0|ev[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:o,Dh:s,Dl:f,Eh:a,El:l,Fh:h,Fl:c,Gh:u,Gl:d,Hh:p,Hl:b}=this;return[e,t,r,i,n,o,s,f,a,l,h,c,u,d,p,b]}set(e,t,r,i,n,o,s,f,a,l,h,c,u,d,p,b){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|o,this.Dh=0|s,this.Dl=0|f,this.Eh=0|a,this.El=0|l,this.Fh=0|h,this.Fl=0|c,this.Gh=0|u,this.Gl=0|d,this.Hh=0|p,this.Hl=0|b}process(e,t){for(let r=0;r<16;r++,t+=4)eS[r]=e.getUint32(t),eU[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|eS[e-15],r=0|eU[e-15],i=x(t,r,1)^x(t,r,8)^w(t,r,7),n=v(t,r,1)^v(t,r,8)^m(t,r,7),o=0|eS[e-2],s=0|eU[e-2],f=x(o,s,19)^E(o,s,61)^w(o,s,6),a=C(n,v(o,s,19)^A(o,s,61)^m(o,s,6),eU[e-7],eU[e-16]),l=S(a,i,f,eS[e-7],eS[e-16]);eS[e]=0|l,eU[e]=0|a}let{Ah:r,Al:i,Bh:n,Bl:o,Ch:s,Cl:f,Dh:a,Dl:l,Eh:h,El:c,Fh:u,Fl:d,Gh:p,Gl:b,Hh:g,Hl:y}=this;for(let e=0;e<80;e++){let t=x(h,c,14)^x(h,c,18)^E(h,c,41),w=v(h,c,14)^v(h,c,18)^A(h,c,41),m=h&u^~h&p,C=U(y,w,c&d^~c&b,eC[e],eU[e]),S=L(C,g,t,m,eO[e],eS[e]),_=0|C,N=x(r,i,28)^E(r,i,34)^E(r,i,39),k=v(r,i,28)^A(r,i,34)^A(r,i,39),R=r&n^r&s^n&s,j=i&o^i&f^o&f;g=0|p,y=0|b,p=0|u,b=0|d,u=0|h,d=0|c,({h:h,l:c}=I(0|a,0|l,0|S,0|_)),a=0|s,l=0|f,s=0|n,f=0|o,n=0|r,o=0|i;let T=B(_,k,j);r=O(T,S,N,R),i=0|T}({h:r,l:i}=I(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:o}=I(0|this.Bh,0|this.Bl,0|n,0|o)),({h:s,l:f}=I(0|this.Ch,0|this.Cl,0|s,0|f)),({h:a,l:l}=I(0|this.Dh,0|this.Dl,0|a,0|l)),({h:h,l:c}=I(0|this.Eh,0|this.El,0|h,0|c)),({h:u,l:d}=I(0|this.Fh,0|this.Fl,0|u,0|d)),({h:p,l:b}=I(0|this.Gh,0|this.Gl,0|p,0|b)),({h:g,l:y}=I(0|this.Hh,0|this.Hl,0|g,0|y)),this.set(r,i,n,o,s,f,a,l,h,c,u,d,p,b,g,y)}roundClean(){D(eS,eU)}destroy(){D(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class e_ extends eL{constructor(){super(48),this.Ah=0|ex[0],this.Al=0|ex[1],this.Bh=0|ex[2],this.Bl=0|ex[3],this.Ch=0|ex[4],this.Cl=0|ex[5],this.Dh=0|ex[6],this.Dl=0|ex[7],this.Eh=0|ex[8],this.El=0|ex[9],this.Fh=0|ex[10],this.Fl=0|ex[11],this.Gh=0|ex[12],this.Gl=0|ex[13],this.Hh=0|ex[14],this.Hl=0|ex[15]}}let eN=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class ek extends eL{constructor(){super(32),this.Ah=0|eN[0],this.Al=0|eN[1],this.Bh=0|eN[2],this.Bl=0|eN[3],this.Ch=0|eN[4],this.Cl=0|eN[5],this.Dh=0|eN[6],this.Dl=0|eN[7],this.Eh=0|eN[8],this.El=0|eN[9],this.Fh=0|eN[10],this.Fl=0|eN[11],this.Gh=0|eN[12],this.Gl=0|eN[13],this.Hh=0|eN[14],this.Hl=0|eN[15]}}let eR=et(()=>new eI),ej=et(()=>new eL),eT=et(()=>new e_),eP=(et(()=>new ek),Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9])),ez=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),eD=new Uint32Array(32);function eF(e,t,r,i,n,o){let s=n[o],f=n[o+1],a=eD[2*e],l=eD[2*e+1],h=eD[2*t],c=eD[2*t+1],u=eD[2*r],d=eD[2*r+1],p=eD[2*i],b=eD[2*i+1],g=B(a,h,s);l=O(g,l,c,f),a=0|g,({Dh:b,Dl:p}={Dh:b^l,Dl:p^a}),({Dh:b,Dl:p}={Dh:p,Dl:b}),({h:d,l:u}=I(d,u,b,p)),({Bh:c,Bl:h}={Bh:c^d,Bl:h^u}),({Bh:c,Bl:h}={Bh:x(c,h,24),Bl:v(c,h,24)}),eD[2*e]=a,eD[2*e+1]=l,eD[2*t]=h,eD[2*t+1]=c,eD[2*r]=u,eD[2*r+1]=d,eD[2*i]=p,eD[2*i+1]=b}function eH(e,t,r,i,n,o){let s=n[o],f=n[o+1],a=eD[2*e],l=eD[2*e+1],h=eD[2*t],c=eD[2*t+1],u=eD[2*r],d=eD[2*r+1],p=eD[2*i],b=eD[2*i+1],g=B(a,h,s);l=O(g,l,c,f),a=0|g,({Dh:b,Dl:p}={Dh:b^l,Dl:p^a}),({Dh:b,Dl:p}={Dh:x(b,p,16),Dl:v(b,p,16)}),({h:d,l:u}=I(d,u,b,p)),({Bh:c,Bl:h}={Bh:c^d,Bl:h^u}),({Bh:c,Bl:h}={Bh:E(c,h,63),Bl:A(c,h,63)}),eD[2*e]=a,eD[2*e+1]=l,eD[2*t]=h,eD[2*t+1]=c,eD[2*r]=u,eD[2*r+1]=d,eD[2*i]=p,eD[2*i+1]=b}class eV extends ee{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,k(e),k(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=z(this.buffer)}update(e){T(this),R(e=J(e));let{blockLen:t,buffer:r,buffer32:i}=this,n=e.length,o=e.byteOffset,s=e.buffer;for(let f=0;f<n;){this.pos===t&&(X(i),this.compress(i,0,!1),X(i),this.pos=0);let a=Math.min(t-this.pos,n-f),l=o+f;if(a===t&&!(l%4)&&f+a<n){let e=new Uint32Array(s,l,Math.floor((n-f)/4));X(e);for(let r=0;f+t<n;r+=i.length,f+=t)this.length+=t,this.compress(e,r,!1);X(e);continue}r.set(e.subarray(f,f+a),this.pos),this.pos+=a,this.length+=a,f+=a}return this}digestInto(e){T(this),P(e,this);let{pos:t,buffer32:r}=this;this.finished=!0,D(this.buffer.subarray(t)),X(r),this.compress(r,0,!0),X(r);let i=z(e);this.get().forEach((e,t)=>i[t]=q(e))}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){let{buffer:t,length:r,finished:i,destroyed:n,outputLen:o,pos:s}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(t),e.destroyed=n,e.finished=i,e.length=r,e.pos=s,e.outputLen=o,e}clone(){return this._cloneInto()}}class eM extends eV{constructor(e={}){const t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|ez[0],this.v0h=0|ez[1],this.v1l=0|ez[2],this.v1h=0|ez[3],this.v2l=0|ez[4],this.v2h=0|ez[5],this.v3l=0|ez[6],this.v3h=0|ez[7],this.v4l=0|ez[8],this.v4h=0|ez[9],this.v5l=0|ez[10],this.v5h=0|ez[11],this.v6l=0|ez[12],this.v6h=0|ez[13],this.v7l=0|ez[14],this.v7h=0|ez[15],function(e,t={},r,i,n){if(k(64),e<0||e>64)throw Error("outputLen bigger than keyLen");let{key:o,salt:s,personalization:f}=t;if(void 0!==o&&(o.length<1||o.length>64))throw Error("key length must be undefined or 1..64");if(void 0!==s&&16!==s.length)throw Error("salt must be undefined or 16");if(void 0!==f&&16!==f.length)throw Error("personalization must be undefined or 16")}(t,e,0,0,0);let{key:r,personalization:i,salt:n}=e,o=0;if(void 0!==r&&(o=(r=J(r)).length),this.v0l^=this.outputLen|o<<8|0x1010000,void 0!==n){const e=z(n=J(n));this.v4l^=q(e[0]),this.v4h^=q(e[1]),this.v5l^=q(e[2]),this.v5h^=q(e[3])}if(void 0!==i){const e=z(i=J(i));this.v6l^=q(e[0]),this.v6h^=q(e[1]),this.v7l^=q(e[2]),this.v7h^=q(e[3])}if(void 0!==r){const e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:i,v2l:n,v2h:o,v3l:s,v3h:f,v4l:a,v4h:l,v5l:h,v5h:c,v6l:u,v6h:d,v7l:p,v7h:b}=this;return[e,t,r,i,n,o,s,f,a,l,h,c,u,d,p,b]}set(e,t,r,i,n,o,s,f,a,l,h,c,u,d,p,b){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|i,this.v2l=0|n,this.v2h=0|o,this.v3l=0|s,this.v3h=0|f,this.v4l=0|a,this.v4h=0|l,this.v5l=0|h,this.v5h=0|c,this.v6l=0|u,this.v6h=0|d,this.v7l=0|p,this.v7h=0|b}compress(e,t,r){this.get().forEach((e,t)=>eD[t]=e),eD.set(ez,16);let{h:i,l:n}=g(BigInt(this.length));eD[24]=ez[8]^n,eD[25]=ez[9]^i,r&&(eD[28]=~eD[28],eD[29]=~eD[29]);let o=0;for(let r=0;r<12;r++)eF(0,4,8,12,e,t+2*eP[o++]),eH(0,4,8,12,e,t+2*eP[o++]),eF(1,5,9,13,e,t+2*eP[o++]),eH(1,5,9,13,e,t+2*eP[o++]),eF(2,6,10,14,e,t+2*eP[o++]),eH(2,6,10,14,e,t+2*eP[o++]),eF(3,7,11,15,e,t+2*eP[o++]),eH(3,7,11,15,e,t+2*eP[o++]),eF(0,5,10,15,e,t+2*eP[o++]),eH(0,5,10,15,e,t+2*eP[o++]),eF(1,6,11,12,e,t+2*eP[o++]),eH(1,6,11,12,e,t+2*eP[o++]),eF(2,7,8,13,e,t+2*eP[o++]),eH(2,7,8,13,e,t+2*eP[o++]),eF(3,4,9,14,e,t+2*eP[o++]),eH(3,4,9,14,e,t+2*eP[o++]);this.v0l^=eD[0]^eD[16],this.v0h^=eD[1]^eD[17],this.v1l^=eD[2]^eD[18],this.v1h^=eD[3]^eD[19],this.v2l^=eD[4]^eD[20],this.v2h^=eD[5]^eD[21],this.v3l^=eD[6]^eD[22],this.v3h^=eD[7]^eD[23],this.v4l^=eD[8]^eD[24],this.v4h^=eD[9]^eD[25],this.v5l^=eD[10]^eD[26],this.v5h^=eD[11]^eD[27],this.v6l^=eD[12]^eD[28],this.v6h^=eD[13]^eD[29],this.v7l^=eD[14]^eD[30],this.v7h^=eD[15]^eD[31],D(eD)}destroy(){this.destroyed=!0,D(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}function eq(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function eX(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}function eW(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function eY(e,...t){if(!eq(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function eZ(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function eK(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function eG(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}a=e=>new eM(e),(t=(e,t)=>a(t).update(J(e)).digest()).outputLen=(r=a({})).outputLen,t.blockLen=r.blockLen,t.create=e=>a(e),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let e$=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function eJ(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(eq(e))e=e1(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function eQ(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function e0(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>n&o),f=Number(r&o),a=4*!!i,l=4*!i;e.setUint32(t+a,s,i),e.setUint32(t+l,f,i)}function e1(e){return Uint8Array.from(e)}let e2=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),e8=e2("expand 16-byte k"),e6=e2("expand 32-byte k"),e3=eK(e8),e5=eK(e6);function e4(e,t){return e<<t|e>>>32-t}function e7(e){return e.byteOffset%4==0}let e9=0x100000000-1,te=new Uint32Array,tt=(e,t)=>255&e[t++]|(255&e[t++])<<8;class tr{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,eY(e=eJ(e),32);const t=tt(e,0),r=tt(e,2),i=tt(e,4),n=tt(e,6),o=tt(e,8),s=tt(e,10),f=tt(e,12),a=tt(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|n<<9)&8191,this.r[4]=(n>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|s<<2)&8191,this.r[7]=(s>>>11|f<<5)&8065,this.r[8]=(f>>>8|a<<8)&8191,this.r[9]=a>>>5&127;for(let t=0;t<8;t++)this.pad[t]=tt(e,16+2*t)}process(e,t,r=!1){let{h:i,r:n}=this,o=n[0],s=n[1],f=n[2],a=n[3],l=n[4],h=n[5],c=n[6],u=n[7],d=n[8],p=n[9],b=tt(e,t+0),g=tt(e,t+2),y=tt(e,t+4),w=tt(e,t+6),m=tt(e,t+8),x=tt(e,t+10),v=tt(e,t+12),E=tt(e,t+14),A=i[0]+(8191&b),I=i[1]+((b>>>13|g<<3)&8191),B=i[2]+((g>>>10|y<<6)&8191),O=i[3]+((y>>>7|w<<9)&8191),C=i[4]+((w>>>4|m<<12)&8191),S=i[5]+(m>>>1&8191),U=i[6]+((m>>>14|x<<2)&8191),L=i[7]+((x>>>11|v<<5)&8191),_=i[8]+((v>>>8|E<<8)&8191),N=i[9]+(E>>>5|2048*!r),k=0,R=0+A*o+5*p*I+5*d*B+5*u*O+5*c*C;k=R>>>13,R&=8191,R+=5*h*S+5*l*U+5*a*L+5*f*_+5*s*N,k+=R>>>13,R&=8191;let j=k+A*s+I*o+5*p*B+5*d*O+5*u*C;k=j>>>13,j&=8191,j+=5*c*S+5*h*U+5*l*L+5*a*_+5*f*N,k+=j>>>13,j&=8191;let T=k+A*f+I*s+B*o+5*p*O+5*d*C;k=T>>>13,T&=8191,T+=5*u*S+5*c*U+5*h*L+5*l*_+5*a*N,k+=T>>>13,T&=8191;let P=k+A*a+I*f+B*s+O*o+5*p*C;k=P>>>13,P&=8191,P+=5*d*S+5*u*U+5*c*L+5*h*_+5*l*N,k+=P>>>13,P&=8191;let z=k+A*l+I*a+B*f+O*s+C*o;k=z>>>13,z&=8191,z+=5*p*S+5*d*U+5*u*L+5*c*_+5*h*N,k+=z>>>13,z&=8191;let D=k+A*h+I*l+B*a+O*f+C*s;k=D>>>13,D&=8191,D+=S*o+5*p*U+5*d*L+5*u*_+5*c*N,k+=D>>>13,D&=8191;let F=k+A*c+I*h+B*l+O*a+C*f;k=F>>>13,F&=8191,F+=S*s+U*o+5*p*L+5*d*_+5*u*N,k+=F>>>13,F&=8191;let H=k+A*u+I*c+B*h+O*l+C*a;k=H>>>13,H&=8191,H+=S*f+U*s+L*o+5*p*_+5*d*N,k+=H>>>13,H&=8191;let V=k+A*d+I*u+B*c+O*h+C*l;k=V>>>13,V&=8191,V+=S*a+U*f+L*s+_*o+5*p*N,k+=V>>>13,V&=8191;let M=k+A*p+I*d+B*u+O*c+C*h;k=M>>>13,M&=8191,M+=S*l+U*a+L*f+_*s+N*o,k+=M>>>13,M&=8191,R=8191&(k=(k=(k<<2)+k|0)+R|0),k>>>=13,j+=k,i[0]=R,i[1]=j,i[2]=T,i[3]=P,i[4]=z,i[5]=D,i[6]=F,i[7]=H,i[8]=V,i[9]=M}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let n=(1^i)-1;for(let e=0;e<10;e++)r[e]&=n;n=~n;for(let t=0;t<10;t++)e[t]=e[t]&n|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=65535&o;for(let r=1;r<8;r++)o=(e[r]+t[r]|0)+(o>>>16)|0,e[r]=65535&o;eG(r)}update(e){eZ(this),eY(e=eJ(e));let{buffer:t,blockLen:r}=this,i=e.length;for(let n=0;n<i;){let o=Math.min(r-this.pos,i-n);if(o===r){for(;r<=i-n;n+=r)this.process(e,n);continue}t.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){eG(this.h,this.r,this.buffer,this.pad)}digestInto(e){eZ(this),function(e,t){eY(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let n=0;for(let t=0;t<8;t++)e[n++]=r[t]>>>0,e[n++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let ti=(l=e=>new tr(e),(i=(e,t)=>l(t).update(eJ(e)).digest()).outputLen=(n=l(new Uint8Array(32))).outputLen,i.blockLen=n.blockLen,i.create=e=>l(e),i),tn=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:o,rounds:s}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return eW(n),eW(s),eX(o),eX(r),(t,f,a,l,h=0)=>{eY(t),eY(f),eY(a);let c=a.length;if(void 0===l&&(l=new Uint8Array(c)),eY(l),eW(h),h<0||h>=e9)throw Error("arx: counter overflow");if(l.length<c)throw Error(`arx: output (${l.length}) is shorter than data (${c})`);let u=[],d=t.length,p,b;if(32===d)u.push(p=e1(t)),b=e5;else if(16===d&&r)(p=new Uint8Array(32)).set(t),p.set(t,16),b=e3,u.push(p);else throw Error(`arx: invalid 32-byte key, got length=${d}`);e7(f)||u.push(f=e1(f));let g=eK(p);if(i){if(24!==f.length)throw Error("arx: extended nonce must be 24 bytes");i(b,g,eK(f.subarray(0,16)),g),f=f.subarray(16)}let y=16-n;if(y!==f.length)throw Error(`arx: nonce must be ${y} or 16 bytes`);if(12!==y){let e=new Uint8Array(12);e.set(f,o?0:12-f.length),f=e,u.push(f)}return function(e,t,r,i,n,o,s,f){let a=n.length,l=new Uint8Array(64),h=eK(l),c=e7(n)&&e7(o),u=c?eK(n):te,d=c?eK(o):te;for(let p=0;p<a;s++){if(e(t,r,i,h,s,f),s>=e9)throw Error("arx: counter overflow");let b=Math.min(64,a-p);if(c&&64===b){let e=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)d[r=e+t]=u[r]^h[t];p+=64;continue}for(let e=0,t;e<b;e++)o[t=p+e]=n[t]^l[e];p+=b}}(e,b,g,eK(f),a,l,h,s),eG(...u),l}}(function(e,t,r,i,n,o=20){let s=e[0],f=e[1],a=e[2],l=e[3],h=t[0],c=t[1],u=t[2],d=t[3],p=t[4],b=t[5],g=t[6],y=t[7],w=r[0],m=r[1],x=r[2],v=s,E=f,A=a,I=l,B=h,O=c,C=u,S=d,U=p,L=b,_=g,N=y,k=n,R=w,j=m,T=x;for(let e=0;e<o;e+=2)U=U+(k=e4(k^(v=v+B|0),16))|0,v=v+(B=e4(B^U,12))|0,U=U+(k=e4(k^v,8))|0,B=e4(B^U,7),L=L+(R=e4(R^(E=E+O|0),16))|0,E=E+(O=e4(O^L,12))|0,L=L+(R=e4(R^E,8))|0,O=e4(O^L,7),_=_+(j=e4(j^(A=A+C|0),16))|0,A=A+(C=e4(C^_,12))|0,_=_+(j=e4(j^A,8))|0,C=e4(C^_,7),N=N+(T=e4(T^(I=I+S|0),16))|0,I=I+(S=e4(S^N,12))|0,N=N+(T=e4(T^I,8))|0,S=e4(S^N,7),_=_+(T=e4(T^(v=v+O|0),16))|0,v=v+(O=e4(O^_,12))|0,_=_+(T=e4(T^v,8))|0,O=e4(O^_,7),N=N+(k=e4(k^(E=E+C|0),16))|0,E=E+(C=e4(C^N,12))|0,N=N+(k=e4(k^E,8))|0,C=e4(C^N,7),U=U+(R=e4(R^(A=A+S|0),16))|0,A=A+(S=e4(S^U,12))|0,U=U+(R=e4(R^A,8))|0,S=e4(S^U,7),L=L+(j=e4(j^(I=I+B|0),16))|0,I=I+(B=e4(B^L,12))|0,L=L+(j=e4(j^I,8))|0,B=e4(B^L,7);let P=0;i[P++]=s+v|0,i[P++]=f+E|0,i[P++]=a+A|0,i[P++]=l+I|0,i[P++]=h+B|0,i[P++]=c+O|0,i[P++]=u+C|0,i[P++]=d+S|0,i[P++]=p+U|0,i[P++]=b+L|0,i[P++]=g+_|0,i[P++]=y+N|0,i[P++]=n+k|0,i[P++]=w+R|0,i[P++]=m+j|0,i[P++]=x+T|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),to=new Uint8Array(16),ts=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(to.subarray(r))},tf=new Uint8Array(32);function ta(e,t,r,i,n){var o,s;let f,a,l=e(t,r,tf),h=ti.create(l);n&&ts(h,n),ts(h,i);let c=(o=i.length,s=n?n.length:0,eX(!0),e0(a=new DataView((f=new Uint8Array(16)).buffer,f.byteOffset,f.byteLength),0,BigInt(s),!0),e0(a,8,BigInt(o),!0),f);h.update(c);let u=h.digest();return eG(l,c),u}s={blockSize:64,nonceLength:12,tagLength:16},f=(e,t,r)=>({encrypt(i,n){let o=i.length;(n=eQ(o+16,n,!1)).set(i);let s=n.subarray(0,-16);tn(e,t,s,s,1);let f=ta(tn,e,t,s,r);return n.set(f,o),eG(f),n},decrypt(i,n){n=eQ(i.length-16,n,!1);let o=i.subarray(0,-16),s=i.subarray(-16),f=ta(tn,e,t,o,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(s,f))throw Error("invalid tag");return n.set(i.subarray(0,-16)),tn(e,t,n,n,1),eG(f),n}}),Object.assign(function(e,...t){if(eY(e),!e$)throw Error("Non little-endian hardware is not yet supported");if(void 0!==s.nonceLength){let e=t[0];if(!e)throw Error("nonce / iv required");s.varSizeNonce?eY(e):eY(e,s.nonceLength)}let r=s.tagLength;r&&void 0!==t[1]&&eY(t[1]);let i=f(e,...t),n=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");eY(t)}},o=!1;return{encrypt(e,t){if(o)throw Error("cannot encrypt() twice with same key + nonce");return o=!0,eY(e),n(i.encrypt.length,t),i.encrypt(e,t)},decrypt(e,t){if(eY(e),r&&e.length<r)throw Error("invalid ciphertext length: smaller than tagLength="+r);return n(i.decrypt.length,t),i.decrypt(e,t)}}},s);class tl extends ee{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,j(e);const r=J(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<n.length;e++)n[e]^=54;this.iHash.update(n),this.oHash=e.create();for(let e=0;e<n.length;e++)n[e]^=106;this.oHash.update(n),D(n)}update(e){return T(this),this.iHash.update(e),this}digestInto(e){T(this),R(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:o,outputLen:s}=this;return e.finished=i,e.destroyed=n,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let th=(e,t,r)=>new tl(e,t).update(r).digest();th.create=(e,t)=>new tl(e,t),Uint8Array.from([0]),Uint8Array.of();let tc=BigInt(0),tu=BigInt(1);function td(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function tp(e,t,r=""){let i=N(e),n=e?.length,o=void 0!==t;if(!i||o&&n!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(o?` of length ${t}`:"")+", got "+(i?`length=${n}`:`type=${typeof e}`));return e}function tb(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function tg(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?tc:BigInt("0x"+e)}function ty(e){return R(e),tg(Z(Uint8Array.from(e).reverse()))}function tw(e,t){return G(e.toString(16).padStart(2*t,"0"))}function tm(e,t){return tw(e,t).reverse()}function tx(e,t,r){let i;if("string"==typeof t)try{i=G(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(N(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}let tv=e=>"bigint"==typeof e&&tc<=e;function tE(e,t,r,i){if(!(tv(t)&&tv(r)&&tv(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}function tA(e){let t;for(t=0;e>tc;e>>=tu,t+=1);return t}let tI=e=>(tu<<BigInt(e))-tu;function tB(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function i(t,r,i){let n=e[t];if(i&&void 0===n)return;let o=typeof n;if(o!==r||null===n)throw Error(`param "${t}" is invalid: expected ${r}, got ${o}`)}Object.entries(t).forEach(([e,t])=>i(e,t,!1)),Object.entries(r).forEach(([e,t])=>i(e,t,!0))}function tO(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let o=e(r,...i);return t.set(r,o),o}}let tC=BigInt(0),tS=BigInt(1),tU=BigInt(2),tL=BigInt(3),t_=BigInt(4),tN=BigInt(5),tk=BigInt(7),tR=BigInt(8),tj=BigInt(9),tT=BigInt(16);function tP(e,t){let r=e%t;return r>=tC?r:t+r}function tz(e,t,r){let i=e;for(;t-- >tC;)i*=i,i%=r;return i}function tD(e,t){if(e===tC)throw Error("invert: expected non-zero number");if(t<=tC)throw Error("invert: expected positive modulus, got "+t);let r=tP(e,t),i=t,n=tC,o=tS;for(;r!==tC;){let e=i/r,t=i%r,s=n-o*e;i=r,r=t,n=o,o=s}if(i!==tS)throw Error("invert: does not exist");return tP(n,t)}function tF(e,t,r){if(!e.eql(e.sqr(t),r))throw Error("Cannot find square root")}function tH(e,t){let r=(e.ORDER+tS)/t_,i=e.pow(t,r);return tF(e,i,t),i}function tV(e,t){let r=(e.ORDER-tN)/tR,i=e.mul(t,tU),n=e.pow(i,r),o=e.mul(t,n),s=e.mul(e.mul(o,tU),n),f=e.mul(o,e.sub(s,e.ONE));return tF(e,f,t),f}function tM(e){if(e<tL)throw Error("sqrt is not defined for small field");let t=e-tS,r=0;for(;t%tU===tC;)t/=tU,r++;let i=tU,n=tZ(e);for(;1===tW(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return tH;let o=n.pow(i,t),s=(t+tS)/tU;return function(e,i){if(e.is0(i))return i;if(1!==tW(e,i))throw Error("Cannot find square root");let n=r,f=e.mul(e.ONE,o),a=e.pow(i,t),l=e.pow(i,s);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===n)throw Error("Cannot find square root");let i=tS<<BigInt(n-t-1),o=e.pow(f,i);n=t,f=e.sqr(o),a=e.mul(a,f),l=e.mul(l,o)}return l}}let tq=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tX(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),o=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),o),i}function tW(e,t){let r=(e.ORDER-tS)/tU,i=e.pow(t,r),n=e.eql(i,e.ONE),o=e.eql(i,e.ZERO),s=e.eql(i,e.neg(e.ONE));if(!n&&!o&&!s)throw Error("invalid Legendre symbol result");return n?1:o?0:-1}function tY(e,t){void 0!==t&&k(t);let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function tZ(e,t,r=!1,i={}){let n;if(e<=tC)throw Error("invalid field: expected ORDER > 0, got "+e);let o,s,f=!1,a;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw Error("cannot specify opts in two arguments");t.BITS&&(o=t.BITS),t.sqrt&&(s=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(f=t.modFromBytes),a=t.allowedLengths}else"number"==typeof t&&(o=t),i.sqrt&&(s=i.sqrt);let{nBitLength:l,nByteLength:h}=tY(e,o);if(h>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let c=Object.freeze({ORDER:e,isLE:r,BITS:l,BYTES:h,MASK:tI(l),ZERO:tC,ONE:tS,allowedLengths:a,create:t=>tP(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return tC<=t&&t<e},is0:e=>e===tC,isValidNot0:e=>!c.is0(e)&&c.isValid(e),isOdd:e=>(e&tS)===tS,neg:t=>tP(-t,e),eql:(e,t)=>e===t,sqr:t=>tP(t*t,e),add:(t,r)=>tP(t+r,e),sub:(t,r)=>tP(t-r,e),mul:(t,r)=>tP(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<tC)throw Error("invalid exponent, negatives unsupported");if(r===tC)return e.ONE;if(r===tS)return t;let i=e.ONE,n=t;for(;r>tC;)r&tS&&(i=e.mul(i,n)),n=e.sqr(n),r>>=tS;return i})(c,e,t),div:(t,r)=>tP(t*tD(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>tD(t,e),sqrt:s||(t=>{let r,i,o,s,f,a;return n||(n=e%t_===tL?tH:e%tR===tN?tV:e%tT===tj?(r=tZ(e),o=(i=tM(e))(r,r.neg(r.ONE)),s=i(r,o),f=i(r,r.neg(o)),a=(e+tk)/tT,(e,t)=>{let r=e.pow(t,a),i=e.mul(r,o),n=e.mul(r,s),l=e.mul(r,f),h=e.eql(e.sqr(i),t),c=e.eql(e.sqr(n),t);r=e.cmov(r,i,h),i=e.cmov(l,n,c);let u=e.eql(e.sqr(i),t),d=e.cmov(r,i,u);return tF(e,d,t),d}):tM(e)),n(c,t)}),toBytes:e=>r?tm(e,h):tw(e,h),fromBytes:(t,i=!0)=>{if(a){if(!a.includes(t.length)||t.length>h)throw Error("Field.fromBytes: expected "+a+" bytes, got "+t.length);let e=new Uint8Array(h);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==h)throw Error("Field.fromBytes: expected "+h+" bytes, got "+t.length);let n=r?ty(t):tg(Z(t));if(f&&(n=tP(n,e)),!i&&!c.isValid(n))throw Error("invalid field element: outside of range 0..ORDER");return n},invertBatch:e=>tX(c,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(c)}function tK(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function tG(e){let t=tK(e);return t+Math.ceil(t/2)}let t$=BigInt(0),tJ=BigInt(1);function tQ(e,t){let r=t.negate();return e?r:t}function t0(e,t){let r=tX(e.Fp,t.map(e=>e.Z));return t.map((t,i)=>e.fromAffine(t.toAffine(r[i])))}function t1(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function t2(e,t){t1(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:tI(e),maxNumber:n,shiftBy:BigInt(e)}}function t8(e,t,r){let{windowSize:i,mask:n,maxNumber:o,shiftBy:s}=r,f=Number(e&n),a=e>>s;f>i&&(f-=o,a+=tJ);let l=t*i;return{nextN:a,offset:l+Math.abs(f)-1,isZero:0===f,isNeg:f<0,isNegF:t%2!=0,offsetF:l}}let t6=new WeakMap,t3=new WeakMap;function t5(e){return t3.get(e)||1}function t4(e){if(e!==t$)throw Error("invalid wNAF")}class t7{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>t$;)t&tJ&&(r=r.add(i)),i=i.double(),t>>=tJ;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=t2(t,this.bits),n=[],o=e,s=o;for(let e=0;e<r;e++){s=o,n.push(s);for(let e=1;e<i;e++)s=s.add(o),n.push(s);o=s.double()}return n}wNAF(e,t,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let i=this.ZERO,n=this.BASE,o=t2(e,this.bits);for(let e=0;e<o.windows;e++){let{nextN:s,offset:f,isZero:a,isNeg:l,isNegF:h,offsetF:c}=t8(r,e,o);r=s,a?n=n.add(tQ(h,t[c])):i=i.add(tQ(l,t[f]))}return t4(r),{p:i,f:n}}wNAFUnsafe(e,t,r,i=this.ZERO){let n=t2(e,this.bits);for(let e=0;e<n.windows&&r!==t$;e++){let{nextN:o,offset:s,isZero:f,isNeg:a}=t8(r,e,n);if(r=o,!f){let e=t[s];i=i.add(a?e.negate():e)}}return t4(r),i}getPrecomputes(e,t,r){let i=t6.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(i=r(i)),t6.set(t,i))),i}cached(e,t,r){let i=t5(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let n=t5(e);return 1===n?this._unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)}createCache(e,t){t1(t,this.bits),t3.set(e,t),t6.delete(e)}hasCache(e){return 1!==t5(e)}}function t9(e,t,r){if(!t)return tZ(e,{isLE:r});if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return tB(t,tq.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}BigInt(0),BigInt(1),BigInt(2),BigInt(8),$("HashToScalar-");let re=BigInt(0),rt=BigInt(1),rr=BigInt(2),ri=BigInt(1),rn=BigInt(2),ro=BigInt(3),rs=BigInt(5),rf=BigInt(8),ra=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),rl={p:ra,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:rf,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")},rh=(function(e){let{P:t,type:r,adjustScalarBytes:i,powPminus2:n,randomBytes:o}=(tB(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})),s="x25519"===r;if(!s&&"x448"!==r)throw Error("invalid type");let f=s?32:56,a=BigInt(s?9:5),l=BigInt(s?121665:39081),h=s?rr**BigInt(254):rr**BigInt(447),c=h+(s?BigInt(8)*rr**BigInt(251)-rt:BigInt(4)*rr**BigInt(445)-rt)+rt,u=e=>tP(e,t),d=tm(u(a),f);d.slice()}({P:o=tZ(rl.p,{isLE:!0}).ORDER,type:"x25519",powPminus2:e=>{let t,r,i,n,s,f,a,l,h,c,u,d,p,b,{pow_p_5_8:g,b2:y}=(t=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),f=tz(s=e*e%ra*e%ra,rn,ra)*s%ra,a=tz(f,ri,ra)*e%ra,l=tz(a,rs,ra)*a%ra,h=tz(l,t,ra)*l%ra,c=tz(h,r,ra)*h%ra,u=tz(c,i,ra)*c%ra,d=tz(u,n,ra)*u%ra,p=tz(d,n,ra)*u%ra,b=tz(p,t,ra)*l%ra,{pow_p_5_8:tz(b,rn,ra)*e%ra,b2:s});return tP(tz(g,ro,o)*y,o)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}}),(e,t)=>(e+(e>=0?t:-t)/rg)/t);function rc(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function ru(e,t){let r={};for(let i of Object.keys(t))r[i]=void 0===e[i]?t[i]:e[i];return td(r.lowS,"lowS"),td(r.prehash,"prehash"),void 0!==r.format&&rc(r.format),r}let rd={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=rd;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=tb(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let o=i>127?tb(n.length/2|128):"";return tb(e)+o+n+t},decode(e,t){let{Err:r}=rd,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],o=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let s=t.subarray(i,i+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of s)o=o<<8|e;if(i+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=n;let s=t.subarray(i,i+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(i+o)}}},_int:{encode(e){let{Err:t}=rd;if(e<rp)throw new t("integer: negative integers are not allowed");let r=tb(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=rd;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return tg(Z(e))}},toSig(e){let{Err:t,_int:r,_tlv:i}=rd,n=tx("signature",e),{v:o,l:s}=i.decode(48,n);if(s.length)throw new t("invalid signature: left bytes after parsing");let{v:f,l:a}=i.decode(2,o),{v:l,l:h}=i.decode(2,a);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(f),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=rd,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},rp=BigInt(0),rb=BigInt(1),rg=BigInt(2),ry=BigInt(3),rw=BigInt(4);function rm(e,t){let r,{BYTES:i}=e;if("bigint"==typeof t)r=t;else{let n=tx("private key",t);try{r=e.fromBytes(n)}catch{throw Error(`invalid private key: expected ui8a of size ${i}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw Error("invalid private key: out of range [1..N-1]");return r}function rx(e){return Uint8Array.of(e?2:3)}function rv(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function rE(e,t){let r=t=>(function(e){let t,{CURVE:r,curveOpts:i,hash:n,ecdsaOpts:o}=function(e){let t,r,i,n,{CURVE:o,curveOpts:s}=(t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,i=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,n={Fp:r,Fn:tZ(t.n,{BITS:e.nBitLength,allowedLengths:i,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes},{CURVE:t,curveOpts:n}),f={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:o,curveOpts:s,hash:e.hash,ecdsaOpts:f}}(e),s=function(e,t,r={}){j(t),tB(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let i=r.randomBytes||er,n=r.hmac||((e,...r)=>th(t,e,Q(...r))),{Fp:o,Fn:s}=e,{ORDER:f,BITS:a}=s,{keygen:l,getPublicKey:h,getSharedSecret:c,utils:u,lengths:d}=function(e,t={}){let{Fn:r}=e,i=t.randomBytes||er,n=Object.assign(rv(e.Fp,r),{seed:tG(r.ORDER)});function o(e){try{return!!rm(r,e)}catch{return!1}}function s(e=i(n.seed)){return function(e,t,r=!1){let i=e.length,n=tK(t),o=tG(t);if(i<16||i<o||i>1024)throw Error("expected "+o+"-1024 bytes of input, got "+i);let s=tP(r?ty(e):tg(Z(e)),t-tS)+tS;return r?tm(s,n):tw(s,n)}(tp(e,n.seed,"seed"),r.ORDER)}function f(t,i=!0){return e.BASE.multiply(rm(r,t)).toBytes(i)}function a(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:i,publicKey:o,publicKeyUncompressed:s}=n;if(r.allowedLengths||i===o)return;let f=tx("key",t).length;return f===o||f===s}return Object.freeze({getPublicKey:f,getSharedSecret:function(t,i,n=!0){if(!0===a(t))throw Error("first arg must be private key");if(!1===a(i))throw Error("second arg must be public key");let o=rm(r,t);return e.fromHex(i).multiply(o).toBytes(n)},keygen:function(e){let t=s(e);return{secretKey:t,publicKey:f(t)}},Point:e,utils:{isValidSecretKey:o,isValidPublicKey:function(t,r){let{publicKey:i,publicKeyUncompressed:o}=n;try{let n=t.length;return(!0!==r||n===i)&&(!1!==r||n===o)&&!!e.fromBytes(t)}catch{return!1}},randomSecretKey:s,isValidPrivateKey:o,randomPrivateKey:s,normPrivateKeyToScalar:e=>rm(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:n})}(e,r),p={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},b="compact";function g(e,t){if(!s.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class y{constructor(e,t,r){this.r=g("r",e),this.s=g("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=b){var r,i;let n,o;if(r=e,rc(i=t),o=d.signature,tp(r,"compact"===i?o:"recovered"===i?o+1:void 0,`${i} signature`),"der"===t){let{r:t,s:r}=rd.toSig(tp(e));return new y(t,r)}"recovered"===t&&(n=e[0],t="compact",e=e.subarray(1));let f=s.BYTES,a=e.subarray(0,f),l=e.subarray(f,2*f);return new y(s.fromBytes(a),s.fromBytes(l),n)}static fromHex(e,t){return this.fromBytes(G(e),t)}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(t){let r=o.ORDER,{r:i,s:n,recovery:a}=this;if(null==a||![0,1,2,3].includes(a))throw Error("recovery id invalid");if(f*rg<r&&a>1)throw Error("recovery id is ambiguous for h>1 curve");let l=2===a||3===a?i+f:i;if(!o.isValid(l))throw Error("recovery id 2 or 3 invalid");let h=o.toBytes(l),c=e.fromBytes(Q(rx((1&a)==0),h)),u=s.inv(l),d=m(tx("msgHash",t)),p=s.create(-d*u),b=s.create(n*u),g=e.BASE.multiplyUnsafe(p).add(c.multiplyUnsafe(b));if(g.is0())throw Error("point at infinify");return g.assertValidity(),g}hasHighS(){return this.s>f>>rb}toBytes(e=b){if(rc(e),"der"===e)return G(rd.hexFromSig(this));let t=s.toBytes(this.r),r=s.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return Q(Uint8Array.of(this.recovery),t,r)}return Q(t,r)}toHex(e){return Z(this.toBytes(e))}assertValidity(){}static fromCompact(e){return y.fromBytes(tx("sig",e),"compact")}static fromDER(e){return y.fromBytes(tx("sig",e),"der")}normalizeS(){return this.hasHighS()?new y(this.r,s.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Z(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Z(this.toBytes("compact"))}}let w=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=tg(Z(e)),r=8*e.length-a;return r>0?t>>BigInt(r):t},m=r.bits2int_modN||function(e){return s.create(w(e))},x=tI(a);function v(e){return tE("num < 2^"+a,e,rp,x),s.toBytes(e)}function E(e,r){return tp(e,void 0,"message"),r?tp(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:l,getPublicKey:h,getSharedSecret:c,utils:u,lengths:d,Point:e,sign:function(r,o,a={}){let{seed:l,k2sig:h}=function(t,r,n){if(["recovered","canonical"].some(e=>e in n))throw Error("sign() legacy options not supported");let{lowS:o,prehash:a,extraEntropy:l}=ru(n,p),h=m(t=E(t,a)),c=rm(s,r),u=[v(c),v(h)];if(null!=l&&!1!==l){let e=!0===l?i(d.secretKey):l;u.push(tx("extraEntropy",e))}return{seed:Q(...u),k2sig:function(t){let r=w(t);if(!s.isValidNot0(r))return;let i=s.inv(r),n=e.BASE.multiply(r).toAffine(),a=s.create(n.x);if(a===rp)return;let l=s.create(i*s.create(h+a*c));if(l===rp)return;let u=2*(n.x!==a)|Number(n.y&rb),d=l;return o&&l>f>>rb&&(d=s.neg(l),u^=1),new y(a,d,u)}}}(r=tx("message",r),o,a);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=e=>new Uint8Array(e),n=i(e),o=i(e),s=0,f=()=>{n.fill(1),o.fill(0),s=0},a=(...e)=>r(o,n,...e),l=(e=i(0))=>{o=a(Uint8Array.of(0),e),n=a(),0!==e.length&&(o=a(Uint8Array.of(1),e),n=a())},h=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(n=a()).slice();r.push(t),e+=n.length}return Q(...r)};return(e,t)=>{let r;for(f(),l(e);!(r=t(h()));)l();return f(),r}})(t.outputLen,s.BYTES,n)(l,h)},verify:function(t,r,i,n={}){let{lowS:o,prehash:f,format:a}=ru(n,p);if(i=tx("publicKey",i),r=E(tx("message",r),f),"strict"in n)throw Error("options.strict was renamed to lowS");let l=void 0===a?function(e){let t,r="string"==typeof e||N(e),i=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!i)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(i)t=new y(e.r,e.s);else if(r){try{t=y.fromBytes(tx("sig",e),"der")}catch(e){if(!(e instanceof rd.Err))throw e}if(!t)try{t=y.fromBytes(tx("sig",e),"compact")}catch{return!1}}return t||!1}(t):y.fromBytes(tx("sig",t),a);if(!1===l)return!1;try{let t=e.fromBytes(i);if(o&&l.hasHighS())return!1;let{r:n,s:f}=l,a=m(r),h=s.inv(f),c=s.create(a*h),u=s.create(n*h),d=e.BASE.multiplyUnsafe(c).add(t.multiplyUnsafe(u));return!d.is0()&&s.create(d.x)===n}catch{return!1}},recoverPublicKey:function(e,t,r={}){let{prehash:i}=ru(r,p);return t=E(t,i),y.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:y,hash:t})}(function(e,t={}){let r=function(e,t,r={},i){if(void 0===i&&(i="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>t$))throw Error(`CURVE.${e} must be positive bigint`)}let n=t9(t.p,r.Fp,i),o=t9(t.n,r.Fn,i);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!n.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:n,Fn:o}}("weierstrass",e,t),{Fp:i,Fn:n}=r,o=r.CURVE,{h:s,n:f}=o;tB(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:a}=t;if(a&&(!i.is0(o.a)||"bigint"!=typeof a.beta||!Array.isArray(a.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let l=rv(i,n);function h(){if(!i.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let c=t.toBytes||function(e,t,r){let{x:n,y:o}=t.toAffine(),s=i.toBytes(n);return(td(r,"isCompressed"),r)?(h(),Q(rx(!i.isOdd(o)),s)):Q(Uint8Array.of(4),s,i.toBytes(o))},u=t.fromBytes||function(e){tp(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:r}=l,n=e.length,o=e[0],s=e.subarray(1);if(n===t&&(2===o||3===o)){let e,t=i.fromBytes(s);if(!i.isValid(t))throw Error("bad point: is not on curve, wrong x");let r=d(t);try{e=i.sqrt(r)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return h(),(1&o)==1!==i.isOdd(e)&&(e=i.neg(e)),{x:t,y:e}}if(n===r&&4===o){let e=i.BYTES,t=i.fromBytes(s.subarray(0,e)),r=i.fromBytes(s.subarray(e,2*e));if(!p(t,r))throw Error("bad point: is not on curve");return{x:t,y:r}}throw Error(`bad point: got length ${n}, expected compressed=${t} or uncompressed=${r}`)};function d(e){let t=i.sqr(e),r=i.mul(t,e);return i.add(i.add(r,i.mul(e,o.a)),o.b)}function p(e,t){let r=i.sqr(t),n=d(e);return i.eql(r,n)}if(!p(o.Gx,o.Gy))throw Error("bad curve params: generator point");let b=i.mul(i.pow(o.a,ry),rw),g=i.mul(i.sqr(o.b),BigInt(27));if(i.is0(i.add(b,g)))throw Error("bad curve params: a or b");function y(e,t,r=!1){if(!i.isValid(t)||r&&i.is0(t))throw Error(`bad point coordinate ${e}`);return t}function w(e){if(!(e instanceof A))throw Error("ProjectivePoint expected")}function m(e){if(!a||!a.basises)throw Error("no endo");return function(e,t,r){let[[i,n],[o,s]]=t,f=rh(s*e,r),a=rh(-n*e,r),l=e-f*i-a*o,h=-f*n-a*s,c=l<rp,u=h<rp;c&&(l=-l),u&&(h=-h);let d=tI(Math.ceil(tA(r)/2))+rb;if(l<rp||l>=d||h<rp||h>=d)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:c,k1:l,k2neg:u,k2:h}}(e,a.basises,n.ORDER)}let x=tO((e,t)=>{let{X:r,Y:n,Z:o}=e;if(i.eql(o,i.ONE))return{x:r,y:n};let s=e.is0();null==t&&(t=s?i.ONE:i.inv(o));let f=i.mul(r,t),a=i.mul(n,t),l=i.mul(o,t);if(s)return{x:i.ZERO,y:i.ZERO};if(!i.eql(l,i.ONE))throw Error("invZ was invalid");return{x:f,y:a}}),v=tO(e=>{if(e.is0()){if(t.allowInfinityPoint&&!i.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:r,y:n}=e.toAffine();if(!i.isValid(r)||!i.isValid(n))throw Error("bad point: x or y not field elements");if(!p(r,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function E(e,t,r,n,o){return r=new A(i.mul(r.X,e),r.Y,r.Z),t=tQ(n,t),r=tQ(o,r),t.add(r)}class A{constructor(e,t,r){this.X=y("x",e),this.Y=y("y",t,!0),this.Z=y("z",r),Object.freeze(this)}static CURVE(){return o}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof A)throw Error("projective point not allowed");return i.is0(t)&&i.is0(r)?A.ZERO:new A(t,r,i.ONE)}static fromBytes(e){let t=A.fromAffine(u(tp(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return A.fromBytes(tx("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return B.createCache(this,e),t||this.multiply(ry),this}assertValidity(){v(this)}hasEvenY(){let{y:e}=this.toAffine();if(!i.isOdd)throw Error("Field doesn't support isOdd");return!i.isOdd(e)}equals(e){w(e);let{X:t,Y:r,Z:n}=this,{X:o,Y:s,Z:f}=e,a=i.eql(i.mul(t,f),i.mul(o,n)),l=i.eql(i.mul(r,f),i.mul(s,n));return a&&l}negate(){return new A(this.X,i.neg(this.Y),this.Z)}double(){let{a:e,b:t}=o,r=i.mul(t,ry),{X:n,Y:s,Z:f}=this,a=i.ZERO,l=i.ZERO,h=i.ZERO,c=i.mul(n,n),u=i.mul(s,s),d=i.mul(f,f),p=i.mul(n,s);return p=i.add(p,p),h=i.mul(n,f),h=i.add(h,h),a=i.mul(e,h),l=i.mul(r,d),l=i.add(a,l),a=i.sub(u,l),l=i.add(u,l),l=i.mul(a,l),a=i.mul(p,a),h=i.mul(r,h),d=i.mul(e,d),p=i.sub(c,d),p=i.mul(e,p),p=i.add(p,h),h=i.add(c,c),c=i.add(h,c),c=i.add(c,d),c=i.mul(c,p),l=i.add(l,c),d=i.mul(s,f),d=i.add(d,d),c=i.mul(d,p),a=i.sub(a,c),h=i.mul(d,u),h=i.add(h,h),new A(a,l,h=i.add(h,h))}add(e){w(e);let{X:t,Y:r,Z:n}=this,{X:s,Y:f,Z:a}=e,l=i.ZERO,h=i.ZERO,c=i.ZERO,u=o.a,d=i.mul(o.b,ry),p=i.mul(t,s),b=i.mul(r,f),g=i.mul(n,a),y=i.add(t,r),m=i.add(s,f);y=i.mul(y,m),m=i.add(p,b),y=i.sub(y,m),m=i.add(t,n);let x=i.add(s,a);return m=i.mul(m,x),x=i.add(p,g),m=i.sub(m,x),x=i.add(r,n),l=i.add(f,a),x=i.mul(x,l),l=i.add(b,g),x=i.sub(x,l),c=i.mul(u,m),l=i.mul(d,g),c=i.add(l,c),l=i.sub(b,c),c=i.add(b,c),h=i.mul(l,c),b=i.add(p,p),b=i.add(b,p),g=i.mul(u,g),m=i.mul(d,m),b=i.add(b,g),g=i.sub(p,g),g=i.mul(u,g),m=i.add(m,g),p=i.mul(b,m),h=i.add(h,p),p=i.mul(x,m),l=i.mul(y,l),l=i.sub(l,p),p=i.mul(y,b),c=i.mul(x,c),new A(l,h,c=i.add(c,p))}subtract(e){return this.add(e.negate())}is0(){return this.equals(A.ZERO)}multiply(e){let r,i,{endo:o}=t;if(!n.isValidNot0(e))throw Error("invalid scalar: out of range");let s=e=>B.cached(this,e,e=>t0(A,e));if(o){let{k1neg:t,k1:n,k2neg:f,k2:a}=m(e),{p:l,f:h}=s(n),{p:c,f:u}=s(a);i=h.add(u),r=E(o.beta,l,c,t,f)}else{let{p:t,f:n}=s(e);r=t,i=n}return t0(A,[r,i])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!n.isValid(e))throw Error("invalid scalar: out of range");if(e===rp||this.is0())return A.ZERO;if(e===rb)return this;if(B.hasCache(this))return this.multiply(e);if(!r)return B.unsafe(this,e);{let{k1neg:t,k1:i,k2neg:n,k2:o}=m(e),{p1:s,p2:f}=function(e,t,r,i){let n=t,o=e.ZERO,s=e.ZERO;for(;r>t$||i>t$;)r&tJ&&(o=o.add(n)),i&tJ&&(s=s.add(n)),n=n.double(),r>>=tJ,i>>=tJ;return{p1:o,p2:s}}(A,this,i,o);return E(r.beta,s,f,t,n)}}multiplyAndAddUnsafe(e,t,r){let i=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return i.is0()?void 0:i}toAffine(e){return x(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return s===rb||(e?e(A,this):B.unsafe(this,f).is0())}clearCofactor(){let{clearCofactor:e}=t;return s===rb?this:e?e(A,this):this.multiplyUnsafe(s)}isSmallOrder(){return this.multiplyUnsafe(s).is0()}toBytes(e=!0){return td(e,"isCompressed"),this.assertValidity(),c(A,this,e)}toHex(e=!0){return Z(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return t0(A,e)}static msm(e,t){return function(e,t,r,i){(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t);let n=r.length,o=i.length;if(n!==o)throw Error("arrays of points and scalars must have equal length");let s=e.ZERO,f=tA(BigInt(n)),a=1;f>12?a=f-3:f>4?a=f-2:f>0&&(a=2);let l=tI(a),h=Array(Number(l)+1).fill(s),c=Math.floor((t.BITS-1)/a)*a,u=s;for(let e=c;e>=0;e-=a){h.fill(s);for(let t=0;t<o;t++){let n=Number(i[t]>>BigInt(e)&l);h[n]=h[n].add(r[t])}let t=s;for(let e=h.length-1,r=s;e>0;e--)r=r.add(h[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<a;e++)u=u.double()}return u}(A,n,e,t)}static fromPrivateKey(e){return A.BASE.multiply(rm(n,e))}}A.BASE=new A(o.Gx,o.Gy,i.ONE),A.ZERO=new A(i.ZERO,i.ONE,i.ZERO),A.Fp=i,A.Fn=n;let I=n.BITS,B=new t7(A,t.endo?Math.ceil(I/2):I);return A.BASE.precompute(8),A}(r,i),n,o);return t=s.Point,Object.assign({},s,{ProjectivePoint:t,CURVE:Object.assign({},e,tY(t.Fn.ORDER,t.Fn.BITS))})})({...e,hash:t});return{...r(t),create:r}}let rA={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},rI={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},rB={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},rO=tZ(rA.p),rC=tZ(rI.p),rS=tZ(rB.p);rE({...rA,Fp:rO,lowS:!1},eR),rE({...rI,Fp:rC,lowS:!1},eT),rE({...rB,Fp:rS,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},ej),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,e.i(630510),e.i(808636),e.i(599531),e.i(846695),e.i(537910),d.ONE_DAY,d.SIX_HOURS,d.THIRTY_DAYS,d.FIVE_SECONDS,d.THIRTY_DAYS,d.ONE_DAY,d.ONE_DAY,d.THIRTY_SECONDS,d.THIRTY_SECONDS,d.ONE_DAY,d.ONE_DAY,d.ONE_DAY;var rU=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var o=e.charAt(n),s=o.charCodeAt(0);if(255!==r[s])throw TypeError(o+" is ambiguous");r[s]=n}var f=e.length,a=e.charAt(0),l=Math.log(f)/Math.log(256),h=Math.log(256)/Math.log(f);function c(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,n=0;e[t]===a;)i++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var c=0,u=o-1;(0!==h||c<n)&&-1!==u;u--,c++)h+=f*s[u]>>>0,s[u]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");n=c,t++}if(" "!==e[t]){for(var d=o-n;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(i+(o-d)),b=i;d!==o;)p[b++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,n=0,o=t.length;n!==o&&0===t[n];)n++,r++;for(var s=(o-n)*h+1>>>0,l=new Uint8Array(s);n!==o;){for(var c=t[n],u=0,d=s-1;(0!==c||u<i)&&-1!==d;d--,u++)c+=256*l[d]>>>0,l[d]=c%f>>>0,c=c/f>>>0;if(0!==c)throw Error("Non-zero carry");i=u,n++}for(var p=s-i;p!==s&&0===l[p];)p++;for(var b=a.repeat(r);p<s;++p)b+=e.charAt(l[p]);return b},decodeUnsafe:c,decode:function(e){var r=c(e);if(r)return r;throw Error(`Non-${t} character`)}}};let rL=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")};class r_{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class rN{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return rR(this,e)}}class rk{constructor(e){this.decoders=e}or(e){return rR(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let rR=(e,t)=>new rk({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class rj{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new r_(e,t,r),this.decoder=new rN(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let rT=({name:e,prefix:t,encode:r,decode:i})=>new rj(e,t,r,i),rP=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:n}=rU(r,t);return rT({prefix:e,name:t,encode:i,decode:e=>rL(n(e))})},rz=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>rT({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],n=(1<<r)-1,o="",s=0,f=0;for(let i=0;i<e.length;++i)for(f=f<<8|e[i],s+=8;s>r;)s-=r,o+=t[n&f>>s];if(s&&(o+=t[n&f<<r-s]),i)for(;o.length*r&7;)o+="=";return o})(e,i,r),decode:t=>((e,t,r,i)=>{let n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let o=e.length;for(;"="===e[o-1];)--o;let s=new Uint8Array(o*r/8|0),f=0,a=0,l=0;for(let t=0;t<o;++t){let o=n[e[t]];if(void 0===o)throw SyntaxError(`Non-${i} character`);a=a<<r|o,(f+=r)>=8&&(f-=8,s[l++]=255&a>>f)}if(f>=r||255&a<<8-f)throw SyntaxError("Unexpected end of data");return s})(t,i,r,e)});var rD=Object.freeze({__proto__:null,identity:rT({prefix:"\0",name:"identity",encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)})}),rF=Object.freeze({__proto__:null,base2:rz({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),rH=Object.freeze({__proto__:null,base8:rz({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),rV=Object.freeze({__proto__:null,base10:rP({prefix:"9",name:"base10",alphabet:"0123456789"})}),rM=Object.freeze({__proto__:null,base16:rz({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:rz({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})}),rq=Object.freeze({__proto__:null,base32:rz({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper:rz({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad:rz({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper:rz({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex:rz({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper:rz({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad:rz({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:rz({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:rz({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),rX=Object.freeze({__proto__:null,base36:rP({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:rP({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),rW=Object.freeze({__proto__:null,base58btc:rP({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:rP({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})}),rY=Object.freeze({__proto__:null,base64:rz({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad:rz({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:rz({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:rz({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let rZ=Array.from(""),rK=rZ.reduce((e,t,r)=>(e[r]=t,e),[]),rG=rZ.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var r$=Object.freeze({__proto__:null,base256emoji:rT({prefix:"",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=rK[t],"")},decode:function(e){let t=[];for(let r of e){let e=rG[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function rJ(e,t,r){t=t||[],r=r||0;for(var i=r;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,rJ.bytes=r-i+1,t}var rQ=function(e){return e<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:e<0x800000000?5:e<0x40000000000?6:e<0x2000000000000?7:e<0x100000000000000?8:e<0x8000000000000000?9:10};let r0=(e,t,r=0)=>(rJ(e,t,r),t),r1=(e,t)=>{let r=t.byteLength,i=rQ(e),n=i+rQ(r),o=new Uint8Array(n+r);return r0(e,o,0),r0(r,o,i),o.set(t,n),new r2(e,r,t,o)};class r2{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let r8=({name:e,code:t,encode:r})=>new r6(e,t,r);class r6{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?r1(this.code,t):t.then(e=>r1(this.code,e))}throw Error("Unknown type, must be binary type")}}let r3=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var r5=Object.freeze({__proto__:null,sha256:r8({name:"sha2-256",code:18,encode:r3("SHA-256")}),sha512:r8({name:"sha2-512",code:19,encode:r3("SHA-512")})}),r4=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:rL,digest:e=>r1(0,rL(e))}});new TextEncoder,new TextDecoder;let r7={...rD,...rF,...rH,...rV,...rM,...rq,...rX,...rW,...rY,...r$};function r9(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...r5,...r4}),r9("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),r9("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){var t;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),r7.base16,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,d.THIRTY_DAYS,d.SEVEN_DAYS,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.ONE_DAY,d.ONE_DAY,d.ONE_DAY,d.ONE_DAY,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.ONE_DAY,d.ONE_DAY,d.ONE_DAY,d.ONE_DAY,d.ONE_HOUR,d.ONE_HOUR,d.FIVE_MINUTES,d.FIVE_MINUTES,d.FIVE_MINUTES,d.SEVEN_DAYS,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,e.i(529722),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var ie=e.i(793973),it=e.i(35730),ir=e.i(408789),ii=e.i(835876),io=e.i(355009),is=e.i(840612),ia=e.i(652736),il=e.i(843498),ih=e.i(234882),ic=e.i(880388),iu=e.i(319043),id=e.i(278536);let ip=null,ib={getSIWX:()=>il.OptionsController.state.siwx,async initializeIfEnabled(e=ir.ChainController.getActiveCaipAddress()){let t=il.OptionsController.state.siwx;if(!(t&&e))return;let[r,i,n]=e.split(":");if(ir.ChainController.checkIfSupportedNetwork(r,`${r}:${i}`))try{if(il.OptionsController.state.remoteFeatures?.emailCapture){let e=ir.ChainController.getAccountData(r)?.user;await ia.ModalController.open({view:"DataCapture",data:{email:e?.email??void 0}});return}if(ip&&await ip,(await t.getSessions(`${r}:${i}`,n)).length)return;await ia.ModalController.open({view:"SIWXSignMessage"})}catch(e){console.error("SIWXUtil:initializeIfEnabled",e),is.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(e)}),await ii.ConnectionController._getClient()?.disconnect().catch(console.error),ih.RouterController.reset("Connect"),ic.SnackController.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){let e=il.OptionsController.state.siwx,t=id.CoreHelperUtil.getPlainAddress(ir.ChainController.getActiveCaipAddress()),r=(0,iu.getActiveCaipNetwork)(),i=ii.ConnectionController._getClient();if(!e)throw Error("SIWX is not enabled");if(!t)throw Error("No ActiveCaipAddress found");if(!r)throw Error("No ActiveCaipNetwork or client found");if(!i)throw Error("No ConnectionController client found");try{let n=await e.createMessage({chainId:r.caipNetworkId,accountAddress:t}),o=n.toString();io.ConnectorController.getConnectorId(r.chainNamespace)===ie.ConstantsUtil.CONNECTOR_ID.AUTH&&ih.RouterController.pushTransactionStack({});let s=await i.signMessage(o);await e.addSession({data:n,message:o,signature:s}),ir.ChainController.setLastConnectedSIWECaipNetwork(r),ia.ModalController.close(),is.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(e){ia.ModalController.state.open&&"ApproveTransaction"!==ih.RouterController.state.view||await ia.ModalController.open({view:"SIWXSignMessage"}),ic.SnackController.showError("Error signing message"),is.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(e)}),console.error("SWIXUtil:requestSignMessage",e)}},async cancelSignMessage(){try{let e=this.getSIWX();if(e?.getRequired?.()){let t=ir.ChainController.getLastConnectedSIWECaipNetwork();if(t){let r=await e?.getSessions(t?.caipNetworkId,id.CoreHelperUtil.getPlainAddress(ir.ChainController.getActiveCaipAddress())||"");r&&r.length>0?await ir.ChainController.switchActiveNetwork(t):await ii.ConnectionController.disconnect()}else await ii.ConnectionController.disconnect()}else ia.ModalController.close();ia.ModalController.close(),is.EventsController.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){let e=this.getSIWX(),t=ir.ChainController.getAllRequestedCaipNetworks(),r=[];return await Promise.all(t.map(async t=>{let i=await e?.getSessions(t.caipNetworkId,id.CoreHelperUtil.getPlainAddress(ir.ChainController.getActiveCaipAddress())||"");i&&r.push(...i)})),r},async getSessions(e){let t=il.OptionsController.state.siwx,r=e?.address;if(!r){let e=ir.ChainController.getActiveCaipAddress();r=id.CoreHelperUtil.getPlainAddress(e)}let i=e?.caipNetworkId;if(!i){let e=ir.ChainController.getActiveCaipNetwork();i=e?.caipNetworkId}return t&&r&&i?t.getSessions(i,r):[]},async isSIWXCloseDisabled(){let e=this.getSIWX();if(e){let t="ApproveTransaction"===ih.RouterController.state.view,r="SIWXSignMessage"===ih.RouterController.state.view;if(t||r)return e.getRequired?.()&&0===(await this.getSessions()).length}return!1},async authConnectorAuthenticate({authConnector:e,chainId:t,socialUri:r,preferredAccountType:i,chainNamespace:n}){let o=ib.getSIWX(),s=(0,iu.getActiveCaipNetwork)();if(!o||!n.includes(ie.ConstantsUtil.CHAIN.EVM)||il.OptionsController.state.remoteFeatures?.emailCapture){let n=await e.connect({chainId:t,socialUri:r,preferredAccountType:i});return{address:n.address,chainId:n.chainId,accounts:n.accounts}}let f=`${n}:${t}`,a=await o.createMessage({chainId:f,accountAddress:"<<AccountAddress>>"}),l={accountAddress:a.accountAddress,chainId:a.chainId,domain:a.domain,uri:a.uri,version:a.version,nonce:a.nonce,notBefore:a.notBefore,statement:a.statement,resources:a.resources,requestId:a.requestId,issuedAt:a.issuedAt,expirationTime:a.expirationTime,serializedMessage:a.toString()},h=await e.connect({chainId:t,socialUri:r,siwxMessage:l,preferredAccountType:i});if(l.accountAddress=h.address,l.serializedMessage=h.message||"",h.signature&&h.message){let e=ib.addEmbeddedWalletSession(l,h.message,h.signature);await e}return ir.ChainController.setLastConnectedSIWECaipNetwork(s),{address:h.address,chainId:h.chainId,accounts:h.accounts}},async addEmbeddedWalletSession(e,t,r){if(ip)return ip;let i=ib.getSIWX();return i?ip=i.addSession({data:e,message:t,signature:r}).finally(()=>{ip=null}):Promise.resolve()},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:r}){let i=ib.getSIWX(),n=(0,iu.getActiveCaipNetwork)(),o=new Set(t.map(e=>e.split(":")[0]));if(!i||1!==o.size||!o.has("eip155"))return!1;let s=await i.createMessage({chainId:(0,iu.getActiveCaipNetwork)()?.caipNetworkId||"",accountAddress:""}),f=await e.authenticate({nonce:s.nonce,domain:s.domain,uri:s.uri,exp:s.expirationTime,iat:s.issuedAt,nbf:s.notBefore,requestId:s.requestId,version:s.version,resources:s.resources,statement:s.statement,chainId:s.chainId,methods:r,chains:[s.chainId,...t.filter(e=>e!==s.chainId)]});ic.SnackController.showLoading("Authenticating...",{autoClose:!1});let a={...f.session.peer.metadata,name:f.session.peer.metadata.name,icon:f.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(ir.ChainController.setAccountProp("connectedWalletInfo",a,Array.from(o)[0]),f?.auths?.length){let t=f.auths.map(t=>{let r=e.client.formatAuthMessage({request:t.p,iss:t.p.iss});return{data:{...t.p,accountAddress:t.p.iss.split(":").slice(-1).join(""),chainId:t.p.iss.split(":").slice(2,4).join(":"),uri:t.p.aud,version:t.p.version||s.version,expirationTime:t.p.exp,issuedAt:t.p.iat,notBefore:t.p.nbf},message:r,signature:t.s.s,cacao:t}});try{await i.setSessions(t),n&&ir.ChainController.setLastConnectedSIWECaipNetwork(n),is.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:ib.getSIWXEventProperties()})}catch(t){throw console.error("SIWX:universalProviderAuth - failed to set sessions",t),is.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:ib.getSIWXEventProperties(t)}),await e.disconnect().catch(console.error),t}finally{ic.SnackController.hide()}}return!0},getSIWXEventProperties(e){let t=ir.ChainController.state.activeChain;if(!t)throw Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:ir.ChainController.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:(0,iu.getPreferredAccountType)(t)===it.W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,message:e?id.CoreHelperUtil.parseError(e):void 0}},async clearSessions(){let e=this.getSIWX();e&&await e.setSessions([])}};e.s(["SIWXUtil",0,ib],12560)}]);